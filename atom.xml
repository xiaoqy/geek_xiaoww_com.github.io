<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>思远文文的技术博客 - 镜像站</title>
  
  <subtitle>极客爱好，创新精神，灵感之作，专注精致！</subtitle>
  <link href="https://mirror.geek.xiaoww.com/atom.xml" rel="self"/>
  
  <link href="https://mirror.geek.xiaoww.com/"/>
  <updated>2025-07-26T02:24:01.579Z</updated>
  <id>https://mirror.geek.xiaoww.com/</id>
  
  <author>
    <name>Allen Shaw</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>探索神奇的无线电</title>
    <link href="https://mirror.geek.xiaoww.com/posts/exploring-the-magic-of-radio/"/>
    <id>https://mirror.geek.xiaoww.com/posts/exploring-the-magic-of-radio/</id>
    <published>2025-07-26T02:24:01.756Z</published>
    <updated>2025-07-26T02:24:01.579Z</updated>
    
    <content type="html"><![CDATA[<p>在我小时候时，大概在十年前，家常住农村地区，我自己所使用的是山寨手机，属于 MRP 平台的，国内普遍的手机（包括国产的贴牌、杂牌、品牌，已及数量极其庞大的其它山寨机都带有这个平台)，比 JAVA 手机还要低端。网络也就只能勉强用 2G 上网，可以上网冲浪查资料，如果做其它事情就会非常缓慢。</p><p>有一天在赶集日，我在小学校园附近街边上发现一家数码杂货实体店，纯粹好奇想进去看看或者买点什么有趣的东西。店内售卖着各种磁带收录机和收音机，MP3，MP4，DVD 影碟机，视频播放机，音响和功放设备等。我购买了最廉价的指针式收音机，花了大概 20 元。这样无聊的时候可以随时拿出来听听。这个基本只能听调频广播，按钮极其的少，所有频率调节都是通过右侧的飞梭（旋钮），缺点就是无法滤除干扰信号，没有变频和DSP 数字信号处理，从开始到结尾都是模拟信号。</p><p>在购买第二台收音机之前，我的灵感来自于对超声波、次声波、光波、微波、高低频信号、慢扫描电视、天线振子、红外、噪声、波长、波段、波形、辐射、共振和频率等，也对天波和地波以及直线波传播途径的初步了解，让我产生了一些兴趣爱好。我在 4 月 12 日我购买了第二台，品牌我选择的是国产的德生，因为它是做收音机起家的，型号是 PL330 ，最适合新手入门的使用，支持全波段（调频、调幅、短波、中波、长波、单边带），单边带包括上边带（USB）与下边带（LSB），支持同步检波，二次变频，DSP 数字信号处理，单频率存储，ETM 时段频率存储，自动搜台等。它的下一个版本德生 PL320 去除了单边带功能和优化了一些功能，但我最终选择了旧版。</p><p>不过网上有很多自己做矿石收音机和使用开源项目 DIY 收音机的，这个我就不多追溯了。</p><p>在这段时间里，我发现了比收音机可玩性更高的来了，这种想法也许我很早就遇到过，它就是 SDR（软件定义无线电），而收音机都是指的 HDR（硬件定义无线电），应用范围就有非常大的差距，SDR 就是基于通用的硬件平台上用软件来实现各种通信模块，所有调制与解调、信号增益、噪声处理、带宽调整、频谱分析等，信号完全由电脑软件来处理，或者手机端、网页端、单片机、开发板来操作控制。这样可以实现超宽频谱可视化，也可对多信号进行录制和射频重放，同时收听多个频率，信号多人共享等。</p><p>于此之外，我们还需要了解带宽、灵敏度、ADC、过载、动态范围、图像混叠、噪声干扰、射频滤波、预选中心、直流尖峰、相位噪声等实现原理和实现过程。未来还需做充分的实验，会用到高压发生器、等离子体、线圈、开关电源、线性电源、高频电容、高频电感、示波器、遥控装置、物联网设备、矢量网络分析仪、变压器、逆变器、ZVS 电路等，还得阅读一些无线电和电子工程学的知识书籍。</p><p>电磁波是由电场和磁场相互垂直并同时变化的波动，可以在真空中传播，也可以在其他介质中传播。无线电波是电磁波的一种，用于无线电通信。</p><p>无线电传播方式可以比作是，将低频的音频信号转换成高频信号，通过导线发射出去，这称之为调制，高频中可带任何低频信号或其它信息，以高频作为载体。解调是把接收到的高频信号转成低频信号，高频作为载体，将高频信号过滤掉，只拿到主要的低频信号，这样就可以正常播放声音了。这就相当于盒子效应。</p><p>天波（Sky Wave）<br>天波是指那些通过大气层，尤其是电离层反射或折射传播的无线电波。它们可以传输很远的距离，因为电离层可以将无线电波反射回地球表面。天波在到达电离层时，会被电离层中的电离粒子反射或折射，然后返回地面。这一过程可以重复多次，使无线电波传播非常远的距离。能接收全球的信号，这有时还要看天气和大气层的影响，通常晚上效果会更好。在雨天信号容易出现散射，也可达到理想效果。</p><p>地波（Ground Wave）<br>地波是指那些沿着地球表面传播的无线电波。地波在接近地面的位置传播，受到地面特性的影响。地波是通过表面波，沿着地球表面传播，并受地表的导电性和地形影响。频率越低，地波传播的距离越远。</p><p>直射波（Straight Wave）</p><p>直射波又称为空间波，是由发射点从空间直线传播到接收点的无线电波。直射波传播距离一般限于视距范围。在传播过程中，它的强度衰减较慢。中间可由多个进行信号中继转发，也有发射到卫星，再通过卫星中继转发射到地面。</p><p>从传播手段看，广播分两大类：<br>①通过无线电波传送节目的，称为无线广播； ②通过导线传送节目的，称为有线广播。<br>从传播媒介看，广播也可分为两大类：<br>①仅仅传送声音的，称为声音广播，简称广播；②传送声音、图像的，称为电视广播。<br>从广播信号的调制方式分为：调频(FM)广播与调幅(AM)广播两种。<br>从使用的无线电波段分为：长波(LW)、中波(MW)、短波(SW)和超短波。<br>目前，长波、中波、短波广播使用的均为调幅模式；调频广播使用的是超短波波段。</p><p>根据情况选择合适的天线，每种天线有着不同的频段接收范围，即使有些收音机不能实现其它高低频段接收，都可以通过不同的天线来解决，可搭配变频滤波器来调整信噪比来抵制外部干扰。天线一般分大环天线、磁环天线、八木天线、偶极天线、拉杆天线（垂直天线），部分天线具有方向性，也有全向性。天线结构通常有：引向单元（引向器）、反射单元、激励单元、天线振子，还有一些绝缘环部分，这里我就不多追溯了。</p><p>应用领域</p><p>业余无线电：在业余无线电爱好者中非常受欢迎，提供了灵活和强大的通信手段。语音通信、数据通信、无线电测向、卫星通信等</p><p>广播接收：可以用来接收各种类型的广播信号，包括调频广播（FM）、中波广播（AM）和短波广播。</p><p>气象卫星接收：可以接收气象卫星的信号，用于获取卫星图像和气象数据。</p><p>安全和监控：在安全监控领域用于频谱监测和信号拦截，帮助检测和分析无线电信号。频谱监测、信号拦截、无线电频率干扰检测</p><p>无线电天文：在无线电天文学中用于接收和分析来自宇宙的无线电信号，研究天体物理现象。</p><p>无线网络研究：在无线网络研究中用于开发和测试新的无线通信协议和技术。5G 网络研究、Wi-Fi 信号分析、无线通信协议开发</p><p>教育和研究：是教育和研究领域的重要工具，帮助学生和研究人员学习和实验无线电通信技术。</p><p>航空和海事通信：在航空和海事通信中用于接收和解码飞机和船只的通信信号。</p><p>卫星通信：用于接收和解码各种卫星通信信号，包括业余卫星和商用卫星。</p><p>另外，无线电爱好者操作员是分业余无线电和专业无线电。</p><p>尽管名为「业余」，但这并不意味着业余无线电是「不专业」的。它更像是一个「民用」的概念，一个让普通人也能享受到科技乐趣的平台。</p><p>业余无线电爱好者自称为 HAM，他们使用自己的无线电设备，在法律划分的电波频段内进行各种活动，如语音通话，发无线电报，发摩尔斯电码，讨论技术，甚至进行通联竞赛。这些活动虽然纯属个人爱好，但每一个 HAM 都是严格遵守规则的，不能以盈利为目的。</p><p>我个人一般用作：信号干扰实验研究，信号调试与解调，电磁电路板干扰分析、WIFI、基站、GPS、微波、天线信号分析等。也会用于模拟电视接收，航空频率，军事频率，以及早期的摩尔斯电码，慢扫描电视，气象云图，手台（对讲机 &#x2F; 手持电台），台式收发信机（台式电台）接收，频谱图信号分析。</p><p>无线电通信模式<br>语音通信模式</p><p>AM（幅度调制）：常用于中波广播、短波广播。<br>FM（频率调制）：常用于调频广播、业余无线电VHF和UHF频段。<br>SSB（单边带调制）：用于长距离通信，效率高，常见于短波业余无线电。<br>NFM（窄带频率调制）：用于商用对讲机、业余无线电、公共安全通信。<br>数据通信模式</p><p>CW（连续波&#x2F;摩尔斯码）：早期的无线电通信模式，仍在业余无线电中使用。<br>RTTY（无线电电传打字）：用于数据传输，早期电报系统。<br>PSK31（相位偏移键控）：窄带数据通信模式，常用于业余无线电。<br>FT8、FT4：数字通信模式，适用于低信噪比环境，常用于业余无线电。<br>APRS（自动位置报告系统）：用于位置和数据传输，常用于业余无线电。<br>视频通信模式</p><p>ATV（业余电视）：模拟电视广播，使用业余无线电频段。<br>DATV（数字业余电视）：数字电视广播，使用业余无线电频段。</p><p>对于专业的软硬件无线电设备口碑不错的品牌与型号：</p><p>ICOM IC-7300、IC-7851、IC-R9500（收发信机）；Kenwood TS-990S、TS-2000（收发信机）；FlexRadio（SDR 收发信机）；RTL-SDR；AirSpy；SDRPlay；Hackrf One；ATS25 AMP、ATS120、德生 PL330、PL880、德劲、八重洲等。</p><p>最后介绍 ICOM 和 FlexRadio 两款品牌用途：</p><p>ICOM 适合那些喜欢传统操作界面和物理控制的用户，产品线丰富，集成度高。</p><p>FlexRadio 则更适合追求高性能和灵活性的用户，尤其是那些需要远程操作和愿意通过软件定义无线电技术来扩展设备功能的用户。</p><p>FlexRadio 的可玩性比 ICOM 更高，适合高端无线电爱好者。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在我小时候时，大概在十年前，家常住农村地区，我自己所使用的是山寨手机，属于 MRP 平台的，国内普遍的手机（包括国产的贴牌、杂牌、品牌，已及数量极其庞大的其它山寨机都带有这个平台)，比 JAVA 手机还要低端。网络也就只能勉强用 2G 上网，可以上网冲浪查资料，如果做其它事</summary>
      
    
    
    
    <category term="兴趣" scheme="https://mirror.geek.xiaoww.com/categories/%E5%85%B4%E8%B6%A3/"/>
    
    
    <category term="业余无线电" scheme="https://mirror.geek.xiaoww.com/tags/%E4%B8%9A%E4%BD%99%E6%97%A0%E7%BA%BF%E7%94%B5/"/>
    
    <category term="无线电" scheme="https://mirror.geek.xiaoww.com/tags/%E6%97%A0%E7%BA%BF%E7%94%B5/"/>
    
    <category term="硬件定义无线电" scheme="https://mirror.geek.xiaoww.com/tags/%E7%A1%AC%E4%BB%B6%E5%AE%9A%E4%B9%89%E6%97%A0%E7%BA%BF%E7%94%B5/"/>
    
    <category term="软件定义无线电" scheme="https://mirror.geek.xiaoww.com/tags/%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E6%97%A0%E7%BA%BF%E7%94%B5/"/>
    
    <category term="收音机" scheme="https://mirror.geek.xiaoww.com/tags/%E6%94%B6%E9%9F%B3%E6%9C%BA/"/>
    
    <category term="电台" scheme="https://mirror.geek.xiaoww.com/tags/%E7%94%B5%E5%8F%B0/"/>
    
    <category term="手台" scheme="https://mirror.geek.xiaoww.com/tags/%E6%89%8B%E5%8F%B0/"/>
    
    <category term="对讲机" scheme="https://mirror.geek.xiaoww.com/tags/%E5%AF%B9%E8%AE%B2%E6%9C%BA/"/>
    
    <category term="收信机" scheme="https://mirror.geek.xiaoww.com/tags/%E6%94%B6%E4%BF%A1%E6%9C%BA/"/>
    
    <category term="收发信机" scheme="https://mirror.geek.xiaoww.com/tags/%E6%94%B6%E5%8F%91%E4%BF%A1%E6%9C%BA/"/>
    
    <category term="接收机" scheme="https://mirror.geek.xiaoww.com/tags/%E6%8E%A5%E6%94%B6%E6%9C%BA/"/>
    
    <category term="广播" scheme="https://mirror.geek.xiaoww.com/tags/%E5%B9%BF%E6%92%AD/"/>
    
    <category term="调制与解调" scheme="https://mirror.geek.xiaoww.com/tags/%E8%B0%83%E5%88%B6%E4%B8%8E%E8%A7%A3%E8%B0%83/"/>
    
    <category term="信号" scheme="https://mirror.geek.xiaoww.com/tags/%E4%BF%A1%E5%8F%B7/"/>
    
    <category term="频率" scheme="https://mirror.geek.xiaoww.com/tags/%E9%A2%91%E7%8E%87/"/>
    
    <category term="电磁波" scheme="https://mirror.geek.xiaoww.com/tags/%E7%94%B5%E7%A3%81%E6%B3%A2/"/>
    
    <category term="数字信号" scheme="https://mirror.geek.xiaoww.com/tags/%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7/"/>
    
    <category term="模拟信号" scheme="https://mirror.geek.xiaoww.com/tags/%E6%A8%A1%E6%8B%9F%E4%BF%A1%E5%8F%B7/"/>
    
    <category term="模拟电视" scheme="https://mirror.geek.xiaoww.com/tags/%E6%A8%A1%E6%8B%9F%E7%94%B5%E8%A7%86/"/>
    
    <category term="数字电视" scheme="https://mirror.geek.xiaoww.com/tags/%E6%95%B0%E5%AD%97%E7%94%B5%E8%A7%86/"/>
    
    <category term="长波" scheme="https://mirror.geek.xiaoww.com/tags/%E9%95%BF%E6%B3%A2/"/>
    
    <category term="中波" scheme="https://mirror.geek.xiaoww.com/tags/%E4%B8%AD%E6%B3%A2/"/>
    
    <category term="短波" scheme="https://mirror.geek.xiaoww.com/tags/%E7%9F%AD%E6%B3%A2/"/>
    
    <category term="超短波" scheme="https://mirror.geek.xiaoww.com/tags/%E8%B6%85%E7%9F%AD%E6%B3%A2/"/>
    
    <category term="天波" scheme="https://mirror.geek.xiaoww.com/tags/%E5%A4%A9%E6%B3%A2/"/>
    
    <category term="地波" scheme="https://mirror.geek.xiaoww.com/tags/%E5%9C%B0%E6%B3%A2/"/>
    
    <category term="直线波" scheme="https://mirror.geek.xiaoww.com/tags/%E7%9B%B4%E7%BA%BF%E6%B3%A2/"/>
    
    <category term="调频" scheme="https://mirror.geek.xiaoww.com/tags/%E8%B0%83%E9%A2%91/"/>
    
    <category term="调幅" scheme="https://mirror.geek.xiaoww.com/tags/%E8%B0%83%E5%B9%85/"/>
    
    <category term="调谐" scheme="https://mirror.geek.xiaoww.com/tags/%E8%B0%83%E8%B0%90/"/>
    
    <category term="微波" scheme="https://mirror.geek.xiaoww.com/tags/%E5%BE%AE%E6%B3%A2/"/>
    
    <category term="波长" scheme="https://mirror.geek.xiaoww.com/tags/%E6%B3%A2%E9%95%BF/"/>
    
    <category term="波段" scheme="https://mirror.geek.xiaoww.com/tags/%E6%B3%A2%E6%AE%B5/"/>
    
    <category term="干扰" scheme="https://mirror.geek.xiaoww.com/tags/%E5%B9%B2%E6%89%B0/"/>
    
    <category term="辐射" scheme="https://mirror.geek.xiaoww.com/tags/%E8%BE%90%E5%B0%84/"/>
    
    <category term="噪声" scheme="https://mirror.geek.xiaoww.com/tags/%E5%99%AA%E5%A3%B0/"/>
    
    <category term="频谱" scheme="https://mirror.geek.xiaoww.com/tags/%E9%A2%91%E8%B0%B1/"/>
    
  </entry>
  
  <entry>
    <title>网页安全保护</title>
    <link href="https://mirror.geek.xiaoww.com/posts/web-protection/"/>
    <id>https://mirror.geek.xiaoww.com/posts/web-protection/</id>
    <published>2025-07-19T12:12:12.000Z</published>
    <updated>2025-07-19T12:18:59.517Z</updated>
    
    <content type="html"><![CDATA[<div class="code-container" data-rel="Css"><figure class="iseeu highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 禁止文字拖拽 */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none; <span class="comment">/* Safari */</span></span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none; <span class="comment">/* Firefox */</span></span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none; <span class="comment">/* IE10+ */</span></span><br><span class="line">    <span class="attribute">user-select</span>: none; <span class="comment">/* Standard */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 禁止操作图片 */</span></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="comment">/* pointer-events: none; 禁用图片的鼠标/触摸事件 */</span></span><br><span class="line">    <span class="comment">/* user-select: none; 禁止选中图片 */</span></span><br><span class="line">    -webkit-touch-callout: none; <span class="comment">/* iOS 禁用长按菜单 */</span></span><br><span class="line">    <span class="comment">/* -webkit-user-select: none; 禁止 iOS 选中 */</span></span><br><span class="line">    <span class="comment">/* -moz-user-select: none; 禁止 Firefox 选中 */</span></span><br><span class="line">    <span class="comment">/* -ms-user-select: none; 禁止 IE 选中 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 禁止图片拖拽 */</span></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    -webkit-user-drag: none;</span><br><span class="line">    -khtml-user-drag: none;</span><br><span class="line">    -moz-user-drag: none;</span><br><span class="line">    -o-user-drag: none;</span><br><span class="line">    user-drag: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">onselectstart</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;; <span class="comment">// 禁止文字选择</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">oncut</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title class_">Swal</span>.<span class="title function_">fire</span>(&#123; <span class="attr">position</span>: <span class="string">&quot;top-end&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;warning&quot;</span>, <span class="attr">title</span>: <span class="string">&quot;本站禁止剪切！&quot;</span>, <span class="attr">timer</span>: <span class="number">2000</span>, <span class="attr">timerProgressBar</span>: <span class="literal">true</span>, <span class="attr">showConfirmButton</span>: <span class="literal">false</span> &#125;); <span class="keyword">return</span> <span class="literal">false</span>; &#125;; <span class="comment">// 禁止剪切 </span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">oncopy</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title class_">Swal</span>.<span class="title function_">fire</span>(&#123; <span class="attr">position</span>: <span class="string">&quot;top-end&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;warning&quot;</span>, <span class="attr">title</span>: <span class="string">&quot;本站禁止复制！&quot;</span>, <span class="attr">timer</span>: <span class="number">2000</span>, <span class="attr">timerProgressBar</span>: <span class="literal">true</span>, <span class="attr">showConfirmButton</span>: <span class="literal">false</span> &#125;); <span class="keyword">return</span> <span class="literal">false</span>; &#125;; <span class="comment">// 禁止复制</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">oncontextmenu</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title class_">Swal</span>.<span class="title function_">fire</span>(&#123; <span class="attr">position</span>: <span class="string">&quot;top-end&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;warning&quot;</span>, <span class="attr">title</span>: <span class="string">&quot;本站禁止右键菜单！&quot;</span>, <span class="attr">timer</span>: <span class="number">2000</span>, <span class="attr">timerProgressBar</span>: <span class="literal">true</span>, <span class="attr">showConfirmButton</span>: <span class="literal">false</span> &#125;); <span class="keyword">return</span> <span class="literal">false</span>; &#125;; <span class="comment">// 禁止右键菜单</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁止图片拖拽</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;img&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">  img.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragstart&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁止图片右键</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&#x27;IMG&#x27;</span>) &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁止长按图片</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&#x27;IMG&#x27;</span>) &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>(); <span class="comment">// 阻止长按默认行为</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, &#123; <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复制版权内容</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;copy&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> clipboardData = event.<span class="property">clipboardData</span> || <span class="variable language_">window</span>.<span class="property">clipboardData</span>;</span><br><span class="line">  <span class="keyword">if</span> (!clipboardData) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> text = <span class="variable language_">window</span>.<span class="title function_">getSelection</span>().<span class="title function_">toString</span>();</span><br><span class="line">  <span class="keyword">if</span> (text) &#123;</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> copyrightNotice = <span class="string">&#x27;\r\n\r\n------\r\n作者：Allen Shaw\r\n链接：&#x27;</span> + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> + <span class="string">&#x27;\r\n未经授权禁止转载或摘录，著作权归作者所有！\r\n商业转载请联系作者获得许可，非商业转载请注明出处并保留作者信息。&#x27;</span>;</span><br><span class="line">    clipboardData.<span class="title function_">setData</span>(<span class="string">&#x27;text/plain&#x27;</span>, text + copyrightNotice);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果想加富文本（HTML），可以加这一行</span></span><br><span class="line">    <span class="comment">// clipboardData.setData(&#x27;text/html&#x27;, &#x27;&lt;p&gt;&#x27; + text + &#x27;&lt;/p&gt;&lt;p&gt;版权所有&lt;/p&gt;&#x27;);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空页面</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearHTML</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;about:blank&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;popstate&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;about:blank&#x27;</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> isCtrl = event.<span class="property">ctrlKey</span>;</span><br><span class="line">  <span class="keyword">const</span> isShift = event.<span class="property">shiftKey</span>;</span><br><span class="line">  <span class="keyword">const</span> key = event.<span class="property">key</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">key</span> === <span class="string">&#x27;F12&#x27;</span> || isCtrl &amp;&amp; isShift &amp;&amp; key === <span class="string">&#x27;I&#x27;</span> || isCtrl &amp;&amp; isShift &amp;&amp; key === <span class="string">&#x27;C&#x27;</span> || isCtrl &amp;&amp; isShift &amp;&amp; key === <span class="string">&#x27;J&#x27;</span>) &#123;</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="title function_">clearHTML</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (isCtrl &amp;&amp; key === <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="title function_">clearHTML</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (isCtrl &amp;&amp; key === <span class="string">&#x27;p&#x27;</span>) &#123;</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">filter</span> = <span class="string">&#x27;blur(5px)&#x27;</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">filter</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测开发者工具</span></span><br><span class="line"><span class="keyword">const</span> threshold = <span class="number">320</span>;</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerWidth</span> - <span class="variable language_">window</span>.<span class="property">innerWidth</span> &gt; threshold || <span class="variable language_">window</span>.<span class="property">outerHeight</span> - <span class="variable language_">window</span>.<span class="property">innerHeight</span> &gt; threshold) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;about:blank&#x27;</span>;</span><br><span class="line">        <span class="comment">// document.write(&quot;&lt;style&gt;@media print&#123;body&#123;display:none&#125;&#125;&lt;/style&gt;&quot;);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 初始状态</span></span><br><span class="line">        history.<span class="title function_">pushState</span>(<span class="literal">null</span>, <span class="variable language_">document</span>.<span class="property">title</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 监听popstate事件（用户点击了后退按钮）</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;popstate&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">          history.<span class="title function_">pushState</span>(<span class="literal">null</span>, <span class="variable language_">document</span>.<span class="property">title</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;about:blank&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;检测到开发者工具，请关闭！&#x27;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">filter</span> = <span class="string">&#x27;blur(5px)&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;code-container&quot; data-rel=&quot;Css&quot;&gt;&lt;figure class=&quot;iseeu highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>电脑上收看传统电视频道：potplayer + iptv 源</title>
    <link href="https://mirror.geek.xiaoww.com/posts/watch-tv-channels-on-pc-potplayer-iptv/"/>
    <id>https://mirror.geek.xiaoww.com/posts/watch-tv-channels-on-pc-potplayer-iptv/</id>
    <published>2025-07-18T06:16:32.040Z</published>
    <updated>2025-06-02T08:20:03.592Z</updated>
    
    <content type="html"><![CDATA[<h1 id="电脑上收看传统电视频道：potplayer-iptv-源"><a href="#电脑上收看传统电视频道：potplayer-iptv-源" class="headerlink" title="电脑上收看传统电视频道：potplayer + iptv 源"></a>电脑上收看传统电视频道：potplayer + iptv 源</h1><h2 id="先上效果图："><a href="#先上效果图：" class="headerlink" title="先上效果图："></a>先上效果图：</h2><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/0086nk0Ngy1gdawlq0f1gj318g0qab29.jpg!xiaoww-geek"                      alt="img"                ></p><p>（图注：<code>potplayer</code> +<code>iptv</code> 源观看 <code>CCTV</code>。右侧播放列表可以切换电视频道）</p><h2 id="以下正文开始"><a href="#以下正文开始" class="headerlink" title="以下正文开始"></a>以下正文开始</h2><p>在电脑上收盘传统电视频道，推荐 <code>potplayer</code> + <code>iptv</code>源订阅的方式。 必备工具：</p><ol><li>支持播放 <code>iptv</code> 的视频播放器，推荐 <code>potplayer</code> 或 <code>VLC</code></li><li><code>iptv</code> 频道的网络地址</li></ol><p>必备工具的第 2 项，即电视频道的网络地址，不太容易获取。这里推荐 Github 上的开源项目：<a class="link"   href="https://github.com/iptv-org/iptv" >iptv-org&#x2F;iptv<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。 该项目包含了全球很多国家的 <code>iptv</code> 源，我们只需要找到其中的中国源，即 <code>https://iptv-org.github.io/iptv/channels/cn.m3u</code></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/0086nk0Ngy1gdawolsjkfj30n20iy46u.jpg!xiaoww-geek"                      alt="img"                ></p><p>把它下载到电脑上，下载后是这样一个文件：</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/0086nk0Ngy1gdawp28wd1j30bw061abw.jpg!xiaoww-geek"                      alt="img"                ></p><p>用 <code>potplayer</code>打开它，就可以收看电视了！效果就是文章开头那样。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;电脑上收看传统电视频道：potplayer-iptv-源&quot;&gt;&lt;a href=&quot;#电脑上收看传统电视频道：potplayer-iptv-源&quot; class=&quot;headerlink&quot; title=&quot;电脑上收看传统电视频道：potplayer + iptv 源&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    <category term="应用软件" scheme="https://mirror.geek.xiaoww.com/categories/%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6/"/>
    
    
    <category term="PotPlayer" scheme="https://mirror.geek.xiaoww.com/tags/PotPlayer/"/>
    
    <category term="iPTV" scheme="https://mirror.geek.xiaoww.com/tags/iPTV/"/>
    
    <category term="TV" scheme="https://mirror.geek.xiaoww.com/tags/TV/"/>
    
    <category term="电视" scheme="https://mirror.geek.xiaoww.com/tags/%E7%94%B5%E8%A7%86/"/>
    
    <category term="直播源" scheme="https://mirror.geek.xiaoww.com/tags/%E7%9B%B4%E6%92%AD%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>如何为typecho站点设置多个域名</title>
    <link href="https://mirror.geek.xiaoww.com/posts/typecho-setup-multiple-domains/"/>
    <id>https://mirror.geek.xiaoww.com/posts/typecho-setup-multiple-domains/</id>
    <published>2025-07-18T06:16:32.037Z</published>
    <updated>2025-06-01T11:01:17.568Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>前言</p></blockquote><p>typecho后台只能设置一个域名，比如我设置了个<code>http://xiaoqy.com</code>，嗯这个域名就是被程序认知的域名，但是呢，这个<code>http://www.xiaoqy.com</code>带www的域名访问我的博客会出现问题，因为程序只认<code>http://xiaoqy.com</code>,所以会导致代带www的域名访问无法加载字体文件，那么如何解决这个问题呢？</p><blockquote><p>解决方法</p></blockquote><p>最初我告诉模板用户的解决方法是让<code>http://www.xiaoqy.com</code>重定向到<code>http://xiaoqy.com</code>，这样确实解决了问题。但是呢，如何让两个域名同时存在呢？</p><blockquote><p>方法一：</p></blockquote><p>在<code>config.inc.php</code>中定义<code>Helper::options()-&gt;siteUrl=&#39;http://www.xiaoqy.com&#39;;</code>（要放在数据库初始化之后，也就是最后）</p><blockquote><p>麻烦的方法二：</p></blockquote><p>需要修改typecho的源代码<br><strong>步骤一</strong><br>打开程序目录的这个文件<code>/var/Widget/Options.php</code><br><strong>步骤二</strong><br>使用搜索找到这个位置</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/** 初始化站点信息 */</span><br><span class="line">       if (defined(&#x27;__TYPECHO_SITE_URL__&#x27;)) &#123;</span><br><span class="line">           $this-&gt;siteUrl = __TYPECHO_SITE_URL__;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></div><p><strong>步骤三</strong><br>在步骤二中的代码最前面加入下面的代码（域名改成你自己的）</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if($_SERVER[&#x27;SERVER_NAME&#x27;]==&#x27;www.xiaoqy.com&#x27;)&#123;//chen added</span><br><span class="line">    $this-&gt;siteUrl = &#x27;http://www.xiaoqy.com&#x27;;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><strong>步骤四</strong><br>保存修改，体验成功的喜悦吧，还有就是希望对插件很懂的大牛做成插件，毕竟修改源码这种事情不太友好。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;前言&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;typecho后台只能设置一个域名，比如我设置了个&lt;code&gt;http://xiaoqy.com&lt;/code&gt;，嗯这个域名就是被程序认知的域名，但是呢，这个&lt;code&gt;http://www.xiaoq</summary>
      
    
    
    
    <category term="互联网" scheme="https://mirror.geek.xiaoww.com/categories/%E4%BA%92%E8%81%94%E7%BD%91/"/>
    
    
    <category term="Typecho" scheme="https://mirror.geek.xiaoww.com/tags/Typecho/"/>
    
    <category term="域名" scheme="https://mirror.geek.xiaoww.com/tags/%E5%9F%9F%E5%90%8D/"/>
    
  </entry>
  
  <entry>
    <title>利用oh-my-zsh打造漂亮的终端</title>
    <link href="https://mirror.geek.xiaoww.com/posts/oh-my-zsh-beautify-terminal/"/>
    <id>https://mirror.geek.xiaoww.com/posts/oh-my-zsh-beautify-terminal/</id>
    <published>2025-07-18T06:16:32.016Z</published>
    <updated>2025-06-01T11:00:31.291Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文以CentOS 7&#x2F;Mac 为例，介绍zsh的配置使用教程。</p></blockquote><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="查看当前环境shell"><a href="#查看当前环境shell" class="headerlink" title="查看当前环境shell"></a>查看当前环境shell</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $SHELL</span><br></pre></td></tr></table></figure></div><h3 id="查看系统自带哪些shell"><a href="#查看系统自带哪些shell" class="headerlink" title="查看系统自带哪些shell"></a>查看系统自带哪些shell</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shells</span><br></pre></td></tr></table></figure></div><h2 id="安装zsh"><a href="#安装zsh" class="headerlink" title="安装zsh"></a>安装zsh</h2><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install zsh # CentOS</span><br><span class="line">brew install zsh # mac安装</span><br></pre></td></tr></table></figure></div><h3 id="将zsh设置为默认shell"><a href="#将zsh设置为默认shell" class="headerlink" title="将zsh设置为默认shell"></a>将<code>zsh</code>设置为默认shell</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chsh -s /bin/zsh # CentOS</span><br><span class="line"># Mac如下</span><br><span class="line"># 在 /etc/shells 文件中加入如下一行</span><br><span class="line">/usr/local/bin/zsh</span><br><span class="line"># 接着运行</span><br><span class="line">chsh -s /usr/local/bin/zsh</span><br></pre></td></tr></table></figure></div><p>可以通过<code>echo $SHELL</code>查看当前默认的shell，如果没有改为<code>/bin/zsh</code>，那么需要重启shell。</p><h2 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h2><p>配置zsh是一件麻烦的事儿，爱折腾的程序猿怎么可能忍受？！于是，<a class="link"   href="https://github.com/robbyrussell/oh-my-zsh" >oh-my-zsh<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>出现了，有了这个东东，zsh配置起来就方便多了！</p><h3 id="安装oh-my-zsh"><a href="#安装oh-my-zsh" class="headerlink" title="安装oh-my-zsh"></a>安装oh-my-zsh</h3><p>有若干安装方式，介绍三种：<br>1.自动安装</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br></pre></td></tr></table></figure></div><p>2.手动安装</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh</span><br><span class="line">cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</span><br></pre></td></tr></table></figure></div><p>3.真-手动安装</p><ul><li>在<a class="link"   href="https://github.com/robbyrussell/oh-my-zsh" >oh-my-zsh<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>的github主页，手动将zip包下载下来。</li><li>将zip包解压，拷贝至<code>~/.oh-my-zsh</code>目录。此处省略拷贝的操作步骤。</li><li>执行<code>cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</code></li></ul><p>三选一即可，适合各种环境下的安装，然后需要<code>source ~/.zshrc</code>将配置生效。以下修改了<code>.zshrc</code>文件之后，都执行一下这个命令。</p><h3 id="zsh主题"><a href="#zsh主题" class="headerlink" title="zsh主题"></a>zsh主题</h3><p>通过如下命令可以查看可用的<code>Theme</code>：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ls ~/.oh-my-zsh/themes</span><br></pre></td></tr></table></figure></div><p>如何修改zsh主题呢？<br>编辑<code>~/.zshrc</code>文件，将<code>ZSH_THEME=&quot;candy&quot;</code>,即将主题修改为<code>candy</code>。我采用的<code>steeef</code>。</p><h3 id="zsh扩展"><a href="#zsh扩展" class="headerlink" title="zsh扩展"></a>zsh扩展</h3><p>在<code>~/.zshrc</code>中找到<code>plugins</code>关键字，就可以自定义启用的插件了，系统默认加载<code>git</code>。</p><h4 id="git插件"><a href="#git插件" class="headerlink" title="git插件"></a>git插件</h4><p>命令内容可以参考<code>cat ~/.oh-my-zsh/plugins/git/git.plugin.zsh</code>。</p><p>常用的：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gapa    git add --patch</span><br><span class="line">gc!    git commit -v --amend</span><br><span class="line">gcl    git clone --recursive</span><br><span class="line">gclean    git reset --hard &amp;&amp; git clean -dfx</span><br><span class="line">gcm    git checkout master</span><br><span class="line">gcmsg    git commit -m</span><br><span class="line">gco    git checkout</span><br><span class="line">gd    git diff</span><br><span class="line">gdca    git diff --cached</span><br><span class="line">gp    git push</span><br><span class="line">grbc    git rebase --continue</span><br><span class="line">gst    git status</span><br><span class="line">gup    git pull --rebase</span><br></pre></td></tr></table></figure></div><p>完整列表：<code>https://github.com/robbyrussell/oh-my-zsh/wiki/Plugin:git</code></p><h3 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h3><p>解压文件用的，所有的压缩文件，都可以直接<code>x filename</code>，不用记忆参数</p><p>当然，如果你想要用<code>tar</code>命令，可以使用<code>tar -</code>加<code>tab</code>键，zsh会列出参数的含义。</p><h4 id="autojump"><a href="#autojump" class="headerlink" title="autojump"></a>autojump</h4><p>按照<a class="link"   href="https://github.com/wting/autojump" >官方文档<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>介绍，需要使用如下命令安装，而不是一些博客中的介绍：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install autojump-zsh # CentOS</span><br><span class="line">brew install autojump # Mac</span><br></pre></td></tr></table></figure></div><p><code>CentOS</code>安装好之后，需要在<code>~/.zshrc</code>中配置一下，除了在<code>plugins</code>中增加<code>autojump</code>之外，还需要添加一行：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[ -s ~/.autojump/etc/profile.d/autojump.sh ]] &amp;&amp; . ~/.autojump/etc/profile.d/autojump.sh</span><br></pre></td></tr></table></figure></div><p>安装好之后，记得<code>source ~/.zshrc</code>，然后你就可以通过<code>j+目录名</code>快速进行目录跳转。支持目录名的模糊匹配和自动补全。</p><ul><li><code>j -stat</code>：可以查看历史路径库</li></ul><h4 id="zsh-autosuggestions"><a href="#zsh-autosuggestions" class="headerlink" title="zsh-autosuggestions"></a>zsh-autosuggestions</h4><p><a class="link"   href="https://github.com/zsh-users/zsh-autosuggestions" >zsh-autosuggestions<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure></div><p>在 <code>~/.zshrc</code> 中配置</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=(其他的插件 zsh-autosuggestions)</span><br></pre></td></tr></table></figure></div><p>因为箭头<code>→</code>不太方便，在<code>.zshrc</code>中自定义补全快捷键为逗号，但是又一次遇到了需要输入逗号的情况，所以，并不太推荐如下修改：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bindkey &#x27;,&#x27; autosuggest-accept</span><br></pre></td></tr></table></figure></div><h4 id="zsh-syntax-highlighting"><a href="#zsh-syntax-highlighting" class="headerlink" title="zsh-syntax-highlighting"></a>zsh-syntax-highlighting</h4><p><a class="link"   href="https://github.com/zsh-users/zsh-syntax-highlighting" >zsh-syntax-highlighting<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure></div><p><code>~/.zshrc</code>文件中配置：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=(其他的插件 zsh-syntax-highlighting)</span><br></pre></td></tr></table></figure></div><h4 id="git-open"><a href="#git-open" class="headerlink" title="git-open"></a>git-open</h4><p><a class="link"   href="https://github.com/paulirish/git-open" >git-open<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>插件可以在你git项目下打开远程仓库浏览项目。</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/paulirish/git-open.git $ZSH_CUSTOM/plugins/git-open</span><br></pre></td></tr></table></figure></div><h4 id="bat"><a href="#bat" class="headerlink" title="bat"></a>bat</h4><p><code>bat</code> 代替 <code>cat</code><br><code>cat</code> 某个文件，可以在终端直接输出文件内容，<code>bat</code> 相比 <code>cat</code> 增加了行号和颜色高亮 👍</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install bat</span><br></pre></td></tr></table></figure></div><h2 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h2><ul><li>命令历史记录<ul><li>一旦在 shell 敲入正确命令并能执行后，shell 就会存储你所敲入命令的历史记录（存放在<code>~/.zsh_history</code> 文件中），方便再次运行之前的命令。可以按方向键↑和↓来查看之前执行过的命令</li><li>可以用 <code>r</code>来执行上一条命令</li><li>使用 <code>ctrl-r</code> 来搜索命令历史记录</li></ul></li><li>命令别名<ul><li>可以简化命令输入，在 <code>.zshrc</code> 中添加 <code>alias shortcut=&#39;this is the origin command&#39;</code> 一行就相当于添加了别名</li><li>在命令行中输入 <code>alias</code> 可以查看所有的命令别名</li></ul></li></ul><h2 id="使用技巧"><a href="#使用技巧" class="headerlink" title="使用技巧"></a>使用技巧</h2><ul><li>连按两次Tab会列出所有的补全列表并直接开始选择，补全项可以使用 ctrl+n&#x2F;p&#x2F;f&#x2F;b上下左右切换</li><li>智能跳转，安装了 autojump 之后，zsh 会自动记录你访问过的目录，通过 j 目录名 可以直接进行目录跳转，而且目录名支持模糊匹配和自动补全，例如你访问过 hadoop-1.0.0 目录，输入j hado 即可正确跳转。j –stat 可以看你的历史路径库。</li><li>命令选项补全。在zsh中只需要键入 tar -<tab> 就会列出所有的选项和帮助说明</li><li>在当前目录下输入 .. 或 … ，或直接输入当前目录名都可以跳转，你甚至不再需要输入 <code>cd</code> 命令了。在你知道路径的情况下，比如 <code>/usr/local/bin</code> 你可以输入<code> cd /u/l/b</code> 然后按进行补全快速输入</li><li>目录浏览和跳转：输入 d，即可列出你在这个会话里访问的目录列表，输入列表前的序号，即可直接跳转。</li><li>命令参数补全。键入<code> kill &lt;tab&gt;</code> 就会列出所有的进程名和对应的进程号</li><li>更智能的历史命令。在用或者方向上键查找历史命令时，zsh支持限制查找。比如，输入ls,然后再按方向上键，则只会查找用过的ls命令。而此时使用则会仍然按之前的方式查找，忽略 ls</li><li>多个终端会话共享历史记录</li><li>通配符搜索：<code>ls -l **/*.sh</code>，可以递归显示当前目录下的 shell 文件，文件少时可以代替 <code>find</code>。使用 <code>**/</code> 来递归搜索</li><li>扩展环境变量，输入环境变量然后按 就可以转换成表达的值</li><li>在 .zshrc 中添加 <code>setopt HIST_IGNORE_DUPS</code> 可以消除重复记录，也可以利用<code>sort -t &quot;;&quot; -k 2 -u ~/.zsh_history | sort -o ~/.zsh_history</code>手动清除</li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a class="link"   href="https://github.com/wting/autojump" >wting&#x2F;autojump–官方文档<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li><li><a class="link"   href="https://github.com/powerline/fonts" >powerline&#x2F;fonts<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;本文以CentOS 7&amp;#x2F;Mac 为例，介绍zsh的配置使用教程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;准备&quot;&gt;&lt;a href=&quot;#准备&quot; class=&quot;headerlink&quot; title=&quot;准备&quot;&gt;&lt;/a&gt;准备&lt;/h2&gt;&lt;</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Terminal" scheme="https://mirror.geek.xiaoww.com/tags/Terminal/"/>
    
    <category term="Shell" scheme="https://mirror.geek.xiaoww.com/tags/Shell/"/>
    
    <category term="终端" scheme="https://mirror.geek.xiaoww.com/tags/%E7%BB%88%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>sed命令</title>
    <link href="https://mirror.geek.xiaoww.com/posts/sed-command-guide/"/>
    <id>https://mirror.geek.xiaoww.com/posts/sed-command-guide/</id>
    <published>2025-07-18T06:16:32.006Z</published>
    <updated>2025-06-01T10:57:15.187Z</updated>
    
    <content type="html"><![CDATA[<p>sed是一种流编辑器，它是文本处理中非常中的工具，能够完美的配合正则表达式使用，功能不同凡响。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有 改变，除非你使用重定向存储输出。Sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</p><h3 id="sed的选项、命令、替换标记"><a href="#sed的选项、命令、替换标记" class="headerlink" title="sed的选项、命令、替换标记"></a>sed的选项、命令、替换标记</h3><h5 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed [options] &#x27;command&#x27; file(s)</span><br><span class="line">sed [options] -f scriptfile file(s)</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-e&lt;script&gt;或--expression=&lt;script&gt;：以选项中的指定的script来处理输入的文本文件；</span><br><span class="line">-f&lt;script文件&gt;或--file=&lt;script文件&gt;：以选项中指定的script文件来处理输入的文本文件；</span><br><span class="line">-h或--help：显示帮助；</span><br><span class="line">-n或--quiet或——silent：仅显示script处理后的结果；</span><br><span class="line">-V或--version：显示版本信息。</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3></blockquote><p>文件：指定待处理的文本文件列表。</p><blockquote><h3 id="sed命令"><a href="#sed命令" class="headerlink" title="sed命令"></a>sed命令</h3></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">a\ 在当前行下面插入文本。</span><br><span class="line">i\ 在当前行上面插入文本。</span><br><span class="line">c\ 把选定的行改为新的文本。</span><br><span class="line">d 删除，删除选择的行。</span><br><span class="line">D 删除模板块的第一行。</span><br><span class="line">s 替换指定字符</span><br><span class="line">h 拷贝模板块的内容到内存中的缓冲区。</span><br><span class="line">H 追加模板块的内容到内存中的缓冲区。</span><br><span class="line">g 获得内存缓冲区的内容，并替代当前模板块中的文本。</span><br><span class="line">G 获得内存缓冲区的内容，并追加到当前模板块文本的后面。</span><br><span class="line">l 列表不能打印字符的清单。</span><br><span class="line">n 读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。</span><br><span class="line">N 追加下一个输入行到模板块后面并在二者间嵌入一个新行，改变当前行号码。</span><br><span class="line">p 打印模板块的行。</span><br><span class="line">P(大写) 打印模板块的第一行。</span><br><span class="line">q 退出Sed。</span><br><span class="line">b lable 分支到脚本中带有标记的地方，如果分支不存在则分支到脚本的末尾。</span><br><span class="line">r file 从file中读行。</span><br><span class="line">t label if分支，从最后一行开始，条件一旦满足或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。</span><br><span class="line">T label 错误分支，从最后一行开始，一旦发生错误或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。</span><br><span class="line">w file 写并追加模板块到file末尾。  </span><br><span class="line">W file 写并追加模板块的第一行到file末尾。  </span><br><span class="line">! 表示后面的命令对所有没有被选定的行发生作用。  </span><br><span class="line">= 打印当前行号码。  </span><br><span class="line"># 把注释扩展到下一个换行符以前。</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="sed替换标记"><a href="#sed替换标记" class="headerlink" title="sed替换标记"></a>sed替换标记</h3></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g 表示行内全面替换。  </span><br><span class="line">p 表示打印行。  </span><br><span class="line">w 表示把行写入一个文件。  </span><br><span class="line">x 表示互换模板块中的文本和缓冲区中的文本。  </span><br><span class="line">y 表示把一个字符翻译为另外的字符（但是不用于正则表达式）</span><br><span class="line">\1 子串匹配标记</span><br><span class="line">&amp; 已匹配字符串标记</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="sed元字符集"><a href="#sed元字符集" class="headerlink" title="sed元字符集"></a>sed元字符集</h3></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">^ 匹配行开始，如：/^sed/匹配所有以sed开头的行。</span><br><span class="line">$ 匹配行结束，如：/sed$/匹配所有以sed结尾的行。</span><br><span class="line">. 匹配一个非换行符的任意字符，如：/s.d/匹配s后接一个任意字符，最后是d。</span><br><span class="line">* 匹配0个或多个字符，如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。</span><br><span class="line">[] 匹配一个指定范围内的字符，如/[ss]ed/匹配sed和Sed。  </span><br><span class="line">[^] 匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。</span><br><span class="line">\(..\) 匹配子串，保存匹配的字符，如s/\(love\)able/\1rs，loveable被替换成lovers。</span><br><span class="line">&amp; 保存搜索字符用来替换其他字符，如s/love/**&amp;**/，love这成**love**。</span><br><span class="line">\&lt; 匹配单词的开始，如:/\&lt;love/匹配包含以love开头的单词的行。</span><br><span class="line">\&gt; 匹配单词的结束，如/love\&gt;/匹配包含以love结尾的单词的行。</span><br><span class="line">x\&#123;m\&#125; 重复字符x，m次，如：/0\&#123;5\&#125;/匹配包含5个0的行。</span><br><span class="line">x\&#123;m,\&#125; 重复字符x，至少m次，如：/0\&#123;5,\&#125;/匹配至少有5个0的行。</span><br><span class="line">x\&#123;m,n\&#125; 重复字符x，至少m次，不多于n次，如：/0\&#123;5,10\&#125;/匹配5~10个0的行。</span><br></pre></td></tr></table></figure></div><h3 id="sed用法实例"><a href="#sed用法实例" class="headerlink" title="sed用法实例"></a>sed用法实例</h3><blockquote><h3 id="替换操作：s命令"><a href="#替换操作：s命令" class="headerlink" title="替换操作：s命令"></a>替换操作：s命令</h3></blockquote><h5 id="替换文本中的字符串："><a href="#替换文本中的字符串：" class="headerlink" title="替换文本中的字符串："></a>替换文本中的字符串：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;s/book/books/&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="n选项和p命令一起使用表示只打印那些发生替换的行："><a href="#n选项和p命令一起使用表示只打印那些发生替换的行：" class="headerlink" title="-n选项和p命令一起使用表示只打印那些发生替换的行："></a><strong>-n选项</strong>和<strong>p命令</strong>一起使用表示只打印那些发生替换的行：</h5><p><code>sed -n &#39;s/test/TEST/p&#39; file</code></p><h5 id="直接编辑文件选项-i，会匹配file文件中每一行的第一个book替换为books："><a href="#直接编辑文件选项-i，会匹配file文件中每一行的第一个book替换为books：" class="headerlink" title="直接编辑文件选项-i，会匹配file文件中每一行的第一个book替换为books："></a>直接编辑文件<strong>选项-i</strong>，会匹配file文件中每一行的第一个book替换为books：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/book/books/g&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="全面替换标记g"><a href="#全面替换标记g" class="headerlink" title="全面替换标记g"></a>全面替换标记g</h3></blockquote><h5 id="使用后缀-g-标记会替换每一行中的所有匹配："><a href="#使用后缀-g-标记会替换每一行中的所有匹配：" class="headerlink" title="使用后缀 &#x2F;g 标记会替换每一行中的所有匹配："></a>使用后缀 &#x2F;g 标记会替换每一行中的所有匹配：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;s/book/books/g&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="当需要从第N处匹配开始替换时，可以使用-Ng："><a href="#当需要从第N处匹配开始替换时，可以使用-Ng：" class="headerlink" title="当需要从第N处匹配开始替换时，可以使用 &#x2F;Ng："></a>当需要从第N处匹配开始替换时，可以使用 &#x2F;Ng：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">echo sksksksksksk | sed &#x27;s/sk/SK/2g&#x27;</span><br><span class="line">skSKSKSKSKSK</span><br><span class="line"></span><br><span class="line">echo sksksksksksk | sed &#x27;s/sk/SK/3g&#x27;</span><br><span class="line">skskSKSKSKSK</span><br><span class="line"></span><br><span class="line">echo sksksksksksk | sed &#x27;s/sk/SK/4g&#x27;</span><br><span class="line">skskskSKSKSK</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="定界符"><a href="#定界符" class="headerlink" title="定界符"></a>定界符</h3></blockquote><h5 id="以上命令中字符-在sed中作为定界符使用，也可以使用任意的定界符："><a href="#以上命令中字符-在sed中作为定界符使用，也可以使用任意的定界符：" class="headerlink" title="以上命令中字符 &#x2F; 在sed中作为定界符使用，也可以使用任意的定界符："></a>以上命令中字符 &#x2F; 在sed中作为定界符使用，也可以使用任意的定界符：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;s:test:TEXT:g&#x27;</span><br><span class="line">sed &#x27;s|test|TEXT|g&#x27;</span><br></pre></td></tr></table></figure></div><h5 id="定界符出现在样式内部时，需要进行转义："><a href="#定界符出现在样式内部时，需要进行转义：" class="headerlink" title="定界符出现在样式内部时，需要进行转义："></a>定界符出现在样式内部时，需要进行转义：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;s/\/bin/\/usr\/local\/bin/g&#x27;</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="删除操作：d命令"><a href="#删除操作：d命令" class="headerlink" title="删除操作：d命令"></a>删除操作：d命令</h3></blockquote><h5 id="删除空白行："><a href="#删除空白行：" class="headerlink" title="删除空白行："></a>删除空白行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/^$/d&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="删除文件的第2行："><a href="#删除文件的第2行：" class="headerlink" title="删除文件的第2行："></a>删除文件的第2行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;2d&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="删除文件的第2行到末尾所有行："><a href="#删除文件的第2行到末尾所有行：" class="headerlink" title="删除文件的第2行到末尾所有行："></a>删除文件的第2行到末尾所有行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;2,$d&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="删除文件最后一行："><a href="#删除文件最后一行：" class="headerlink" title="删除文件最后一行："></a>删除文件最后一行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;$d&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="删除文件中所有开头是test的行："><a href="#删除文件中所有开头是test的行：" class="headerlink" title="删除文件中所有开头是test的行："></a>删除文件中所有开头是test的行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/^test/&#x27;d file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="已匹配字符串标记"><a href="#已匹配字符串标记" class="headerlink" title="已匹配字符串标记&amp;"></a>已匹配字符串标记&amp;</h3></blockquote><h5 id="正则表达式-w-匹配每一个单词，使用-替换它，-对应于之前所匹配到的单词："><a href="#正则表达式-w-匹配每一个单词，使用-替换它，-对应于之前所匹配到的单词：" class="headerlink" title="正则表达式 \w+ 匹配每一个单词，使用 [&amp;] 替换它，&amp; 对应于之前所匹配到的单词："></a>正则表达式 \w+ 匹配每一个单词，使用 [&amp;] 替换它，&amp; 对应于之前所匹配到的单词：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo this is a test line | sed &#x27;s/\w\+/[&amp;]/g&#x27;</span><br><span class="line">[this] [is] [a] [test] [line]</span><br></pre></td></tr></table></figure></div><h5 id="所有以192-168-0-1开头的行都会被替换成它自已加localhost："><a href="#所有以192-168-0-1开头的行都会被替换成它自已加localhost：" class="headerlink" title="所有以192.168.0.1开头的行都会被替换成它自已加localhost："></a>所有以192.168.0.1开头的行都会被替换成它自已加localhost：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;s/^192.168.0.1/&amp;localhost/&#x27; file</span><br><span class="line">192.168.0.1localhost</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="子串匹配标记-1"><a href="#子串匹配标记-1" class="headerlink" title="子串匹配标记\1"></a>子串匹配标记\1</h3></blockquote><h5 id="匹配给定样式的其中一部分："><a href="#匹配给定样式的其中一部分：" class="headerlink" title="匹配给定样式的其中一部分："></a>匹配给定样式的其中一部分：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo this is digit 7 in a number | sed &#x27;s/digit \([0-9]\)/\1/&#x27;</span><br><span class="line">this is 7 in a number</span><br></pre></td></tr></table></figure></div><h5 id="命令中-digit-7，被替换成了-7。样式匹配到的子串是-7，-用于匹配子串，对于匹配到的第一个子串就标记为-1，依此类推匹配到的第二个结果就是-2，例如："><a href="#命令中-digit-7，被替换成了-7。样式匹配到的子串是-7，-用于匹配子串，对于匹配到的第一个子串就标记为-1，依此类推匹配到的第二个结果就是-2，例如：" class="headerlink" title="命令中 digit 7，被替换成了 7。样式匹配到的子串是 7，(..) 用于匹配子串，对于匹配到的第一个子串就标记为 \1，依此类推匹配到的第二个结果就是 \2，例如："></a>命令中 digit 7，被替换成了 7。样式匹配到的子串是 7，(..) 用于匹配子串，对于匹配到的第一个子串就标记为 <strong>\1</strong>，依此类推匹配到的第二个结果就是 <strong>\2</strong>，例如：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo aaa BBB | sed &#x27;s/\([a-z]\+\) \([A-Z]\+\)/\2 \1/&#x27;</span><br><span class="line">BBB aaa</span><br></pre></td></tr></table></figure></div><h5 id="love被标记为1，所有loveable会被替换成lovers，并打印出来："><a href="#love被标记为1，所有loveable会被替换成lovers，并打印出来：" class="headerlink" title="love被标记为1，所有loveable会被替换成lovers，并打印出来："></a>love被标记为1，所有loveable会被替换成lovers，并打印出来：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;s/\(love\)able/\1rs/p&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="组合多个表达式"><a href="#组合多个表达式" class="headerlink" title="组合多个表达式"></a>组合多个表达式</h3></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;表达式&#x27; | sed &#x27;表达式&#x27;</span><br><span class="line"></span><br><span class="line">等价于：</span><br><span class="line"></span><br><span class="line">sed &#x27;表达式; 表达式&#x27;</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3></blockquote><h5 id="sed表达式可以使用单引号来引用，但是如果表达式内部包含变量字符串，就需要使用双引号。"><a href="#sed表达式可以使用单引号来引用，但是如果表达式内部包含变量字符串，就需要使用双引号。" class="headerlink" title="sed表达式可以使用单引号来引用，但是如果表达式内部包含变量字符串，就需要使用双引号。"></a>sed表达式可以使用单引号来引用，但是如果表达式内部包含变量字符串，就需要使用双引号。</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test=hello</span><br><span class="line">echo hello WORLD | sed &quot;s/$test/HELLO&quot;</span><br><span class="line">HELLO WORLD</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="选定行的范围：-（逗号）"><a href="#选定行的范围：-（逗号）" class="headerlink" title="选定行的范围：,（逗号）"></a>选定行的范围：,（逗号）</h3></blockquote><h5 id="所有在模板test和check所确定的范围内的行都被打印："><a href="#所有在模板test和check所确定的范围内的行都被打印：" class="headerlink" title="所有在模板test和check所确定的范围内的行都被打印："></a>所有在模板test和check所确定的范围内的行都被打印：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;/test/,/check/p&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="打印从第5行开始到第一个包含以test开始的行之间的所有行："><a href="#打印从第5行开始到第一个包含以test开始的行之间的所有行：" class="headerlink" title="打印从第5行开始到第一个包含以test开始的行之间的所有行："></a>打印从第5行开始到第一个包含以test开始的行之间的所有行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;5,/^test/p&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="对于模板test和west之间的行，每行的末尾用字符串aaa-bbb替换："><a href="#对于模板test和west之间的行，每行的末尾用字符串aaa-bbb替换：" class="headerlink" title="对于模板test和west之间的行，每行的末尾用字符串aaa bbb替换："></a>对于模板test和west之间的行，每行的末尾用字符串aaa bbb替换：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/test/,/west/s/$/aaa bbb/&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="多点编辑：e命令"><a href="#多点编辑：e命令" class="headerlink" title="多点编辑：e命令"></a>多点编辑：e命令</h3></blockquote><h5 id="e选项允许在同一行里执行多条命令："><a href="#e选项允许在同一行里执行多条命令：" class="headerlink" title="-e选项允许在同一行里执行多条命令："></a>-e选项允许在同一行里执行多条命令：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e &#x27;1,5d&#x27; -e &#x27;s/test/check/&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="上面sed表达式的第一条命令删除1至5行，第二条命令用check替换test。命令的执行顺序对结果有影响。如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果。"><a href="#上面sed表达式的第一条命令删除1至5行，第二条命令用check替换test。命令的执行顺序对结果有影响。如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果。" class="headerlink" title="上面sed表达式的第一条命令删除1至5行，第二条命令用check替换test。命令的执行顺序对结果有影响。如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果。"></a>上面sed表达式的第一条命令删除1至5行，第二条命令用check替换test。命令的执行顺序对结果有影响。如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果。</h5><h5 id="和-e-等价的命令是-–expression："><a href="#和-e-等价的命令是-–expression：" class="headerlink" title="和 -e 等价的命令是 –expression："></a>和 -e 等价的命令是 –expression：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed --expression=&#x27;s/test/check/&#x27; --expression=&#x27;/love/d&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="从文件读入：r命令"><a href="#从文件读入：r命令" class="headerlink" title="从文件读入：r命令"></a>从文件读入：r命令</h3></blockquote><h5 id="file里的内容被读进来，显示在与test匹配的行后面，如果匹配多行，则file的内容将显示在所有匹配行的下面："><a href="#file里的内容被读进来，显示在与test匹配的行后面，如果匹配多行，则file的内容将显示在所有匹配行的下面：" class="headerlink" title="file里的内容被读进来，显示在与test匹配的行后面，如果匹配多行，则file的内容将显示在所有匹配行的下面："></a>file里的内容被读进来，显示在与test匹配的行后面，如果匹配多行，则file的内容将显示在所有匹配行的下面：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/test/r file&#x27; filename</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="写入文件：w命令"><a href="#写入文件：w命令" class="headerlink" title="写入文件：w命令"></a>写入文件：w命令</h3></blockquote><h5 id="在example中所有包含test的行都被写入file里："><a href="#在example中所有包含test的行都被写入file里：" class="headerlink" title="在example中所有包含test的行都被写入file里："></a>在example中所有包含test的行都被写入file里：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;/test/w file&#x27; example</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="追加（行下）：a-命令"><a href="#追加（行下）：a-命令" class="headerlink" title="追加（行下）：a\命令"></a>追加（行下）：a\命令</h3></blockquote><h5 id="将-this-is-a-test-line-追加到-以test-开头的行后面："><a href="#将-this-is-a-test-line-追加到-以test-开头的行后面：" class="headerlink" title="将 this is a test line 追加到 以test 开头的行后面："></a>将 this is a test line 追加到 以test 开头的行后面：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/^test/a\this is a test line&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="在-test-conf-文件第2行之后插入-this-is-a-test-line："><a href="#在-test-conf-文件第2行之后插入-this-is-a-test-line：" class="headerlink" title="在 test.conf 文件第2行之后插入 this is a test line："></a>在 test.conf 文件第2行之后插入 this is a test line：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;2a\this is a test line&#x27; test.conf</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="插入（行上）：i-命令"><a href="#插入（行上）：i-命令" class="headerlink" title="插入（行上）：i\命令"></a>插入（行上）：i\命令</h3></blockquote><h5 id="将-this-is-a-test-line-追加到以test开头的行前面："><a href="#将-this-is-a-test-line-追加到以test开头的行前面：" class="headerlink" title="将 this is a test line 追加到以test开头的行前面："></a>将 this is a test line 追加到以test开头的行前面：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/^test/i\this is a test line&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="在test-conf文件第5行之前插入this-is-a-test-line："><a href="#在test-conf文件第5行之前插入this-is-a-test-line：" class="headerlink" title="在test.conf文件第5行之前插入this is a test line："></a>在test.conf文件第5行之前插入this is a test line：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;5i\this is a test line&#x27; test.conf</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="下一个：n命令"><a href="#下一个：n命令" class="headerlink" title="下一个：n命令"></a>下一个：n命令</h3></blockquote><h5 id="如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续："><a href="#如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续：" class="headerlink" title="如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续："></a>如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;/test/&#123; n; s/aa/bb/; &#125;&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="变形：y命令"><a href="#变形：y命令" class="headerlink" title="变形：y命令"></a>变形：y命令</h3></blockquote><h5 id="把1-10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令："><a href="#把1-10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令：" class="headerlink" title="把1~10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令："></a>把1~10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;1,10y/abcde/ABCDE/&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="退出：q命令"><a href="#退出：q命令" class="headerlink" title="退出：q命令"></a>退出：q命令</h3></blockquote><h5 id="打印完第10行后，退出sed"><a href="#打印完第10行后，退出sed" class="headerlink" title="打印完第10行后，退出sed"></a>打印完第10行后，退出sed</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;10q&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="保持和获取：h命令和G命令"><a href="#保持和获取：h命令和G命令" class="headerlink" title="保持和获取：h命令和G命令"></a>保持和获取：h命令和G命令</h3></blockquote><h5 id="在sed处理文件的时候，每一行都被保存在一个叫模式空间的临时缓冲区中，除非行被删除或者输出被取消，否则所有被处理的行都将-打印在屏幕上。接着模式空间被清空，并存入新的一行等待处理。"><a href="#在sed处理文件的时候，每一行都被保存在一个叫模式空间的临时缓冲区中，除非行被删除或者输出被取消，否则所有被处理的行都将-打印在屏幕上。接着模式空间被清空，并存入新的一行等待处理。" class="headerlink" title="在sed处理文件的时候，每一行都被保存在一个叫模式空间的临时缓冲区中，除非行被删除或者输出被取消，否则所有被处理的行都将 打印在屏幕上。接着模式空间被清空，并存入新的一行等待处理。"></a>在sed处理文件的时候，每一行都被保存在一个叫模式空间的临时缓冲区中，除非行被删除或者输出被取消，否则所有被处理的行都将 打印在屏幕上。接着模式空间被清空，并存入新的一行等待处理。</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e &#x27;/test/h&#x27; -e &#x27;$G&#x27; file</span><br></pre></td></tr></table></figure></div><h5 id="在这个例子里，匹配test的行被找到后，将存入模式空间，h命令将其复制并存入一个称为保持缓存区的特殊缓冲区内。第二条语句的意思是，当到达最后一行后，G命令取出保持缓冲区的行，然后把它放回模式空间中，且追加到现在已经存在于模式空间中的行的末尾。在这个例子中就是追加到最后一行。简单来说，任何包含test的行都被复制并追加到该文件的末尾。"><a href="#在这个例子里，匹配test的行被找到后，将存入模式空间，h命令将其复制并存入一个称为保持缓存区的特殊缓冲区内。第二条语句的意思是，当到达最后一行后，G命令取出保持缓冲区的行，然后把它放回模式空间中，且追加到现在已经存在于模式空间中的行的末尾。在这个例子中就是追加到最后一行。简单来说，任何包含test的行都被复制并追加到该文件的末尾。" class="headerlink" title="在这个例子里，匹配test的行被找到后，将存入模式空间，h命令将其复制并存入一个称为保持缓存区的特殊缓冲区内。第二条语句的意思是，当到达最后一行后，G命令取出保持缓冲区的行，然后把它放回模式空间中，且追加到现在已经存在于模式空间中的行的末尾。在这个例子中就是追加到最后一行。简单来说，任何包含test的行都被复制并追加到该文件的末尾。"></a>在这个例子里，匹配test的行被找到后，将存入模式空间，h命令将其复制并存入一个称为保持缓存区的特殊缓冲区内。第二条语句的意思是，当到达最后一行后，G命令取出保持缓冲区的行，然后把它放回模式空间中，且追加到现在已经存在于模式空间中的行的末尾。在这个例子中就是追加到最后一行。简单来说，任何包含test的行都被复制并追加到该文件的末尾。</h5><blockquote><h3 id="保持和互换：h命令和x命令"><a href="#保持和互换：h命令和x命令" class="headerlink" title="保持和互换：h命令和x命令"></a>保持和互换：h命令和x命令</h3></blockquote><h5 id="互换模式空间和保持缓冲区的内容。也就是把包含test与check的行互换："><a href="#互换模式空间和保持缓冲区的内容。也就是把包含test与check的行互换：" class="headerlink" title="互换模式空间和保持缓冲区的内容。也就是把包含test与check的行互换："></a>互换模式空间和保持缓冲区的内容。也就是把包含test与check的行互换：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e &#x27;/test/h&#x27; -e &#x27;/check/x&#x27; file</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="脚本scriptfile"><a href="#脚本scriptfile" class="headerlink" title="脚本scriptfile"></a>脚本scriptfile</h3></blockquote><h5 id="sed脚本是一个sed的命令清单，启动Sed时以-f选项引导脚本文件名。Sed对于脚本中输入的命令非常挑剔，在命令的末尾不能有任何空白或文本，如果在一行中有多个命令，要用分号分隔。以-开头的行为注释行，且不能跨行。"><a href="#sed脚本是一个sed的命令清单，启动Sed时以-f选项引导脚本文件名。Sed对于脚本中输入的命令非常挑剔，在命令的末尾不能有任何空白或文本，如果在一行中有多个命令，要用分号分隔。以-开头的行为注释行，且不能跨行。" class="headerlink" title="sed脚本是一个sed的命令清单，启动Sed时以-f选项引导脚本文件名。Sed对于脚本中输入的命令非常挑剔，在命令的末尾不能有任何空白或文本，如果在一行中有多个命令，要用分号分隔。以#开头的行为注释行，且不能跨行。"></a>sed脚本是一个sed的命令清单，启动Sed时以-f选项引导脚本文件名。Sed对于脚本中输入的命令非常挑剔，在命令的末尾不能有任何空白或文本，如果在一行中有多个命令，要用分号分隔。以#开头的行为注释行，且不能跨行。</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [options] -f scriptfile file(s)</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="打印奇数行或偶数行"><a href="#打印奇数行或偶数行" class="headerlink" title="打印奇数行或偶数行"></a>打印奇数行或偶数行</h3></blockquote><h5 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;p;n&#x27; test.txt  #奇数行</span><br><span class="line">sed -n &#x27;n;p&#x27; test.txt  #偶数行</span><br></pre></td></tr></table></figure></div><h5 id="方法2："><a href="#方法2：" class="headerlink" title="方法2："></a>方法2：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;1~2p&#x27; test.txt  #奇数行</span><br><span class="line">sed -n &#x27;2~2p&#x27; test.txt  #偶数行</span><br></pre></td></tr></table></figure></div><blockquote><h3 id="打印匹配字符串的下一行"><a href="#打印匹配字符串的下一行" class="headerlink" title="打印匹配字符串的下一行"></a>打印匹配字符串的下一行</h3></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep -A 1 SCC URFILE</span><br><span class="line">sed -n &#x27;/SCC/&#123;n;p&#125;&#x27; URFILE</span><br><span class="line">awk &#x27;/SCC/&#123;getline; print&#125;&#x27; URFILE</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;sed是一种流编辑器，它是文本处理中非常中的工具，能够完美的配合正则表达式使用，功能不同凡响。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Command" scheme="https://mirror.geek.xiaoww.com/tags/Command/"/>
    
  </entry>
  
  <entry>
    <title>WordPress – 站点底部显示站点运行时间</title>
    <link href="https://mirror.geek.xiaoww.com/posts/wordpress-display-site-uptime-footer/"/>
    <id>https://mirror.geek.xiaoww.com/posts/wordpress-display-site-uptime-footer/</id>
    <published>2025-07-18T06:16:31.995Z</published>
    <updated>2025-06-01T10:59:31.543Z</updated>
    
    <content type="html"><![CDATA[<h1 id="添加代码"><a href="#添加代码" class="headerlink" title="添加代码"></a>添加代码</h1><p>在主题页面的<code>footer.php</code>中的标签之前添加以下代码：</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;<span class="title class_">Powered</span> by &lt;a href=<span class="string">&quot;https://xiaoqy.com&quot;</span> target=<span class="string">&quot;_blank&quot;</span>&gt;<span class="title class_">Cyrus</span> <span class="title class_">Xiao</span>&lt;<span class="regexp">/a&gt;&lt;/</span>div&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>本站已稳定运行：<span class="tag">&lt;<span class="name">SPAN</span> <span class="attr">id</span>=<span class="string">span_dt_dt</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFFFFF;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">SPAN</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">SCRIPT</span> <span class="attr">language</span>=<span class="string">javascript</span>&gt;</span><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">show_date_time</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="string">&quot;show_date_time()&quot;</span>, <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title class_">BirthDay</span>=<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&quot;10/31/2020 00:00:00&quot;</span>);&lt;!-- 这里可以修改站点开始时间 --&gt;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        today=<span class="keyword">new</span> <span class="title class_">Date</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        timeold=(today.<span class="title function_">getTime</span>()-<span class="title class_">BirthDay</span>.<span class="title function_">getTime</span>());</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        sectimeold=timeold/<span class="number">1000</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        secondsold=<span class="title class_">Math</span>.<span class="title function_">floor</span>(sectimeold);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        msPerDay=<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        e_daysold=timeold/msPerDay</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        daysold=<span class="title class_">Math</span>.<span class="title function_">floor</span>(e_daysold);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        e_hrsold=(e_daysold-daysold)*<span class="number">24</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        hrsold=<span class="title class_">Math</span>.<span class="title function_">floor</span>(e_hrsold);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        e_minsold=(e_hrsold-hrsold)*<span class="number">60</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        minsold=<span class="title class_">Math</span>.<span class="title function_">floor</span>((e_hrsold-hrsold)*<span class="number">60</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        seconds=<span class="title class_">Math</span>.<span class="title function_">floor</span>((e_minsold-minsold)*<span class="number">60</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        span_dt_dt.<span class="property">innerHTML</span>=daysold+<span class="string">&#x27;天&#x27;</span>+hrsold+<span class="string">&#x27;时&#x27;</span>+minsold+<span class="string">&#x27;分&#x27;</span>+seconds+<span class="string">&#x27;秒&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">show_date_time</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><ul><li>大致的运行效果如下</li></ul><p><img                       lazyload                     src="/images/loading.svg"                     data-src="/Snipaste_2021-02-26_23-30-56.png"                                     ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;添加代码&quot;&gt;&lt;a href=&quot;#添加代码&quot; class=&quot;headerlink&quot; title=&quot;添加代码&quot;&gt;&lt;/a&gt;添加代码&lt;/h1&gt;&lt;p&gt;在主题页面的&lt;code&gt;footer.php&lt;/code&gt;中的标签之前添加以下代码：&lt;/p&gt;
&lt;div class=&quot;cod</summary>
      
    
    
    
    <category term="前端开发" scheme="https://mirror.geek.xiaoww.com/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="WordPress" scheme="https://mirror.geek.xiaoww.com/tags/WordPress/"/>
    
    <category term="前端开发" scheme="https://mirror.geek.xiaoww.com/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>VIM 分屏基本操作</title>
    <link href="https://mirror.geek.xiaoww.com/posts/vim-split-window-basics/"/>
    <id>https://mirror.geek.xiaoww.com/posts/vim-split-window-basics/</id>
    <published>2025-07-18T06:16:31.990Z</published>
    <updated>2025-06-01T10:58:23.602Z</updated>
    
    <content type="html"><![CDATA[<h3 id="横竖分屏打开新文件"><a href="#横竖分屏打开新文件" class="headerlink" title="横竖分屏打开新文件"></a>横竖分屏打开新文件</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:sp filename</span><br><span class="line">:split filename</span><br><span class="line">:vsp filename</span><br><span class="line">:vsplit filename</span><br><span class="line">:sview filename  -&gt;只读分屏打开文件</span><br></pre></td></tr></table></figure></div><h3 id="从命令行直接打开多个文件且是分屏"><a href="#从命令行直接打开多个文件且是分屏" class="headerlink" title="从命令行直接打开多个文件且是分屏"></a>从命令行直接打开多个文件且是分屏</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim -On file1, file2 ...  -&gt;垂直分屏</span><br><span class="line">vim -on file1, file2 ...  -&gt;水平分屏</span><br></pre></td></tr></table></figure></div><p>注：O垂直分屏，-o水平分屏，n表示分几个屏</p><h3 id="横-竖分屏打开当前文件"><a href="#横-竖分屏打开当前文件" class="headerlink" title="横&#x2F;竖分屏打开当前文件"></a>横&#x2F;竖分屏打开当前文件</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl+W s</span><br><span class="line">ctrl+W v</span><br></pre></td></tr></table></figure></div><h3 id="切换分屏"><a href="#切换分屏" class="headerlink" title="切换分屏"></a>切换分屏</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctrl+w w</span><br><span class="line">ctrl+w h,j,k,l</span><br><span class="line">ctrl+w 上下左右键</span><br></pre></td></tr></table></figure></div><h3 id="关闭分屏"><a href="#关闭分屏" class="headerlink" title="关闭分屏"></a>关闭分屏</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctrl+W c 关闭当前窗口</span><br><span class="line">ctrl+w q 关闭当前窗口，若只有一个分屏且退出vim</span><br><span class="line">:only  仅保留当前分屏</span><br><span class="line">:hide  关闭当前分屏</span><br></pre></td></tr></table></figure></div><h3 id="调整分屏的大小"><a href="#调整分屏的大小" class="headerlink" title="调整分屏的大小"></a>调整分屏的大小</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctrl+w = 所有分屏都统一高度</span><br><span class="line">ctrl+w + 增加高度</span><br><span class="line">ctrl+w - 减少高度</span><br><span class="line">10 ctrl+w + 增加10行高度</span><br></pre></td></tr></table></figure></div><h3 id="移动分屏"><a href="#移动分屏" class="headerlink" title="移动分屏"></a>移动分屏</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl+W H,J,K,L</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;横竖分屏打开新文件&quot;&gt;&lt;a href=&quot;#横竖分屏打开新文件&quot; class=&quot;headerlink&quot; title=&quot;横竖分屏打开新文件&quot;&gt;&lt;/a&gt;横竖分屏打开新文件&lt;/h3&gt;&lt;div class=&quot;code-container&quot; data-rel=&quot;Plainte</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="VIM" scheme="https://mirror.geek.xiaoww.com/tags/VIM/"/>
    
  </entry>
  
  <entry>
    <title>U盘修复 Kali Linux grub引导</title>
    <link href="https://mirror.geek.xiaoww.com/posts/usb-repair-kali-linux-grub/"/>
    <id>https://mirror.geek.xiaoww.com/posts/usb-repair-kali-linux-grub/</id>
    <published>2025-07-18T06:16:31.980Z</published>
    <updated>2025-06-01T10:57:54.217Z</updated>
    
    <content type="html"><![CDATA[<p>U盘启动到live模式，打开终端。</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure></div><p>查看输出结果，然后根据文件类型和分区大小来判定 Linux 系统安装在哪块硬盘和安装的分区。</p><p>挂载安装分区 &#x2F;dev&#x2F;sda3，sda3为Kali Linux所在分区</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sda3 /mnt</span><br></pre></td></tr></table></figure></div><p>挂载其他所需的目录（使用 –bind）</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mount --bind /dev /mnt/dev</span><br><span class="line">mount --bind /proc /mnt/proc</span><br><span class="line">mount --bind /sys /mnt/sys</span><br></pre></td></tr></table></figure></div><p>Chroot 到硬盘上的 Linux 系统</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chroot /mnt</span><br></pre></td></tr></table></figure></div><p>安装&amp;更新 Grub</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grub-install /dev/sda</span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure></div><p>退出 chroot 环境</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure></div><p>卸载分区</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">umount /mnt/dev</span><br><span class="line">umount /mnt/proc</span><br><span class="line">umount /mnt/sys</span><br><span class="line">umount /mnt</span><br></pre></td></tr></table></figure></div><p>reboot重启，引导修复完成</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;U盘启动到live模式，打开终端。&lt;/p&gt;
&lt;div class=&quot;code-container&quot; data-rel=&quot;Plaintext&quot;&gt;&lt;figure class=&quot;iseeu highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Grub" scheme="https://mirror.geek.xiaoww.com/tags/Grub/"/>
    
  </entry>
  
  <entry>
    <title>PicGo搭建博客图床+阿里云OSS教程</title>
    <link href="https://mirror.geek.xiaoww.com/posts/picgo-blog-image-hosting-aliyun-oss/"/>
    <id>https://mirror.geek.xiaoww.com/posts/picgo-blog-image-hosting-aliyun-oss/</id>
    <published>2025-07-18T06:16:31.955Z</published>
    <updated>2025-06-02T08:22:22.248Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>对于写博客来说，搭建一个图床是必不可少的。本地图片插入到文章中，发布之后图片就没得了。转存到CSDN是个不错的选择，但是对于自己搭建的博客来说，还是比较麻烦的。现在，我来手把手教你搭建图床。</p></blockquote><h1 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h1><ul><li>安装PicGo</li><li>图床区</li></ul><p>图床分类：</p><ol><li>SMMS</li><li>七牛图床</li><li>腾讯云COS</li><li>阿里云OSS</li><li>又拍云</li><li>GitHub图床</li><li>Gitee图床</li><li>Imgur图床</li></ol><h2 id="二、PicGo安装"><a href="#二、PicGo安装" class="headerlink" title="二、PicGo安装"></a>二、PicGo安装</h2><p>一个用于快速上传图片并获取图片URL链接的工具</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/1.png!xiaoww-geek"                                     ></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/2.png!xiaoww-geek"                                     ></p><p>PicGo能够文件上传，也支持剪贴板上传</p><p><strong>上传过程为：</strong> 1. 拖拽文件或点击上传文件或点击剪贴板图片上传 2. 上传完成后电脑剪贴板里就有了所选链接格式的图片链接 3. 粘贴即可</p><p><strong>安装好之后要配置一下快捷键</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/3.png!xiaoww-geek"                                     ></p><p>快捷键依据个人习惯配置即可，此处我是<code>Ctrl + W</code></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/4.png!xiaoww-geek"                                     ></p><p>你<code>Ctrl + C</code>截图之后，再按<code>Ctrl + W</code>，截图直接就上传到存储桶中了，图片的路径不再是本地路径了。</p><h2 id="三、配置阿里云OSS"><a href="#三、配置阿里云OSS" class="headerlink" title="三、配置阿里云OSS"></a>三、配置阿里云OSS</h2><p>好多小伙伴搭建个人博客都用了阿里云，怎么，是它不够香吗？很香！云服务器 + OSS使用起来也方便。为了方便大家，我在写这篇文章时，买了一年的阿里云对象存储OSS资源包。</p><p>如果要选择阿里云的小伙伴，先看看这篇薅羊毛助手</p><p>具体就是买的时间越长越便宜，半年￥4.98，建议大家买一年，9块钱。为了学习，不亏！</p><h3 id="购买阿里云OSS服务"><a href="#购买阿里云OSS服务" class="headerlink" title="购买阿里云OSS服务"></a>购买阿里云OSS服务</h3><p><strong>1. 登录阿里云，点击控制台</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/5.png!xiaoww-geek"                                     ></p><p><strong>2. 打开侧边栏，选择对象存储OSS，如下图：</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/6.png!xiaoww-geek"                                     ></p><p><strong>3. 对象存储界面右部选择创建Bucket</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/7.png!xiaoww-geek"                                     ></p><p><strong>4. 侧边栏配置信息</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/8.png!xiaoww-geek"                      alt="image-20210227212310637"                ></p><p><strong>购买对象存储OSS资源包(包月)</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/9.png!xiaoww-geek"                      alt="image-20210227212342648"                ></p><p>购买完之后，需要添加用户。</p><h3 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h3><p><strong>1. 推荐最好是单独创建一个用户来单独操作OSS（用户的定义就是需要访问云资源的人员或应用程序），这样给这个用户赋予单独的访问 OSS的权限，更加安全方便。</strong></p><p>添加用户步骤为：点击自己头像，然后选择访问控制</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/10.png!xiaoww-geek"                      alt="image-20210227212818710"                ></p><p><strong>2. 点击用户，选择新建用户</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/11.png!xiaoww-geek"                      alt="image-20210227212955416"                ></p><p><strong>之后进行用户配置，注意要勾选编程访问，控制台密码登录可以不选择，登录名称，显示名称自己设定</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/12.png!xiaoww-geek"                      alt="image-20210227213158493"                ></p><p><strong>3. 确定后得到创建用户的信息，这里要记下<code>AccessKey ID</code> 和 <code>AccessKeySecret</code>，之后配置PicGo用到，最好 记在记事本里</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/13.png!xiaoww-geek"                      alt="img"                ></p><p>设置用户权限，使得用户只能访问OSS的服务，点击添加权限：</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/14.png!xiaoww-geek"                      alt="image-20210227214159917"                ></p><p><strong>4. 选择管理对象存储服务权限</strong></p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/15.png!xiaoww-geek"                      alt="image-20210227214324279"                ></p><h3 id="配置PicGo"><a href="#配置PicGo" class="headerlink" title="配置PicGo"></a>配置PicGo</h3><div class="code-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;accessKeyId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;accessKeySecret&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;area&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="comment">// 存储区域代号</span></span><br><span class="line">      <span class="attr">&quot;bucket&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="comment">// 存储空间名</span></span><br><span class="line">      <span class="attr">&quot;customUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="comment">// 自定义域名，注意要加http://或者https://</span></span><br><span class="line">      <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="comment">// 自定义存储路径</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/16.png!xiaoww-geek"                      alt="image-20210227214955996"                ></p><ul><li><code>KeyId</code>：就是创建用户的<code>AccessKey ID</code></li><li><code>KeySecret</code>：<code>AccessKeySecret</code></li><li>存储空间名：创建Bucket的名字</li><li>存储区域：创建时设定的， 忘记的可以通过Bucket概览查看（见下图）</li><li>存储路径：默认设置<code>imgs/</code>即可，如果自己有已经备案的域名，可以填写设定自定义域名，如果没有不填即可。</li></ul><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/17.png!xiaoww-geek"                      alt="image-20210227215318557"                ></p><p>设置为默认图床即可</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/18.png!xiaoww-geek"                      alt="image-20210227220655897"                ></p><p>文件上传存储</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://oss.geek.xiaoww.com/images/19.png!xiaoww-geek"                      alt="image-20210227221015808"                ></p><p><strong>到此，云端图床的配置和使用就完成了。更多的图床搭建参考文内的官网链接还有教程即可！</strong></p><p><strong>大家是用什么搭建的个人博客呢？</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;对于写博客来说，搭建一个图床是必不可少的。本地图片插入到文章中，发布之后图片就没得了。转存到CSDN是个不错的选择，但是对于自己搭建的博客来说，还是比较麻烦的。现在，我来手把手教你搭建图床。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;一、</summary>
      
    
    
    
    <category term="互联网" scheme="https://mirror.geek.xiaoww.com/categories/%E4%BA%92%E8%81%94%E7%BD%91/"/>
    
    
    <category term="Aliyun" scheme="https://mirror.geek.xiaoww.com/tags/Aliyun/"/>
    
    <category term="AlibabaCloud" scheme="https://mirror.geek.xiaoww.com/tags/AlibabaCloud/"/>
    
    <category term="PicGo" scheme="https://mirror.geek.xiaoww.com/tags/PicGo/"/>
    
    <category term="OSS" scheme="https://mirror.geek.xiaoww.com/tags/OSS/"/>
    
    <category term="图床" scheme="https://mirror.geek.xiaoww.com/tags/%E5%9B%BE%E5%BA%8A/"/>
    
    <category term="对象存储" scheme="https://mirror.geek.xiaoww.com/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/"/>
    
  </entry>
  
  <entry>
    <title>NOTEPAD++正则表达式</title>
    <link href="https://mirror.geek.xiaoww.com/posts/notepad-plusplus-regex-guide/"/>
    <id>https://mirror.geek.xiaoww.com/posts/notepad-plusplus-regex-guide/</id>
    <published>2025-07-18T06:16:31.930Z</published>
    <updated>2025-06-01T10:56:33.729Z</updated>
    
    <content type="html"><![CDATA[<h1 id="正则表达式语法"><a href="#正则表达式语法" class="headerlink" title="正则表达式语法"></a>正则表达式语法</h1><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">\   转义字符  如：要使用 “\” 本身, 则应该使用“\\”</span><br><span class="line"></span><br><span class="line">\t  Tab制表符  注：扩展和正则表达式都支持</span><br><span class="line"></span><br><span class="line">\r  回车符CR   注：扩展支持，正则表达式不支持</span><br><span class="line"></span><br><span class="line">\n  换行符LF   注：扩展支持，正则表达式不支持</span><br><span class="line"></span><br><span class="line">.  匹配任意一个字符</span><br><span class="line"></span><br><span class="line">^ 其右边的表达式被匹配在行首。如：^A匹配以“A”开头的行</span><br><span class="line"></span><br><span class="line">$ 其左边的表达式被匹配在行尾。如：e$匹配以“e”结尾的行</span><br><span class="line"></span><br><span class="line">|  或运算符，匹配表达式左边和右边的字符串。如：ab|bc匹配“ab”或“bc”</span><br><span class="line"></span><br><span class="line">[] 匹配列表中任意单个字符。如：[ab]匹配“a”或“b”；[0-9]匹配任意单个数字</span><br><span class="line"></span><br><span class="line">[^] 匹配列表之外的任意单个字符。如：[^ab]匹配“a”和“b”以外的单个字符；[^0-9]匹配任意单个非数字字符</span><br><span class="line"></span><br><span class="line">* 其左边的字符被匹配任意次(0次或多次)。如：be*匹配“b”,“be”或“bee”</span><br><span class="line"></span><br><span class="line">+ 其左边的字符被匹配至少一次(1次或多次)。如：be+匹配“be”或“bee”，但不匹配“b”</span><br><span class="line"></span><br><span class="line">? 其左边的字符被匹配0次或者1次。如：be?匹配“b”或“be”，但不匹配“bee”；\r?\n匹配行结尾符</span><br><span class="line"></span><br><span class="line">() 影响表达式匹配的顺序(类似C++的小括号会影响表达式运算顺序)，并且用作表达式的分组标记（标记从1开始）如：([a-z]bc)smn\1匹配“tbcsmntbc”；</span><br><span class="line"></span><br><span class="line">&#123;&#125; 指定前面的字符或分组的出现次数  如：abc&#123;3&#125;匹配abccc；a(bc)&#123;2&#125;匹配abcbc</span><br><span class="line"></span><br><span class="line">\d 匹配一个数字字符。等价于：[0-9]</span><br><span class="line"></span><br><span class="line">\D \d取反，匹配一个非数字字符。等价于：[^0-9]</span><br><span class="line"></span><br><span class="line">\s 匹配任意单个空白字符：包括空格、制表符等（注：不包括换车符和换行符）,等价于：[ \t]</span><br><span class="line"></span><br><span class="line">\S  \s取反的任意单个字符。</span><br><span class="line"></span><br><span class="line">\w 匹配包括下划线的任意单个字符。等价于：[A-Za-z0-9_]</span><br><span class="line"></span><br><span class="line">\W \w取反的任意单个字符。等价于：[^A-Za-z0-9_]</span><br><span class="line"></span><br><span class="line">\b 匹配单词起始处或结尾处  如：\bin匹配int，但不匹配sing</span><br></pre></td></tr></table></figure></div><h1 id="常用示例"><a href="#常用示例" class="headerlink" title="常用示例"></a>常用示例</h1><h3 id="1-校验数字的表达式"><a href="#1-校验数字的表达式" class="headerlink" title="1.校验数字的表达式"></a>1.校验数字的表达式</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">1. 数字：^[0-9]*$</span><br><span class="line"></span><br><span class="line">2. n位的数字：^d&#123;n&#125;$</span><br><span class="line"></span><br><span class="line">3. 至少n位的数字：^d&#123;n,&#125;$</span><br><span class="line"></span><br><span class="line">4. m-n位的数字：^d&#123;m,n&#125;$</span><br><span class="line"></span><br><span class="line">5. 零和非零开头的数字：^(0|[1-9][0-9]*)$</span><br><span class="line"></span><br><span class="line">6. 非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">7. 带1-2位小数的正数或负数：^(-)?d+(.d&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">8. 正数、负数、和小数：^(-|+)?d+(.d+)?$</span><br><span class="line"></span><br><span class="line">9. 有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line"></span><br><span class="line">10. 有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line"></span><br><span class="line">11. 非零的正整数：^[1-9]d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^+?[1-9][0-9]*$</span><br><span class="line"></span><br><span class="line">12. 非零的负整数：^-[1-9][]0-9&quot;*$ 或 ^-[1-9]d*$</span><br><span class="line"></span><br><span class="line">13. 非负整数：^d+$ 或 ^[1-9]d*|0$</span><br><span class="line"></span><br><span class="line">14. 非正整数：^-[1-9]d*|0$ 或 ^((-d+)|(0+))$</span><br><span class="line"></span><br><span class="line">15. 非负浮点数：^d+(.d+)?$ 或 ^[1-9]d*.d*|0.d*[1-9]d*|0?.0+|0$</span><br><span class="line"></span><br><span class="line">16. 非正浮点数：^((-d+(.d+)?)|(0+(.0+)?))$ 或 ^(-([1-9]d*.d*|0.d*[1-9]d*))|0?.0+|0$</span><br><span class="line"></span><br><span class="line">17. 正浮点数：^[1-9]d*.d*|0.d*[1-9]d*$ 或 ^(([0-9]+.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*.[0-9]+)|([0-9]*[1-9][0-9]*))$</span><br><span class="line"></span><br><span class="line">18. 负浮点数：^-([1-9]d*.d*|0.d*[1-9]d*)$ 或 ^(-(([0-9]+.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span><br><span class="line"></span><br><span class="line">19. 浮点数：^(-?d+)(.d+)?$ 或 ^-?([1-9]d*.d*|0.d*[1-9]d*|0?.0+|0)$</span><br></pre></td></tr></table></figure></div><h3 id="2-校验字符的表达式"><a href="#2-校验字符的表达式" class="headerlink" title="2. 校验字符的表达式"></a>2. 校验字符的表达式</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1. 汉字：^[u4e00-u9fa5]&#123;0,&#125;$</span><br><span class="line"></span><br><span class="line">2. 英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span><br><span class="line"></span><br><span class="line">3. 长度为3-20的所有字符：^.&#123;3,20&#125;$</span><br><span class="line"></span><br><span class="line">4. 由26个英文字母组成的字符串：^[A-Za-z]+$</span><br><span class="line"></span><br><span class="line">5. 由26个大写英文字母组成的字符串：^[A-Z]+$</span><br><span class="line"></span><br><span class="line">6. 由26个小写英文字母组成的字符串：^[a-z]+$</span><br><span class="line"></span><br><span class="line">7. 由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span><br><span class="line"></span><br><span class="line">8. 由数字、26个英文字母或者下划线组成的字符串：^w+$ 或 ^w&#123;3,20&#125;$</span><br><span class="line"></span><br><span class="line">9. 中文、英文、数字包括下划线：^[u4E00-u9FA5A-Za-z0-9_]+$</span><br><span class="line"></span><br><span class="line">10. 中文、英文、数字但不包括下划线等符号：^[u4E00-u9FA5A-Za-z0-9]+$ 或 ^[u4E00-u9FA5A-Za-z0-9]&#123;2,20&#125;$</span><br><span class="line"></span><br><span class="line">11. 可以输入含有^%&amp;&#x27;,;=?$&quot;等字符：[^%&amp;&#x27;,;=?$x22]+ 12 禁止输入含有~的字符：[^~x22]+</span><br></pre></td></tr></table></figure></div><h3 id="3-特殊需求表达式"><a href="#3-特殊需求表达式" class="headerlink" title="3. 特殊需求表达式"></a>3. 特殊需求表达式</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">1. Email地址：^w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*$</span><br><span class="line"></span><br><span class="line">2. 域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span><br><span class="line"></span><br><span class="line">3. InternetURL：[a-zA-z]+://[^s]* 或 ^http://([w-]+.)+[w-]+(/[w-./?%&amp;=]*)?$</span><br><span class="line"></span><br><span class="line">4. 手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])d&#123;8&#125;$</span><br><span class="line"></span><br><span class="line">5. 电话号码(&quot;XXX-XXXXXXX&quot;、&quot;XXXX-XXXXXXXX&quot;、&quot;XXX-XXXXXXX&quot;、&quot;XXX-XXXXXXXX&quot;、&quot;XXXXXXX&quot;和&quot;XXXXXXXX)：^((d&#123;3,4&#125;-)|d&#123;3.4&#125;-)?d&#123;7,8&#125;$</span><br><span class="line"></span><br><span class="line">6. 国内电话号码(0511-4405222、021-87888822)：d&#123;3&#125;-d&#123;8&#125;|d&#123;4&#125;-d&#123;7&#125;</span><br><span class="line"></span><br><span class="line">7. 身份证号(15位、18位数字)：^d&#123;15&#125;|d&#123;18&#125;$</span><br><span class="line"></span><br><span class="line">8. 短身份证号码(数字、字母x结尾)：^([0-9])&#123;7,18&#125;(x|X)?$ 或 ^d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$</span><br><span class="line"></span><br><span class="line">9. 帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</span><br><span class="line"></span><br><span class="line">10. 密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]w&#123;5,17&#125;$</span><br><span class="line"></span><br><span class="line">11. 强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.*d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</span><br><span class="line"></span><br><span class="line">12. 日期格式：^d&#123;4&#125;-d&#123;1,2&#125;-d&#123;1,2&#125;</span><br><span class="line"></span><br><span class="line">13. 一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line"></span><br><span class="line">14. 一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$</span><br><span class="line"></span><br><span class="line">15. 钱的输入格式：</span><br><span class="line">    15.1.有四种钱的表示形式我们可以接受:&quot;10000.00&quot; 和 &quot;10,000.00&quot;, 和没有 &quot;分&quot; 的 &quot;10000&quot; 和 &quot;10,000&quot;：^[1-9][0-9]*$</span><br><span class="line"></span><br><span class="line">    15.2.这表示任意一个不以0开头的数字,但是,这也意味着一个字符&quot;0&quot;不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$</span><br><span class="line"></span><br><span class="line">    15.3.一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</span><br><span class="line"></span><br><span class="line">    15.4.这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$</span><br><span class="line"></span><br><span class="line">    15.5.必须说明的是,小数点后面至少应该有1位数,所以&quot;10.&quot;是不通过的,但是 &quot;10&quot; 和 &quot;10.2&quot; 是通过的：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line"></span><br><span class="line">    15.6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">    15.7.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">    15.8. 1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">16. 备注：这就是最终结果了,别忘了&quot;+&quot;可以用&quot;*&quot;替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br><span class="line"></span><br><span class="line">17. xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+.[x|X][m|M][l|L]$</span><br><span class="line"></span><br><span class="line">18. 中文字符的正则表达式：[u4e00-u9fa5]</span><br><span class="line"></span><br><span class="line">19. 双字节字符：[^x00-xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))</span><br><span class="line"></span><br><span class="line">20. 空白行的正则表达式：ns*r (可以用来删除空白行)</span><br><span class="line"></span><br><span class="line">21. HTML标记的正则表达式：&lt;(S*?)[^&gt;]*&gt;.*?&lt;/1&gt;|&lt;.*? /&gt; (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line"></span><br><span class="line">22. 首尾空白字符的正则表达式：^s*|s*$或(^s*)|(s*$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line"></span><br><span class="line">23. 腾讯QQ号：[1-9][0-9]&#123;4,&#125; (腾讯QQ号从10000开始)</span><br><span class="line"></span><br><span class="line">24. 中国邮政编码：[1-9]d&#123;5&#125;(?!d) (中国邮政编码为6位数字)</span><br><span class="line"></span><br><span class="line">25. IP地址：d+.d+.d+.d+ (提取IP地址时有用)</span><br><span class="line"></span><br><span class="line">26. IP地址：((?:(?:25[0-5]|2[0-4]d|[01]?d?d).)&#123;3&#125;(?:25[0-5]|2[0-4]d|[01]?d?d))</span><br></pre></td></tr></table></figure></div><h3 id="4-特定字符s之后的所有字符"><a href="#4-特定字符s之后的所有字符" class="headerlink" title="4. 特定字符s之后的所有字符:"></a>4. 特定字符s之后的所有字符:</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.*$</span><br></pre></td></tr></table></figure></div><h3 id="5-特定字符s之前的所有字符"><a href="#5-特定字符s之前的所有字符" class="headerlink" title="5. 特定字符s之前的所有字符:"></a>5. 特定字符s之前的所有字符:</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^([^s]*)s</span><br></pre></td></tr></table></figure></div><h3 id="6-去除重复行"><a href="#6-去除重复行" class="headerlink" title="6. 去除重复行:"></a>6. 去除重复行:</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(.*?)$\s+?^(?=.*^\1$)</span><br></pre></td></tr></table></figure></div><h3 id="7-所有的中文字符"><a href="#7-所有的中文字符" class="headerlink" title="7.所有的中文字符:"></a>7.所有的中文字符:</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[一-龥！-～]</span><br></pre></td></tr></table></figure></div><h3 id="8-所有行中的第一个中文字符至行尾的所有字符"><a href="#8-所有行中的第一个中文字符至行尾的所有字符" class="headerlink" title="8.所有行中的第一个中文字符至行尾的所有字符:"></a>8.所有行中的第一个中文字符至行尾的所有字符:</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[一-龥！-～].*$</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;正则表达式语法&quot;&gt;&lt;a href=&quot;#正则表达式语法&quot; class=&quot;headerlink&quot; title=&quot;正则表达式语法&quot;&gt;&lt;/a&gt;正则表达式语法&lt;/h1&gt;&lt;div class=&quot;code-container&quot; data-rel=&quot;Plaintext&quot;&gt;&lt;fig</summary>
      
    
    
    
    <category term="文本编辑" scheme="https://mirror.geek.xiaoww.com/categories/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91/"/>
    
    
    <category term="NOTEPAD++" scheme="https://mirror.geek.xiaoww.com/tags/NOTEPAD/"/>
    
    <category term="编辑器" scheme="https://mirror.geek.xiaoww.com/tags/%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>MySQL 基本操作：增删改查</title>
    <link href="https://mirror.geek.xiaoww.com/posts/mysql-basic-crud-operations/"/>
    <id>https://mirror.geek.xiaoww.com/posts/mysql-basic-crud-operations/</id>
    <published>2025-07-18T06:16:31.921Z</published>
    <updated>2025-05-31T17:34:21.728Z</updated>
    
    <content type="html"><![CDATA[<h3 id="所有字段插入值"><a href="#所有字段插入值" class="headerlink" title="所有字段插入值"></a>所有字段插入值</h3><h5 id="注意插入值数目要与字段值一致"><a href="#注意插入值数目要与字段值一致" class="headerlink" title="注意插入值数目要与字段值一致"></a>注意插入值数目要与字段值一致</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO student VALUES(1,&#x27;熊大&#x27;,&#x27;123&#x27;,&#x27;2019-10-18&#x27;,1200);</span><br><span class="line">INSERT INTO student VALUES(3,&#x27;熊二&#x27;,&#x27;123&#x27;,&#x27;2019-10-18&#x27;,1200);</span><br></pre></td></tr></table></figure></div><h3 id="部分字段插入值"><a href="#部分字段插入值" class="headerlink" title="部分字段插入值"></a>部分字段插入值</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT  INTO student (uid,PASSWORD, money)VALUES(2,&#x27;123456&#x27;,10000);</span><br></pre></td></tr></table></figure></div><h3 id="修改语句"><a href="#修改语句" class="headerlink" title="修改语句"></a>修改语句</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE student SET uname=&#x27;熊二&#x27; WHERE uid=2;</span><br><span class="line">UPDATE student SET PASSWORD=&#x27;123456&#x27; WHERE uname=&#x27;熊二&#x27;;</span><br></pre></td></tr></table></figure></div><h3 id="修改多个逗号分隔"><a href="#修改多个逗号分隔" class="headerlink" title="修改多个逗号分隔"></a>修改多个逗号分隔</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE student SET uname=&#x27;琪琪国王&#x27;,PASSWORD=&#x27;admin&#x27;WHERE uid=1;</span><br><span class="line">UPDATE student SET birth=&#x27;2019/11/29&#x27;WHERE uid=2;</span><br></pre></td></tr></table></figure></div><h3 id="不带条件的删除：全表删除-能回滚-只能删除数据不删约束"><a href="#不带条件的删除：全表删除-能回滚-只能删除数据不删约束" class="headerlink" title="不带条件的删除：全表删除 能回滚 只能删除数据不删约束"></a>不带条件的删除：全表删除 能回滚 只能删除数据不删约束</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM student</span><br></pre></td></tr></table></figure></div><h3 id="带条件的删除"><a href="#带条件的删除" class="headerlink" title="带条件的删除"></a>带条件的删除</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM student WHERE uid=3</span><br></pre></td></tr></table></figure></div><h3 id="全表删除-不能回滚-数据约束全删"><a href="#全表删除-不能回滚-数据约束全删" class="headerlink" title="全表删除 不能回滚 数据约束全删"></a>全表删除 不能回滚 数据约束全删</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE student</span><br></pre></td></tr></table></figure></div><h3 id="查询所有数据"><a href="#查询所有数据" class="headerlink" title="查询所有数据"></a>查询所有数据</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT *FROM student;</span><br></pre></td></tr></table></figure></div><h3 id="查询指定字段的值"><a href="#查询指定字段的值" class="headerlink" title="查询指定字段的值"></a>查询指定字段的值</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT uname,PASSWORD FROM student</span><br></pre></td></tr></table></figure></div><h3 id="查询时添加常量列"><a href="#查询时添加常量列" class="headerlink" title="查询时添加常量列"></a>查询时添加常量列</h3><p>SELECT uname AS n,PASSWORD AS p FROM student</p><h3 id="查询时合并列"><a href="#查询时合并列" class="headerlink" title="查询时合并列"></a>查询时合并列</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT sname,(html+js+jquery)/3 AS savg FROM score</span><br></pre></td></tr></table></figure></div><h3 id="查询时保留小数位数"><a href="#查询时保留小数位数" class="headerlink" title="查询时保留小数位数"></a>查询时保留小数位数</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT sname,FORMAT(html,3) AS html FROM score</span><br></pre></td></tr></table></figure></div><h3 id="查询时对某个字段的值进行去重"><a href="#查询时对某个字段的值进行去重" class="headerlink" title="查询时对某个字段的值进行去重"></a>查询时对某个字段的值进行去重</h3><h5 id="查询所有同学所在的班级都有那几个班级"><a href="#查询所有同学所在的班级都有那几个班级" class="headerlink" title="查询所有同学所在的班级都有那几个班级"></a>查询所有同学所在的班级都有那几个班级</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT sclass FROM score</span><br><span class="line">SELECT DISTINCT(sclass) FROM score</span><br></pre></td></tr></table></figure></div><h3 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h3><h5 id="查询所有女生的所有信息"><a href="#查询所有女生的所有信息" class="headerlink" title="查询所有女生的所有信息"></a>查询所有女生的所有信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE sex=&#x27;女&#x27;</span><br></pre></td></tr></table></figure></div><h5 id="查询所有男生的姓名，html成绩和jquery成绩"><a href="#查询所有男生的姓名，html成绩和jquery成绩" class="headerlink" title="查询所有男生的姓名，html成绩和jquery成绩*&#x2F;"></a>查询所有男生的姓名，html成绩和jquery成绩*&#x2F;</h5><p>SELECT sname,html,jquery FROM score WHERE sex&#x3D;’男’<br>&#x2F;<em>查询外婆在哪个班</em>&#x2F;<br>SELECT sclass FROM score WHERE sname&#x3D;’外婆’<br>&#x2F;<em>查询所有js成绩不合格的同学的姓名</em>&#x2F;<br>SELECT sname FROM score WHERE js&lt;60</p><p>&#x2F;*查询jquery成绩合格的所有女同学信息</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE jquery&gt;=60 AND sex=&#x27;女&#x27;</span><br></pre></td></tr></table></figure></div><h5 id="查询所有html成绩不合格的男同学姓名"><a href="#查询所有html成绩不合格的男同学姓名" class="headerlink" title="查询所有html成绩不合格的男同学姓名"></a>查询所有html成绩不合格的男同学姓名</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT sname FROM score WHERE html&lt;60 AND sex=&#x27;男&#x27;</span><br></pre></td></tr></table></figure></div><h5 id="查询js成绩合格或者是html成绩合格的同学信息"><a href="#查询js成绩合格或者是html成绩合格的同学信息" class="headerlink" title="查询js成绩合格或者是html成绩合格的同学信息"></a>查询js成绩合格或者是html成绩合格的同学信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE js&gt;=60 OR html&gt;=60</span><br></pre></td></tr></table></figure></div><h5 id="查询性别为男或者是java1018的同学姓名"><a href="#查询性别为男或者是java1018的同学姓名" class="headerlink" title="查询性别为男或者是java1018的同学姓名"></a>查询性别为男或者是java1018的同学姓名</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE js&gt;=60 OR html&gt;=60;</span><br></pre></td></tr></table></figure></div><p>####不等于 &lt;&gt; !&#x3D;</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE html&lt;&gt;10;</span><br></pre></td></tr></table></figure></div><h5 id="查询HTML成绩在70-100之间同学信息-包头包尾student"><a href="#查询HTML成绩在70-100之间同学信息-包头包尾student" class="headerlink" title="查询HTML成绩在70-100之间同学信息 包头包尾student"></a>查询HTML成绩在70-100之间同学信息 包头包尾<code>student</code></h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE html BETWEEN 70 AND 100;</span><br></pre></td></tr></table></figure></div><h5 id="查询学生表中-姓名不为空的学生信息"><a href="#查询学生表中-姓名不为空的学生信息" class="headerlink" title="查询学生表中 姓名不为空的学生信息"></a>查询学生表中 姓名不为空的学生信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM student WHERE uname&lt;&gt;&#x27;&#x27; AND uname IS NOT NULL;</span><br></pre></td></tr></table></figure></div><h5 id="查询学生表中-mima为空的学生信息"><a href="#查询学生表中-mima为空的学生信息" class="headerlink" title="查询学生表中 mima为空的学生信息"></a>查询学生表中 mima为空的学生信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM student WHERE PASSWORD=&#x27;&#x27; OR PASSWORD IS NULL;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表中性大的信息"><a href="#查询score表中性大的信息" class="headerlink" title="查询score表中性大的信息"></a>查询score表中性大的信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE sname LIKE &#x27;大%&#x27;;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表中性大两个的信息"><a href="#查询score表中性大两个的信息" class="headerlink" title="查询score表中性大两个的信息"></a>查询score表中性大两个的信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE sname LIKE &#x27;大_&#x27;;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表中性两个的信息"><a href="#查询score表中性两个的信息" class="headerlink" title="查询score表中性两个的信息"></a>查询score表中性两个的信息</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM score WHERE sname LIKE &#x27;__&#x27;;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表java1018-js-总成绩"><a href="#查询score表java1018-js-总成绩" class="headerlink" title="查询score表java1018 js 总成绩"></a>查询score表java1018 js 总成绩</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUM(js)AS js总成绩 FROM score WHERE sclass=&#x27;java1018&#x27;;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表java0723-html-平均成绩"><a href="#查询score表java0723-html-平均成绩" class="headerlink" title="查询score表java0723 html 平均成绩"></a>查询score表java0723 html 平均成绩</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT FORMAT(AVG(html),2) FROM score WHERE sclass=&#x27;java0723&#x27;;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表java1018-jquery最高分"><a href="#查询score表java1018-jquery最高分" class="headerlink" title="查询score表java1018 jquery最高分"></a>查询score表java1018 jquery最高分</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT MAX(jquery) FROM score WHERE sclass=&#x27;java1018&#x27;;</span><br></pre></td></tr></table></figure></div><h5 id="查询score表所有学生总成绩的最低分"><a href="#查询score表所有学生总成绩的最低分" class="headerlink" title="查询score表所有学生总成绩的最低分"></a>查询score表所有学生总成绩的最低分</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(IFNULL(jquery,0)+IFNULL(js,0)+IFNULL(html,0)) FROM score;</span><br></pre></td></tr></table></figure></div><h5 id="查询score本班有多少人-COUNT-原理是把每一列都统计一下取最大值"><a href="#查询score本班有多少人-COUNT-原理是把每一列都统计一下取最大值" class="headerlink" title="查询score本班有多少人  COUNT(*)原理是把每一列都统计一下取最大值"></a>查询score本班有多少人  COUNT(*)原理是把每一列都统计一下取最大值</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT COUNT(*)FROM score;</span><br></pre></td></tr></table></figure></div><h5 id="查询本班有多少人"><a href="#查询本班有多少人" class="headerlink" title="查询本班有多少人"></a>查询本班有多少人</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT sname,COUNT(*) FROM score</span><br><span class="line"></span><br><span class="line">-- 分页查询</span><br><span class="line">-- 每页显示两条</span><br><span class="line">-- 第一页 limit 起始行（从零开始），每页显示行数</span><br><span class="line">-- 分页：limit(当前页-1)*每页显示的条数，每页显示的条数</span><br><span class="line">SELECT * from score LIMIT 0,2;</span><br><span class="line">/*第二页*/</span><br><span class="line">SELECT * from score LIMIT 2,2;</span><br><span class="line">/*第三页*/</span><br><span class="line">SELECT * from score LIMIT 4,2;</span><br></pre></td></tr></table></figure></div><h3 id="排序放到最后"><a href="#排序放到最后" class="headerlink" title="排序放到最后"></a>排序放到最后</h3><h5 id="查询所有同学信息并且按照js成绩从大到小排"><a href="#查询所有同学信息并且按照js成绩从大到小排" class="headerlink" title="查询所有同学信息并且按照js成绩从大到小排"></a>查询所有同学信息并且按照js成绩从大到小排</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT *from score ORDER BY js desc;</span><br><span class="line">SELECT *from score ORDER BY js asc;</span><br><span class="line">SELECT *from score ORDER BY js;</span><br><span class="line">-- 查询所有同学信息并且按照js成绩从大到小排 jquery成绩正序</span><br><span class="line">SELECT *from score ORDER BY js desc,jquery asc;</span><br></pre></td></tr></table></figure></div><h5 id="查询男女的人数"><a href="#查询男女的人数" class="headerlink" title="查询男女的人数"></a>查询男女的人数</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select sex,COUNT(*) FROM score  GROUP BY sex ORDER BY COUNT(*);</span><br></pre></td></tr></table></figure></div><h5 id="查询每个性别的js总成绩"><a href="#查询每个性别的js总成绩" class="headerlink" title="查询每个性别的js总成绩"></a>查询每个性别的js总成绩</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT sex,SUM(js)FROM score  GROUP BY sex ORDER BY sum(js);</span><br></pre></td></tr></table></figure></div><h5 id="查询哪个性别的js高于60分总成绩"><a href="#查询哪个性别的js高于60分总成绩" class="headerlink" title="查询哪个性别的js高于60分总成绩"></a>查询哪个性别的js高于60分总成绩</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT sex,SUM(js)FROM score  GROUP BY sex HAVING sum(js)&gt;60 ;</span><br><span class="line">SELECT sex,SUM(js)as tt FROM score  GROUP BY sex HAVING tt&gt;60;</span><br></pre></td></tr></table></figure></div><h5 id="查询java1018班每个性别的js总成绩且高于60分"><a href="#查询java1018班每个性别的js总成绩且高于60分" class="headerlink" title="查询java1018班每个性别的js总成绩且高于60分"></a>查询java1018班每个性别的js总成绩且高于60分</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT sex,SUM(js)FROM score WHERE sclass=&#x27;java1018&#x27; GROUP BY sex HAVING sum(js)&gt;=60 ;</span><br></pre></td></tr></table></figure></div><h5 id="查询那个姓别的人数大于一"><a href="#查询那个姓别的人数大于一" class="headerlink" title="查询那个姓别的人数大于一"></a>查询那个姓别的人数大于一</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT sex,sum(js),sum(jquery),sum(html)FROM score GROUP BY sex;</span><br><span class="line">SELECT sex FROM score GROUP BY sex HAVING sex&lt;&gt;&#x27;女&#x27;and count(*)&gt;1;</span><br><span class="line">SELECT SUM(IFNULL(js,0))AS js总成绩 FROM score WHERE sclass=&#x27;java1018&#x27;;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;所有字段插入值&quot;&gt;&lt;a href=&quot;#所有字段插入值&quot; class=&quot;headerlink&quot; title=&quot;所有字段插入值&quot;&gt;&lt;/a&gt;所有字段插入值&lt;/h3&gt;&lt;h5 id=&quot;注意插入值数目要与字段值一致&quot;&gt;&lt;a href=&quot;#注意插入值数目要与字段值一致&quot; cla</summary>
      
    
    
    
    <category term="数据库" scheme="https://mirror.geek.xiaoww.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="https://mirror.geek.xiaoww.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Linux服务器安全配置(Centos7)</title>
    <link href="https://mirror.geek.xiaoww.com/posts/linux-server-security-config-centos7/"/>
    <id>https://mirror.geek.xiaoww.com/posts/linux-server-security-config-centos7/</id>
    <published>2025-07-18T06:16:31.909Z</published>
    <updated>2025-05-31T17:33:43.010Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-建立其他用户"><a href="#1-建立其他用户" class="headerlink" title="1.建立其他用户"></a>1.建立其他用户</h3><p><code>useradd userid</code><br><code>passwd userid</code></p><h5 id="移动klarkzh到wheel分组后删除userid分组"><a href="#移动klarkzh到wheel分组后删除userid分组" class="headerlink" title="移动klarkzh到wheel分组后删除userid分组"></a>移动klarkzh到wheel分组后删除userid分组</h5><p><code>usermod -g wheel userid</code></p><h3 id="2-注释掉系统不需要的用户和用户组"><a href="#2-注释掉系统不需要的用户和用户组" class="headerlink" title="2.注释掉系统不需要的用户和用户组"></a>2.注释掉系统不需要的用户和用户组</h3><h5 id="cp-etc-passwd-etc-passwdbak-修改之前先备份"><a href="#cp-etc-passwd-etc-passwdbak-修改之前先备份" class="headerlink" title="cp &#x2F;etc&#x2F;passwd &#x2F;etc&#x2F;passwdbak    #修改之前先备份"></a>cp &#x2F;etc&#x2F;passwd &#x2F;etc&#x2F;passwdbak    #修改之前先备份</h5><h5 id="vi-etc-passwd-编辑用户，在前面加上-注释掉此行"><a href="#vi-etc-passwd-编辑用户，在前面加上-注释掉此行" class="headerlink" title="vi &#x2F;etc&#x2F;passwd   #编辑用户，在前面加上#注释掉此行"></a>vi &#x2F;etc&#x2F;passwd   #编辑用户，在前面加上#注释掉此行</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">#lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">#sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">#shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">#halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">#uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin</span><br><span class="line">#operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">#games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">#gopher:x:13:30:gopher:/var/gopher:/sbin/nologin</span><br><span class="line">#ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin #注释掉ftp匿名账号</span><br></pre></td></tr></table></figure></div><h5 id="cp-etc-group-etc-groupbak-修改之前先备份"><a href="#cp-etc-group-etc-groupbak-修改之前先备份" class="headerlink" title="cp &#x2F;etc&#x2F;group &#x2F;etc&#x2F;groupbak  #修改之前先备份"></a>cp &#x2F;etc&#x2F;group &#x2F;etc&#x2F;groupbak  #修改之前先备份</h5><h5 id="vi-etc-group-编辑用户组，在前面加上-注释掉此行"><a href="#vi-etc-group-编辑用户组，在前面加上-注释掉此行" class="headerlink" title="vi &#x2F;etc&#x2F;group   #编辑用户组，在前面加上#注释掉此行"></a>vi &#x2F;etc&#x2F;group   #编辑用户组，在前面加上#注释掉此行</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#adm:x:4:root,adm,daemon</span><br><span class="line">#lp:x:7:daemon,lp</span><br><span class="line">#uucp:x:14:uucp</span><br><span class="line">#games:x:20:</span><br><span class="line">#dip:x:40:</span><br><span class="line">#news:x:9:13:news:/etc/news:</span><br></pre></td></tr></table></figure></div><h3 id="3-关闭系统不需要的服务"><a href="#3-关闭系统不需要的服务" class="headerlink" title="3.关闭系统不需要的服务"></a>3.关闭系统不需要的服务</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">service acpid stop chkconfig acpid off #停止服务，取消开机启动 #电源进阶设定，常用在 Laptop 上</span><br><span class="line">service autofs stop chkconfig autofs off #停用自动挂载档桉系统与週边装置</span><br><span class="line">service bluetooth stop chkconfig bluetooth off #停用Bluetooth蓝芽</span><br><span class="line">service cpuspeed stop chkconfig cpuspeed off #停用控制CPU速度主要用来省电</span><br><span class="line">service cups stop chkconfig cups off #停用 Common UNIX Printing System 使系统支援印表机</span><br><span class="line">service ip6tables stop chkconfig ip6tables off #禁止IPv6</span><br></pre></td></tr></table></figure></div><h5 id="如果要恢复某一个服务，可以执行下面操作"><a href="#如果要恢复某一个服务，可以执行下面操作" class="headerlink" title="如果要恢复某一个服务，可以执行下面操作"></a>如果要恢复某一个服务，可以执行下面操作</h5><p><code>service acpid start chkconfig acpid on</code></p><h3 id="4-禁止非root用户执行-etc-rc-d-init-d-下的系统命令"><a href="#4-禁止非root用户执行-etc-rc-d-init-d-下的系统命令" class="headerlink" title="4.禁止非root用户执行&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;下的系统命令"></a>4.禁止非root用户执行&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;下的系统命令</h3><p><code>chmod -R 700 /etc/rc.d/init.d/*</code><br><code>chmod -R 777 /etc/rc.d/init.d/* #恢复默认设置</code></p><h3 id="5-给下面的文件加上不可更改属性，从而防止非授权用户获得权限"><a href="#5-给下面的文件加上不可更改属性，从而防止非授权用户获得权限" class="headerlink" title="5.给下面的文件加上不可更改属性，从而防止非授权用户获得权限"></a>5.给下面的文件加上不可更改属性，从而防止非授权用户获得权限</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chattr +i /etc/passwd</span><br><span class="line">chattr +i /etc/shadow</span><br><span class="line">chattr +i /etc/group</span><br><span class="line">chattr +i /etc/gshadow</span><br><span class="line">chattr +i /etc/services #给系统服务端口列表文件加锁,防止未经许可的删除或添加服务</span><br><span class="line">lsattr /etc/passwd /etc/shadow /etc/group /etc/gshadow /etc/services #显示文件的属性</span><br></pre></td></tr></table></figure></div><h5 id="注意：执行以上权限修改之后，就无法添加删除用户了。果再要添加删除用户，需要先取消上面的设置，等用户添加删除完成之后，再执行上面的操作。"><a href="#注意：执行以上权限修改之后，就无法添加删除用户了。果再要添加删除用户，需要先取消上面的设置，等用户添加删除完成之后，再执行上面的操作。" class="headerlink" title="注意：执行以上权限修改之后，就无法添加删除用户了。果再要添加删除用户，需要先取消上面的设置，等用户添加删除完成之后，再执行上面的操作。"></a>注意：执行以上权限修改之后，就无法添加删除用户了。果再要添加删除用户，需要先取消上面的设置，等用户添加删除完成之后，再执行上面的操作。</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chattr -i /etc/passwd #取消权限锁定设置</span><br><span class="line">chattr -i /etc/shadow</span><br><span class="line">chattr -i /etc/group</span><br><span class="line">chattr -i /etc/gshadow</span><br><span class="line">chattr -i /etc/services #取消系统服务端口列表文件加锁</span><br></pre></td></tr></table></figure></div><h5 id="现在可以进行添加删除用户了，操作完之后再锁定目录文件"><a href="#现在可以进行添加删除用户了，操作完之后再锁定目录文件" class="headerlink" title="现在可以进行添加删除用户了，操作完之后再锁定目录文件"></a>现在可以进行添加删除用户了，操作完之后再锁定目录文件</h5><p>###6.限制不同文件的权限</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">chattr +a .bash_history #避免删除.bash_history或者重定向到/dev/null</span><br><span class="line">chattr +i .bash_history</span><br><span class="line">chmod 700 /usr/bin #恢复 chmod 555 /usr/bin</span><br><span class="line">chmod 700 /bin/ping #恢复 chmod 4755 /bin/ping</span><br><span class="line">chmod 700 /usr/bin/vim #恢复 chmod 755 /usr/bin/vim</span><br><span class="line">chmod 700 /bin/netstat #恢复 chmod 755 /bin/netstat</span><br><span class="line">chmod 700 /usr/bin/tail #恢复 chmod 755 /usr/bin/tail</span><br><span class="line">chmod 700 /usr/bin/less #恢复 chmod 755 /usr/bin/less</span><br><span class="line">chmod 700 /usr/bin/head#恢复 chmod 755 /usr/bin/head</span><br><span class="line">chmod 700 /bin/cat #恢复 chmod 755 /bin/cat</span><br><span class="line">chmod 700 /bin/uname #恢复 chmod 755 /bin/uname</span><br><span class="line">chmod 500 /bin/ps #恢复 chmod 755 /bin/ps</span><br></pre></td></tr></table></figure></div><h3 id="7-禁止使用Ctrl-Alt-Del快捷键重启服务器"><a href="#7-禁止使用Ctrl-Alt-Del快捷键重启服务器" class="headerlink" title="7.禁止使用Ctrl+Alt+Del快捷键重启服务器"></a>7.禁止使用Ctrl+Alt+Del快捷键重启服务器</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/inittab /etc/inittabbak</span><br><span class="line">vi /etc/inittab #注释掉下面这一行</span><br><span class="line">#ca::ctrlaltdel:/sbin/shutdown -t3 -r now</span><br></pre></td></tr></table></figure></div><h3 id="8-使用yum-update更新系统时不升级内核，只更新软件包"><a href="#8-使用yum-update更新系统时不升级内核，只更新软件包" class="headerlink" title="8.使用yum update更新系统时不升级内核，只更新软件包"></a>8.使用yum update更新系统时不升级内核，只更新软件包</h3><h5 id="由于系统与硬件的兼容性问题，有可能升级内核后导致服务器不能正常启动，这是非常可怕的，没有特别的需要，建议不要随意升级内核。"><a href="#由于系统与硬件的兼容性问题，有可能升级内核后导致服务器不能正常启动，这是非常可怕的，没有特别的需要，建议不要随意升级内核。" class="headerlink" title="由于系统与硬件的兼容性问题，有可能升级内核后导致服务器不能正常启动，这是非常可怕的，没有特别的需要，建议不要随意升级内核。"></a>由于系统与硬件的兼容性问题，有可能升级内核后导致服务器不能正常启动，这是非常可怕的，没有特别的需要，建议不要随意升级内核。</h5><ul><li><h5 id="修改yum的配置文件-vi-etc-yum-conf-在-main-的最后添加-exclude-kernel"><a href="#修改yum的配置文件-vi-etc-yum-conf-在-main-的最后添加-exclude-kernel" class="headerlink" title="修改yum的配置文件 vi &#x2F;etc&#x2F;yum.conf 在[main]的最后添加 exclude&#x3D;kernel*"></a>修改yum的配置文件 vi &#x2F;etc&#x2F;yum.conf 在[main]的最后添加 exclude&#x3D;kernel*</h5></li><li><h5 id="直接在yum的命令后面加上如下的参数：yum-exclude-kernel-update"><a href="#直接在yum的命令后面加上如下的参数：yum-exclude-kernel-update" class="headerlink" title="直接在yum的命令后面加上如下的参数：yum --exclude=kernel* update"></a>直接在yum的命令后面加上如下的参数：<code>yum --exclude=kernel* update</code></h5><h5 id="查看系统版本cat-etc-issue"><a href="#查看系统版本cat-etc-issue" class="headerlink" title="查看系统版本cat /etc/issue"></a>查看系统版本<code>cat /etc/issue</code></h5><h5 id="查看内核版本uname-a"><a href="#查看内核版本uname-a" class="headerlink" title="查看内核版本uname -a"></a>查看内核版本<code>uname -a</code></h5></li></ul><h3 id="9-关闭Centos自动更新"><a href="#9-关闭Centos自动更新" class="headerlink" title="9.关闭Centos自动更新"></a>9.关闭Centos自动更新</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list yum-updatesd #显示当前系统状态</span><br><span class="line">yum-updatesd   #0:关闭 1:关闭 2:启用 3:启用 4:启用 5:启用 6:关闭</span><br><span class="line">service yum-updatesd stop #关闭 开启参数为start</span><br><span class="line"># 停止 yum-updatesd： [确定]</span><br><span class="line">service yum-updatesd status #查看是否关闭</span><br><span class="line">yum-updatesd # 已停</span><br><span class="line">chkconfig --level 35 yum-updatesd off #禁止开启启动（系统模式为3、5）</span><br><span class="line">chkconfig yum-updatesd off #禁止开启启动（所有启动模式全部禁止）</span><br><span class="line">chkconfig --list yum-updatesd #显示当前系统状态</span><br><span class="line">yum-updatesd # 0:关闭 1:关闭 2:启用 3:关闭 4:启用 5:关闭 6:关闭</span><br></pre></td></tr></table></figure></div><h3 id="10-关闭多余的虚拟控制台"><a href="#10-关闭多余的虚拟控制台" class="headerlink" title="10.关闭多余的虚拟控制台"></a>10.关闭多余的虚拟控制台</h3><h5 id="我们知道从控制台切换到-X-窗口，一般采用-Alt-F7-，为什么呢？因为系统默认定义了-6-个虚拟控制台，"><a href="#我们知道从控制台切换到-X-窗口，一般采用-Alt-F7-，为什么呢？因为系统默认定义了-6-个虚拟控制台，" class="headerlink" title="我们知道从控制台切换到 X 窗口，一般采用 Alt-F7 ，为什么呢？因为系统默认定义了 6 个虚拟控制台，"></a>我们知道从控制台切换到 X 窗口，一般采用 Alt-F7 ，为什么呢？因为系统默认定义了 6 个虚拟控制台，</h5><p>所以 X 就成了第7个。实际上，很多人一般不会需要这么多虚拟控制台的，修改&#x2F;etc&#x2F;inittab ，注释掉那些你不需要的。<br><code>cp /etc/inittab /etc/inittabbak</code><br><code>vi /etc/inittab</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Run gettys in standard runlevels</span><br><span class="line">1:2345:respawn:/sbin/mingetty tty1</span><br><span class="line">#2:2345:respawn:/sbin/mingetty tty2</span><br><span class="line">#3:2345:respawn:/sbin/mingetty tty3</span><br><span class="line">#4:2345:respawn:/sbin/mingetty tty4</span><br><span class="line">#5:2345:respawn:/sbin/mingetty tty5</span><br><span class="line">#6:2345:respawn:/sbin/mingetty tty6</span><br></pre></td></tr></table></figure></div><h3 id="11-删除-MySQL-历史记录"><a href="#11-删除-MySQL-历史记录" class="headerlink" title="11.删除[MySQL]历史记录"></a>11.删除[MySQL]历史记录</h3><h5 id="用户登陆-数据库-后执行的SQL命令也会被MySQL记录在用户目录的-mysql-history文件里。如果数据库用户用SQL语句修改了数据库密码，也会因-mysql-history文件而泄漏。所以我们在shell登陆及备份的时候不要在-p后直接加密码，而是在提示后再输入数据库密码。另外这两个文件我们也应该不让它记录我们的操作，以防万一。"><a href="#用户登陆-数据库-后执行的SQL命令也会被MySQL记录在用户目录的-mysql-history文件里。如果数据库用户用SQL语句修改了数据库密码，也会因-mysql-history文件而泄漏。所以我们在shell登陆及备份的时候不要在-p后直接加密码，而是在提示后再输入数据库密码。另外这两个文件我们也应该不让它记录我们的操作，以防万一。" class="headerlink" title="用户登陆[数据库]后执行的SQL命令也会被MySQL记录在用户目录的.mysql_history文件里。如果数据库用户用SQL语句修改了数据库密码，也会因.mysql_history文件而泄漏。所以我们在shell登陆及备份的时候不要在-p后直接加密码，而是在提示后再输入数据库密码。另外这两个文件我们也应该不让它记录我们的操作，以防万一。"></a>用户登陆[数据库]后执行的SQL命令也会被MySQL记录在用户目录的.mysql_history文件里。如果数据库用户用SQL语句修改了数据库密码，也会因.mysql_history文件而泄漏。所以我们在shell登陆及备份的时候不要在-p后直接加密码，而是在提示后再输入数据库密码。另外这两个文件我们也应该不让它记录我们的操作，以防万一。</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">cp .bash_history .bash_historybak #备份</span><br><span class="line">cp .mysql_history .mysql_historybak</span><br><span class="line">rm .bash_history .mysql_history</span><br><span class="line">ln -s /dev/null .bash_history</span><br><span class="line">ln -s /dev/null .mysql_history</span><br></pre></td></tr></table></figure></div><h3 id="11-修改history命令记录"><a href="#11-修改history命令记录" class="headerlink" title="11. 修改history命令记录"></a>11. 修改history命令记录</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/profile /etc/profilebak</span><br><span class="line">vi /etc/profile</span><br><span class="line">#找到 HISTSIZE=1000 改为 HISTSIZE=50</span><br></pre></td></tr></table></figure></div><h3 id="12-隐藏服务器系统信息"><a href="#12-隐藏服务器系统信息" class="headerlink" title="12.隐藏服务器系统信息"></a>12.隐藏服务器系统信息</h3><h5 id="在缺省情况下，当你登陆到-Linux-系统，它会告诉你该linux发行版的名称、版本、内核版本、服务器的名称。为了不让这些默认的信息泄露出来，我们要进行下面的操作，让它只显示一个”login-”提示符。删除-etc-issue和-etc-issue-NET-这两个文件，或者把这2个文件改名，效果是一样的。"><a href="#在缺省情况下，当你登陆到-Linux-系统，它会告诉你该linux发行版的名称、版本、内核版本、服务器的名称。为了不让这些默认的信息泄露出来，我们要进行下面的操作，让它只显示一个”login-”提示符。删除-etc-issue和-etc-issue-NET-这两个文件，或者把这2个文件改名，效果是一样的。" class="headerlink" title="在缺省情况下，当你登陆到[Linux]系统，它会告诉你该linux发行版的名称、版本、内核版本、服务器的名称。为了不让这些默认的信息泄露出来，我们要进行下面的操作，让它只显示一个”login:”提示符。删除&#x2F;etc&#x2F;issue和&#x2F;etc&#x2F;issue[.NET]这两个文件，或者把这2个文件改名，效果是一样的。"></a>在缺省情况下，当你登陆到[Linux]系统，它会告诉你该linux发行版的名称、版本、内核版本、服务器的名称。为了不让这些默认的信息泄露出来，我们要进行下面的操作，让它只显示一个”login:”提示符。删除&#x2F;etc&#x2F;issue和&#x2F;etc&#x2F;issue[.NET]这两个文件，或者把这2个文件改名，效果是一样的。</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv /etc/issue /etc/issuebak</span><br><span class="line">mv /etc/issue.net /etc/issue.netbak</span><br></pre></td></tr></table></figure></div><h3 id="13-优化Linux内核参数"><a href="#13-优化Linux内核参数" class="headerlink" title="13.优化Linux内核参数"></a>13.优化Linux内核参数</h3><h5 id="然后编辑-etc-sysctl-conf"><a href="#然后编辑-etc-sysctl-conf" class="headerlink" title="然后编辑 &#x2F;etc&#x2F;sysctl.conf"></a>然后编辑 &#x2F;etc&#x2F;sysctl.conf</h5><p><code>vim /etc/sysctl.conf</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fs.file-max = 51200</span><br><span class="line">net.core.rmem_max = 67108864</span><br><span class="line">net.core.wmem_max = 67108864</span><br><span class="line">net.core.netdev_max_backlog = 250000</span><br><span class="line">net.core.somaxconn = 4096</span><br><span class="line">net.ipv4.tcp_syncookies = 1</span><br><span class="line">net.ipv4.tcp_tw_reuse = 1</span><br><span class="line">net.ipv4.tcp_tw_recycle = 0</span><br><span class="line">net.ipv4.tcp_fin_timeout = 30</span><br><span class="line">net.ipv4.tcp_keepalive_time = 1200</span><br><span class="line">net.ipv4.ip_local_port_range = 10000 65000</span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 8192</span><br><span class="line">net.ipv4.tcp_max_tw_buckets = 5000</span><br><span class="line">net.ipv4.tcp_fastopen = 3</span><br><span class="line">net.ipv4.tcp_rmem = 4096 87380 67108864</span><br><span class="line">net.ipv4.tcp_wmem = 4096 65536 67108864</span><br><span class="line">net.ipv4.tcp_mtu_probing = 1</span><br></pre></td></tr></table></figure></div><h3 id="14-CentOS-系统优化"><a href="#14-CentOS-系统优化" class="headerlink" title="14.CentOS 系统优化"></a>14.CentOS 系统优化</h3><p><code>cp /etc/profile /etc/profilebak2</code><br><code>vim /etc/profile #在文件末尾添加以下内容</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ulimit -c unlimited</span><br><span class="line">ulimit -s unlimited</span><br><span class="line">ulimit -SHn 65535</span><br><span class="line">source /etc/profile #使配置立即生效</span><br></pre></td></tr></table></figure></div><h5 id="ulimit-a-显示当前的各种用户进程限制"><a href="#ulimit-a-显示当前的各种用户进程限制" class="headerlink" title="ulimit -a #显示当前的各种用户进程限制"></a>ulimit -a #显示当前的各种用户进程限制</h5><h3 id="15-服务器禁止ping"><a href="#15-服务器禁止ping" class="headerlink" title="15.服务器禁止ping"></a>15.服务器禁止ping</h3><p><code>cp /etc/rc.d/rc.local /etc/rc.d/rc.localbak</code><br><code>vim /etc/rc.d/rc.local #在文件末尾增加下面这一行</code><br><code>echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all</code></p><h5 id="参数0表示允许-1表示禁止"><a href="#参数0表示允许-1表示禁止" class="headerlink" title="参数0表示允许 1表示禁止"></a>参数0表示允许 1表示禁止</h5><h3 id="16-防止IP欺骗"><a href="#16-防止IP欺骗" class="headerlink" title="16.防止IP欺骗"></a>16.防止IP欺骗</h3><h5 id="编辑host-conf文件并增加如下几行来防止IP欺骗攻击。"><a href="#编辑host-conf文件并增加如下几行来防止IP欺骗攻击。" class="headerlink" title="编辑host.conf文件并增加如下几行来防止IP欺骗攻击。"></a>编辑host.conf文件并增加如下几行来防止IP欺骗攻击。</h5><p><code>vim /etc/host.conf</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">order bind，hosts</span><br><span class="line">multi off</span><br><span class="line">nospoof on</span><br></pre></td></tr></table></figure></div><h3 id="16-防止DoS攻击"><a href="#16-防止DoS攻击" class="headerlink" title="16.防止DoS攻击"></a>16.防止DoS攻击</h3><h5 id="对系统所有的用户设置资源限制可以防止DoS类型攻击。如最大进程数和内存使用数量等。例如，可以在-etc-security-limits-conf中添加如下几行："><a href="#对系统所有的用户设置资源限制可以防止DoS类型攻击。如最大进程数和内存使用数量等。例如，可以在-etc-security-limits-conf中添加如下几行：" class="headerlink" title="对系统所有的用户设置资源限制可以防止DoS类型攻击。如最大进程数和内存使用数量等。例如，可以在&#x2F;etc&#x2F;security&#x2F;limits.conf中添加如下几行："></a>对系统所有的用户设置资源限制可以防止DoS类型攻击。如最大进程数和内存使用数量等。例如，可以在&#x2F;etc&#x2F;security&#x2F;limits.conf中添加如下几行：</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* hard core 0</span><br><span class="line">* hard rss 5000  #( 本行或许没用,man limits.conf 显示 maximum resident set size (KB) (Ignored in Linux 2.4.30 and higher)</span><br><span class="line">* hard nproc 50</span><br></pre></td></tr></table></figure></div><h5 id="然后必须编辑-etc-pam-d-login文件检查下面一行是否存在。"><a href="#然后必须编辑-etc-pam-d-login文件检查下面一行是否存在。" class="headerlink" title="然后必须编辑&#x2F;etc&#x2F;pam.d&#x2F;login文件检查下面一行是否存在。"></a>然后必须编辑&#x2F;etc&#x2F;pam.d&#x2F;login文件检查下面一行是否存在。</h5><p><code>session required /lib/security/pam_limits.so</code></p><h5 id="上面的命令禁止调试文件，限制进程数为50并且限制内存使用为5MB。"><a href="#上面的命令禁止调试文件，限制进程数为50并且限制内存使用为5MB。" class="headerlink" title="上面的命令禁止调试文件，限制进程数为50并且限制内存使用为5MB。"></a>上面的命令禁止调试文件，限制进程数为50并且限制内存使用为5MB。</h5><h3 id="17-自动注销帐号的登录"><a href="#17-自动注销帐号的登录" class="headerlink" title="17.自动注销帐号的登录"></a>17.自动注销帐号的登录</h3><p><code>vim /etc/profile</code></p><h5 id="修改”HISTSIZE-”"><a href="#修改”HISTSIZE-”" class="headerlink" title="修改”HISTSIZE&#x3D;”"></a>修改”HISTSIZE&#x3D;”</h5><h5 id="后面加入下面这行："><a href="#后面加入下面这行：" class="headerlink" title="后面加入下面这行："></a>后面加入下面这行：</h5><p><code>TMOUT = 300</code></p><h5 id="300，表示5分。这样，如果系统中登陆的用户在5分钟内都没有动作，那么系统会自动注销这个账户。"><a href="#300，表示5分。这样，如果系统中登陆的用户在5分钟内都没有动作，那么系统会自动注销这个账户。" class="headerlink" title="300，表示5分。这样，如果系统中登陆的用户在5分钟内都没有动作，那么系统会自动注销这个账户。"></a>300，表示5分。这样，如果系统中登陆的用户在5分钟内都没有动作，那么系统会自动注销这个账户。</h5><h3 id="18-限制su切换"><a href="#18-限制su切换" class="headerlink" title="18.限制su切换"></a>18.限制su切换</h3><p><code>vim /etc/pam.d/su</code></p><h5 id="文件中找到-auth-required-pam-wheel-so-use-uid，去掉前面的注释-。"><a href="#文件中找到-auth-required-pam-wheel-so-use-uid，去掉前面的注释-。" class="headerlink" title="文件中找到#auth required pam_wheel.so use_uid，去掉前面的注释#。"></a>文件中找到#auth required pam_wheel.so use_uid，去掉前面的注释#。</h5><h3 id="19-修改sshd"><a href="#19-修改sshd" class="headerlink" title="19.修改sshd"></a>19.修改sshd</h3><h1 id="更新中"><a href="#更新中" class="headerlink" title="更新中"></a>更新中</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;1-建立其他用户&quot;&gt;&lt;a href=&quot;#1-建立其他用户&quot; class=&quot;headerlink&quot; title=&quot;1.建立其他用户&quot;&gt;&lt;/a&gt;1.建立其他用户&lt;/h3&gt;&lt;p&gt;&lt;code&gt;useradd userid&lt;/code&gt;&lt;br&gt;&lt;code&gt;passwd us</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7.6 源码编译安装 Nginx 1.19.10</title>
    <link href="https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-nginx-1-19-10/"/>
    <id>https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-nginx-1-19-10/</id>
    <published>2025-07-18T06:16:31.889Z</published>
    <updated>2025-06-01T10:55:22.345Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 本文主要记录如何在 <code>CentOS 7.6</code> 中编译安装 <code>Nginx</code> 官方最新的 <code>1.19.10</code> 版本。由于像 <code>Nginx</code> 、 <code>Mysql</code> 和 <code>PHP</code> 的的源码都是用 <code>C/C++</code> 写的，所以自己的 <code>CentOS 7.6</code> 服务器上必须要安装 <code>gcc</code> 和 <code>g++</code> 软件。</p><p> 搭建 <code>LNMP</code> 环境一般是先安装 <code>Mysql</code>&#x2F;<code>MariaDB</code> ，再安装 <code>Nginx</code> ，其次是安装 <code>PHP</code></p></blockquote><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="创建用户和组"><a href="#创建用户和组" class="headerlink" title="创建用户和组"></a>创建用户和组</h2><blockquote><p>先创建一个名为 <code>nginx</code> 且没有登录权限的系统用户和一个名为 <code>nginx</code> 的系统用户组，然后安装 <code>nginx</code> 所需的依赖库和依赖包，最后通过 <code>.configure</code> 进行安装的详细配置。</p></blockquote><ul><li>创建 <code>nginx</code> 系统用户和系统用户组</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -r nginx &amp;&amp; useradd -c &quot;Nginx Server&quot; -r -g nginx -s /sbin/nologin -d /usr/local/nginx nginx -M</span><br></pre></td></tr></table></figure></div><h2 id="创建相关目录"><a href="#创建相关目录" class="headerlink" title="创建相关目录"></a>创建相关目录</h2><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建缓存目录和日志目录</span></span><br><span class="line">mkdir -pv /var/cache/nginx/&#123;client_temp,proxy_temp,fastcgi_temp,uwsgi_temp,scgi_temp&#125; /var/log/nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">赋予nginx用户权限</span></span><br><span class="line">chown -R nginx:nginx /var/cache/nginx /var/log/nginx</span><br></pre></td></tr></table></figure></div><h1 id="安装相关包"><a href="#安装相关包" class="headerlink" title="安装相关包"></a>安装相关包</h1><h2 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h2><ul><li><code>Yum</code> 安装 <code>GCC</code> 、 <code>GCC-C++</code> 、 <code>C/C++</code> 语言编译环境</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ make autoconf automake</span><br></pre></td></tr></table></figure></div><ul><li><code>Yum</code> 安装 <code>Nginx</code> 必须的依赖库</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install zlib zlib-devel openssl openssl-devel pcre-devel libxslt-devel libxml2 libxml2-devel gd-devel geoip-devel perl-devel perl-ExtUtils-Embed libuuid-devel</span><br></pre></td></tr></table></figure></div><h1 id="编译安装-Nginx"><a href="#编译安装-Nginx" class="headerlink" title="编译安装 Nginx"></a>编译安装 <code>Nginx</code></h1><ul><li>下载并解压文件</li></ul><p>（备用：<code>https://blog.xiaoqy.com/pub/packages/nginx/nginx-1.19.10.tar.gz</code>）</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -P &#x27;/usr/local/src&#x27; http://nginx.org/download/nginx-1.19.10.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf nginx-1.19.10.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd nginx-1.19.10</span><br></pre></td></tr></table></figure></div><ul><li>预编译</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/nginx \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--sbin-path=/usr/sbin/nginx \</span><br><span class="line">--conf-path=/etc/nginx/nginx.conf \</span><br><span class="line">--error-log-path=/var/log/nginx/error.log \</span><br><span class="line">--http-log-path=/var/log/nginx/access.log \</span><br><span class="line">--pid-path=/var/run/nginx.pid  \</span><br><span class="line">--lock-path=/var/run/nginx.lock \</span><br><span class="line">--http-client-body-temp-path=/var/cache/nginx/client_temp \</span><br><span class="line">--http-proxy-temp-path=/var/cache/nginx/proxy_temp \</span><br><span class="line">--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp \</span><br><span class="line">--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp \</span><br><span class="line">--http-scgi-temp-path=/var/cache/nginx/scgi_temp \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--with-http_v2_module \</span><br><span class="line">--with-http_realip_module \</span><br><span class="line">--with-http_addition_module \</span><br><span class="line">--with-http_sub_module \</span><br><span class="line">--with-http_dav_module \</span><br><span class="line">--with-http_flv_module \</span><br><span class="line">--with-http_mp4_module \</span><br><span class="line">--with-http_gunzip_module \</span><br><span class="line">--with-http_gzip_static_module \</span><br><span class="line">--with-http_perl_module \</span><br><span class="line">--with-http_random_index_module \</span><br><span class="line">--with-http_secure_link_module \</span><br><span class="line">--with-http_stub_status_module \</span><br><span class="line">--with-http_auth_request_module \</span><br><span class="line">--with-http_image_filter_module \</span><br><span class="line">--with-http_slice_module \</span><br><span class="line">--with-pcre \</span><br><span class="line">--with-pcre-jit \</span><br><span class="line">--with-debug \</span><br><span class="line">--with-mail \</span><br><span class="line">--with-mail_ssl_module \</span><br><span class="line">--with-stream \</span><br><span class="line">--with-stream_ssl_module \</span><br><span class="line">--with-threads \</span><br><span class="line">--with-file-aio</span><br></pre></td></tr></table></figure></div><ul><li>编译并安装</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><h1 id="配置-Nginx"><a href="#配置-Nginx" class="headerlink" title="配置 Nginx"></a>配置 <code>Nginx</code></h1><ul><li>备份 <code>nginx.conf</code> 配置源文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.old</span><br></pre></td></tr></table></figure></div><ul><li>修改文件 <code>nginx.conf</code> ，设置 <code>user</code> 参数如下： <code>user nginx;</code></li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/^#user\s\+nobody;$/user\ nginx;/g&#x27; /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure></div><ul><li>设置 <code>Nginx</code> 为系统服务</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/lib/systemd/system/nginx.service</span><br></pre></td></tr></table></figure></div><p>添加以下内容：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Nginx Web Server</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf</span><br><span class="line">ExecReload=/usr/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/sbin/nginx -s quit</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></div><ul><li>设置 <code>Nginx</code> 为自启动并启动服务</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx.service &amp;&amp; systemctl start nginx.service</span><br></pre></td></tr></table></figure></div><ul><li>查询 <code>Nginx</code> 状态</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl status nginx.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者</span></span><br><span class="line">ps -ef | grep nginx</span><br><span class="line">netstat -anp | grep nginx</span><br></pre></td></tr></table></figure></div><ul><li>修改 <code>nginx</code> 配置文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure></div><p>修改内容如下：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行用户</span></span><br><span class="line">user  nginx;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动进程, 通常设置成和cpu的数据相等</span></span><br><span class="line">worker_processes  1;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">全局错误日志及PID文件</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_log  logs/error.log;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_log  logs/error.log  info;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">pid        logs/nginx.pid;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">工作模式及连接数上限</span></span><br><span class="line">events &#123;</span><br><span class="line"></span><br><span class="line">    use epoll;</span><br><span class="line"></span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    tcp_nodelay     on;</span><br><span class="line"></span><br><span class="line">    gzip  on;</span><br><span class="line">    gzip_disable &quot;MSIE [1-6]&quot;;</span><br><span class="line"></span><br><span class="line">    client_header_buffer_size   128k;</span><br><span class="line">    large_client_header_buffers  4 128k;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  www.xiaoqy.com;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        access_log  logs/nginx.dev.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /data/www/html;</span><br><span class="line">            index  index.php index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   /data/www/html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    location ~ ^/(images|javascript|js|css|flash|media|static)/ &#123;</span><br><span class="line"></span><br><span class="line">        expires 30d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">            fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">            fastcgi_index  index.php;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">            include        fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        location ~ /\.ht &#123;</span><br><span class="line">            deny  all;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li><code>CentOS</code> 添加开放端口</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">加入开放端口到配置文件</span></span><br><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line"></span><br><span class="line">    # 添加时区</span><br><span class="line">    --zone=public </span><br><span class="line"></span><br><span class="line">    # 添加端口</span><br><span class="line">    --add-port=80/tcp</span><br><span class="line"></span><br><span class="line">    # 永久生效</span><br><span class="line">    --permanent </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">加载防火墙新配置文件( 以root身份输入以下命令，重新加载防火墙，并不中断用户连接，即不丢失状态信息. )</span></span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt; 本文主要记录如何在 &lt;code&gt;CentOS 7.6&lt;/code&gt; 中编译安装 &lt;code&gt;Nginx&lt;/code&gt; 官方最新的 &lt;code&gt;1.19.10&lt;/code&gt; 版本。由于像 &lt;code&gt;Nginx&lt;/code&gt; 、 &lt;code&gt;Mys</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
    <category term="Nginx" scheme="https://mirror.geek.xiaoww.com/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7.6 源码编译安装 MariaDB 10.5.9</title>
    <link href="https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-mariadb-10-5-9/"/>
    <id>https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-mariadb-10-5-9/</id>
    <published>2025-07-18T06:16:31.859Z</published>
    <updated>2025-06-01T10:55:46.979Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 本文主要记录如何在 <code>CentOS 7.6</code> 中编译安装 <code>MariaDB</code> 官方最新的 <code>10.5.9</code> 版本。由于像 <code>Nginx</code> 、 <code>Mysql</code> 和 <code>PHP</code> 的的源码都是用 <code>C/C++</code> 写的，所以自己的 <code>CentOS 7.6</code> 服务器上必须要安装 <code>gcc</code> 和 <code>g++</code> 软件。</p><p> 搭建 <code>LNMP</code> 环境一般是先安装 <code>Mysql</code>&#x2F;<code>MariaDB</code> ，再安装 <code>Nginx</code> ，其次是安装 <code>PHP</code></p></blockquote><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="创建用户和组"><a href="#创建用户和组" class="headerlink" title="创建用户和组"></a>创建用户和组</h2><blockquote><p>先创建一个名为 <code>mysql</code> 且没有登录权限的系统用户和一个名为 <code>mysql</code> 的系统用户组，然后安装 <code>MariaDB</code> 所需的依赖库和依赖包，最后通过 <code>cmake</code> 进行安装的详细配置。</p></blockquote><ul><li>创建 <code>mysql</code> 系统用户和系统用户组</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -r mysql &amp;&amp; useradd -c &quot;MariaDB Server&quot; -r -g mysql -s /sbin/nologin -d /usr/local/mariadb mysql -M</span><br></pre></td></tr></table></figure></div><h2 id="创建数据库相关目录"><a href="#创建数据库相关目录" class="headerlink" title="创建数据库相关目录"></a>创建数据库相关目录</h2><blockquote><p>提前预定 <code>MariaDB</code> 的安装目录为 <code>/usr/local/mariadb</code> 并且数据目录为 <code>/data/mariadb</code> ，赋予 <code>mysql </code> 用户权限。</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -pv /data/mariadb &amp;&amp; chown -R mysql:mysql /data/mariadb</span><br></pre></td></tr></table></figure></div><h2 id="删除数据库相关文件"><a href="#删除数据库相关文件" class="headerlink" title="删除数据库相关文件"></a>删除数据库相关文件</h2><ul><li>删除 <code>CentOS</code> 默认数据库配置文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">find -H /etc/ | grep my.c</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/etc/my.cnf.d</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/etc/my.cnf.d/mysql-clients.cnf</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/etc/pki/tls/certs/make-dummy-cert</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/etc/pki/tls/certs/renew-dummy-cert</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/etc/my.cnf</span></span><br><span class="line"></span><br><span class="line">rm -rf /etc/my.cnf /etc/my.cnf.d/</span><br></pre></td></tr></table></figure></div><ul><li>卸载系统自带 <code>mariadb-libs</code></li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa|grep mariadb*</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">mariadb-libs-5.5.60-1.el7_5.x86_64</span></span><br><span class="line"></span><br><span class="line">rpm -e mariadb-libs-5.5.60-1.el7_5.x86_64 --nodeps</span><br></pre></td></tr></table></figure></div><h1 id="安装相关包"><a href="#安装相关包" class="headerlink" title="安装相关包"></a>安装相关包</h1><h2 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h2><ul><li><code>Yum</code> 安装 <code>GCC</code> 、 <code>GCC-C++</code> 的 <code>C/C++</code> 语言编译环境</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ make autoconf automake libtool</span><br></pre></td></tr></table></figure></div><ul><li><code>Yum</code> 安装 <code>MariaDB</code> 必须的依赖库</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install openssl openssl-devel ncurses ncurses-devel bison bison-devel boost boost-devel jemalloc jemalloc-devel bzip2 bzip2-devel libxml2 libxml2-devel perl perl-devel lsof libaio-devel libcurl-devel libarchive-devel libevent-devel pcre-devel pcre2-devel zlib-devel kernel-headers kernel-devel zip tar m4 git gnutls-devel</span><br></pre></td></tr></table></figure></div><h2 id="安装编译包"><a href="#安装编译包" class="headerlink" title="安装编译包"></a>安装编译包</h2><ul><li><code>CMake</code> ：编译工具</li></ul><p>(备用：<code>https://blog.xiaoqy.com/pub/packages/cmake/cmake-3.19.5.tar.gz</code>)</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget -P &#x27;/usr/local/src&#x27; https://cmake.org/files/v3.19/cmake-3.19.5.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf cmake-3.19.5.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd cmake-3.19.5</span><br><span class="line"></span><br><span class="line">./bootstrap</span><br><span class="line">gmake &amp;&amp; gmake install# 或者 make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">cmake --version</span><br></pre></td></tr></table></figure></div><h1 id="编译安装-MariaDB"><a href="#编译安装-MariaDB" class="headerlink" title="编译安装 MariaDB"></a>编译安装 <code>MariaDB</code></h1><ul><li>下载并解压文件</li></ul><p>（备用：<code>https://blog.xiaoqy.com/pub/packages/mariadb/mariadb-10.5.9.tar.gz</code>）</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -P &#x27;/usr/local/src&#x27; https://mirrors.tuna.tsinghua.edu.cn/mariadb/mariadb-10.5.9/source/mariadb-10.5.9.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf mariadb-10.5.9.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd mariadb-10.5.9</span><br></pre></td></tr></table></figure></div><ul><li>预编译</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">cmake . \</span><br><span class="line">-DCMAKE_INSTALL_PREFIX=/usr/local/mariadb \</span><br><span class="line">-DMYSQL_UNIX_ADDR=/data/mariadb/mysql.sock \</span><br><span class="line">-DSYSCONFDIR=/etc \</span><br><span class="line">-DMYSQL_DATADIR=/data/mariadb \</span><br><span class="line">-DMYSQL_USER=mysql \</span><br><span class="line">-DMYSQL_TCP_PORT=3306 \</span><br><span class="line">-DWITHOUT_TOKUDB=1 \</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_ARCHIVE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_PARTITION_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_DEBUG=0 \</span><br><span class="line">-DWITH_READLINE=1 \</span><br><span class="line">-DWITH_BOOST=system \</span><br><span class="line">-DWITH_SSL=system \</span><br><span class="line">-DWITH_ZLIB=system \</span><br><span class="line">-DWITH_LIBWRAP=1 \</span><br><span class="line">-DDEFAULT_CHARSET=utf8 \</span><br><span class="line">-DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line">-DENABLED_LOCAL_INFILE=1</span><br></pre></td></tr></table></figure></div><p>[collapse title&#x3D;”CMake 编译报错？” color&#x3D;”red”]</p><blockquote><p><code>CMake</code> 错误请删除 <code>CMakeCache.txt</code> 并重新执行。否则每次读取这个文件，命令修改正确也是报错</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -f CMakeCache.txt</span><br></pre></td></tr></table></figure></div><p>[&#x2F;collapse]</p><ul><li>编译并安装</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install &amp;&amp; cd</span><br></pre></td></tr></table></figure></div><p>[collapse title&#x3D;”编译报错？” color&#x3D;”red”]</p><blockquote><p>报错：<code>GCC 5.3 or newer is required (-dumpversion says 4.8.5)</code><br>原因：<code>GCC</code> 版本低于安装软件要求的版本</p></blockquote><blockquote><p><code>MariaDB</code> 编译 <code>TokuDB</code> 引擎时会用到 <code>C++11</code> 标准，系统里 <code>GCC</code> 最高版本 <code>4.8.5</code> 是支持 <code>C++11</code> 标准的，可就算指定了 <code>-DCMAKE_CXX_FLAGS=-std=c++11</code> 也不行。手动编译更高版本的 <code>GCC</code> 又太麻烦，这里直接安装了 <code>devtoolset-9</code> ，当然你禁用 <code>TokuDB</code> 引擎也无可厚非。</p></blockquote><ul><li><code>Devtoolset-toolchain</code> ：<code>GCC</code> 工具链</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gcc --version# 查询 GCC 版本</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-36)</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">Copyright (C) 2015 Free Software Foundation, Inc.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装 SCL 源</span></span><br><span class="line">yum install -y centos-release-scl scl-utils-build</span><br><span class="line">yum install -y devtoolset-9</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到 Devtoolset-9</span></span><br><span class="line">scl enable devtoolset-9 bash</span><br><span class="line"></span><br><span class="line">gcc --version# 版本达到 9 系列</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">gcc (GCC) 9.3.1 20200408 (Red Hat 9.3.1-2)</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">Copyright (C) 2019 Free Software Foundation, Inc.</span></span><br></pre></td></tr></table></figure></div><blockquote><p>报错：<code>c++: fatal error: Killed signal terminated program cc1plus</code><br>原因：内存不足所致，可通过设置 <code>2G</code> 交换分区来解决该问题</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo dd if=/dev/zero of=/swapfile bs=64M count=32# 设置交换分区的大小</span><br><span class="line">sudo mkswap /swapfile# 创建交换分区文件</span><br><span class="line">sudo swapon /swapfile# 开启交换分区</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编译完成后，回收这部分临时的交换空间</span></span><br><span class="line">sudo swapoff /swapfile# 先关闭交换空间</span><br><span class="line">sudo rm /swapfile# 删除交换空间</span><br></pre></td></tr></table></figure></div><p>[&#x2F;collapse]</p><h1 id="配置-MariaDB"><a href="#配置-MariaDB" class="headerlink" title="配置 MariaDB"></a>配置 <code>MariaDB</code></h1><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用 mysql 用户执行脚本, 安装数据库到数据库存放目录</span></span><br><span class="line">/usr/local/mariadb/scripts/mysql_install_db --user=mysql --datadir=/data/mariadb</span><br></pre></td></tr></table></figure></div><ul><li>复制 <code>MariaDB</code> 配置文件到 <code>/etc</code> 目录</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拷贝 maria 安装目录下 support-files 目录下的文件 wsrep.cnf 到 /etc 目录并重命名为 my.cnf</span></span><br><span class="line">cp /usr/local/mariadb/support-files/wsrep.cnf /etc/my.cnf</span><br></pre></td></tr></table></figure></div><ul><li>创建启动脚本</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/mariadb/support-files/mysql.server /etc/rc.d/init.d/mysqld</span><br></pre></td></tr></table></figure></div><ul><li>启动 <code>mysqld</code> 服务</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.d/init.d/mysqld start</span><br></pre></td></tr></table></figure></div><ul><li>配置环境变量</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">　写入环境变量到 mysql.sh</span></span><br><span class="line">echo -e &quot;export PATH=\$PATH:/usr/local/mariadb/bin/&quot; &gt; /etc/profile.d/mysql.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">为脚本赋于可执行权限</span></span><br><span class="line">chmod 0777 /etc/profile.d/mysql.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">读取并执行 mysql.sh 脚本, 并执行脚本, 以立即生效环境变量</span></span><br><span class="line">source /etc/profile.d/mysql.sh</span><br></pre></td></tr></table></figure></div><ul><li>初始化 <code>MariaDB</code></li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行 MariaDB 初始化脚本</span></span><br><span class="line">mysql_secure_installation</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">以下提示：</span></span><br><span class="line">    NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class="line">          SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class="line"></span><br><span class="line">    In order to log into MariaDB to secure it, we&#x27;ll need the current</span><br><span class="line">    password for the root user. If you&#x27;ve just installed MariaDB, and</span><br><span class="line">    haven&#x27;t set the root password yet, you should just press enter here.</span><br><span class="line"></span><br><span class="line">    Enter current password for root (enter for none):# 直接Enter，预设MariaDB没有密码</span><br><span class="line">    OK, successfully used password, moving on...</span><br><span class="line"></span><br><span class="line">    Setting the root password or using the unix_socket ensures that nobody</span><br><span class="line">    can log into the MariaDB root user without the proper authorisation.</span><br><span class="line"></span><br><span class="line">    You already have your root account protected, so you can safely answer &#x27;n&#x27;.</span><br><span class="line"></span><br><span class="line">    Switch to unix_socket authentication [Y/n] y# y，切换到unix_socket身份验证</span><br><span class="line">    Enabled successfully!</span><br><span class="line">    Reloading privilege tables..</span><br><span class="line">     ... Success!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    You already have your root account protected, so you can safely answer &#x27;n&#x27;.</span><br><span class="line"></span><br><span class="line">    Change the root password? [Y/n] y# y，设定root密码</span><br><span class="line">    New password: </span><br><span class="line">    Re-enter new password:</span><br><span class="line">    Password updated successfully!</span><br><span class="line">    Reloading privilege tables..</span><br><span class="line">     ... Success!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    By default, a MariaDB installation has an anonymous user, allowing anyone</span><br><span class="line">    to log into MariaDB without having to have a user account created for</span><br><span class="line">    them.  This is intended only for testing, and to make the installation</span><br><span class="line">    go a bit smoother.  You should remove them before moving into a</span><br><span class="line">    production environment.</span><br><span class="line"></span><br><span class="line">    Remove anonymous users? [Y/n] y# y，移除匿名登入</span><br><span class="line">     ... Success!</span><br><span class="line"></span><br><span class="line">    Normally, root should only be allowed to connect from &#x27;localhost&#x27;.  This</span><br><span class="line">    ensures that someone cannot guess at the root password from the network.</span><br><span class="line"></span><br><span class="line">    Disallow root login remotely? [Y/n] y# y，移除远端登入权限</span><br><span class="line">     ... Success!</span><br><span class="line"></span><br><span class="line">    By default, MariaDB comes with a database named &#x27;test&#x27; that anyone can</span><br><span class="line">    access.  This is also intended only for testing, and should be removed</span><br><span class="line">    before moving into a production environment.</span><br><span class="line"></span><br><span class="line">    Remove test database and access to it? [Y/n] y# y，移除测试资料库和账号</span><br><span class="line">     - Dropping test database...</span><br><span class="line">     ... Success!</span><br><span class="line">     - Removing privileges on test database...</span><br><span class="line">     ... Success!</span><br><span class="line"></span><br><span class="line">    Reloading the privilege tables will ensure that all changes made so far</span><br><span class="line">    will take effect immediately.</span><br><span class="line"></span><br><span class="line">    Reload privilege tables now? [Y/n] y# y，重新载入权限表</span><br><span class="line">     ... Success!</span><br><span class="line"></span><br><span class="line">    Cleaning up...</span><br><span class="line"></span><br><span class="line">    All done!  If you&#x27;ve completed all of the above steps, your MariaDB</span><br><span class="line">    installation should now be secure.</span><br><span class="line"></span><br><span class="line">    Thanks for using MariaDB!</span><br></pre></td></tr></table></figure></div><ul><li>设置 <code>MariaDB</code> 为自启动并启动服务</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable mysqld.service &amp;&amp; systemctl start mysqld.service</span><br></pre></td></tr></table></figure></div><ul><li>查询 <code>MariaDB</code> 状态</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl status mysqld.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者</span></span><br><span class="line">ps -ef | grep mysqld</span><br><span class="line">netstat -anp | grep mysqld</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt; 本文主要记录如何在 &lt;code&gt;CentOS 7.6&lt;/code&gt; 中编译安装 &lt;code&gt;MariaDB&lt;/code&gt; 官方最新的 &lt;code&gt;10.5.9&lt;/code&gt; 版本。由于像 &lt;code&gt;Nginx&lt;/code&gt; 、 &lt;code&gt;My</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
    <category term="MariaDB" scheme="https://mirror.geek.xiaoww.com/tags/MariaDB/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7.6 源码编译安装 GCC 10.3.0</title>
    <link href="https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-gcc-10-3-0/"/>
    <id>https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-gcc-10-3-0/</id>
    <published>2025-07-18T06:16:31.847Z</published>
    <updated>2025-06-01T10:55:05.986Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><code>Centos7.6</code> <code>Yum</code> 安装的默认 <code>GCC</code> 版本为 <code>4.8.5</code> ，如果需要使用 <code>GCC</code> 的最新特性，则需要源码安装 <code>GCC</code> 最新版。编译过程中解决不少报错，最终有了本文的实测成功记录。</p></blockquote><h1 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h1><ul><li>系统：<code>CentOS 7.6.1810</code></li><li>软件：<code>GCC 10.3.0</code></li><li>依赖软件：<code>gmp</code> 、 <code>mpfr</code> 、 <code>libmpc</code></li></ul><h1 id="安装说明"><a href="#安装说明" class="headerlink" title="安装说明"></a>安装说明</h1><blockquote><p><code>C++17</code> ：<br><code>GCC7</code>完全支持， <code>GCC6</code> 和 <code>GCC5</code> 部分支持， <code>GCC6</code> 支持度当然比 <code>GCC5</code> 高， <code>GCC4</code> 及以下版本不支持。<br><code>C++14</code> ：<br><code>GCC5</code> 就可以完全支持， <code>GCC4</code> 部分支持， <code>GCC3</code> 及以下版本不支持。<br><code>C++11</code> ：<br><code>GCC4.8.1</code> 及以上可以完全支持。 <code>GCC4.3</code> 部分支持， <code>GCC4.3</code> 以下版本不支持。<br>高版本的 <code>GCC</code> 向下兼容，支持低版本的 <code>C++</code> 标准。现在很多服务器 <code>Yum</code> 里的 <code>GCC</code> 版本是 <code>4.8.5</code> ，也就是可以完全支持 <code>C++11</code> 了，部分支持 <code>C++14</code> ，不支持 <code>C++17</code> 。</p></blockquote><h1 id="安装相关包"><a href="#安装相关包" class="headerlink" title="安装相关包"></a>安装相关包</h1><h2 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h2><ul><li><code>Yum</code> 安装 <code>GCC</code> 、 <code>GCC-C++</code> 的 <code>C/C++</code> 语言编译环境以及所需的依赖库</li></ul><blockquote><p>预先安装旧版 <code>GCC</code> 以及编译时所需的依赖库，最后工作在进行卸载</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装EPEL源</span></span><br><span class="line">yum install -y epel-release</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装工具</span></span><br><span class="line">yum install -y vim wget gcc gcc-c++ make autoconf automake zip bzip2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装基础编译软件</span></span><br><span class="line">yum install -y gcc-gnat libgcc libgcc.i686 glibc-devel bison flex m4 texinfo build-essential</span><br></pre></td></tr></table></figure></div><h1 id="准备相关-GCC"><a href="#准备相关-GCC" class="headerlink" title="准备相关 GCC"></a>准备相关 <code>GCC</code></h1><blockquote><p>编译过程是非常耗时的（本机耗时 6 小时完成编译），因此如果读者选用此方式安装 <code>GCC</code> ，则在执行 <code>make</code> 命令时一定要安排合适的时间。</p></blockquote><h2 id="下载并解压"><a href="#下载并解压" class="headerlink" title="下载并解压"></a>下载并解压</h2><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -P &#x27;/usr/local/src&#x27; https://ftp.gnu.org/gnu/gcc/gcc-10.3.0/gcc-10.3.0.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf gcc-10.3.0.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd gcc-10.3.0</span><br></pre></td></tr></table></figure></div><h2 id="加入依赖库环境变量"><a href="#加入依赖库环境变量" class="headerlink" title="加入依赖库环境变量"></a>加入依赖库环境变量</h2><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib:/usr/lib64:/usr/local/lib:/usr/local/lib64&#x27; &gt;&gt; /etc/profile</span><br></pre></td></tr></table></figure></div><ul><li>使环境变量立即生效</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></div><h2 id="添加动态链接库"><a href="#添加动态链接库" class="headerlink" title="添加动态链接库"></a>添加动态链接库</h2><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ld.so.conf</span><br></pre></td></tr></table></figure></div><p>添加以下内容</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">include ld.so.conf.d/*.conf</span><br><span class="line">/usr/lib</span><br><span class="line">/usr/lib64</span><br><span class="line">/usr/local/lib</span><br><span class="line">/usr/local/lib64</span><br></pre></td></tr></table></figure></div><p>重新搜索当前系统上所有库文件搜索路径下的库文件，并生成缓存</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldconfig -v</span><br></pre></td></tr></table></figure></div><h2 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h2><ul><li>检查和下载 <code>GCC</code> 依赖环境</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载安装 GCC 所需要的依赖包（如 gmp、mpfr、mpc 等）</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">一定观察此命令的执行结果，保证其确实是将 gmp、mpfr、mpc 等依赖包成功下载下来。</span></span><br><span class="line">./contrib/download_prerequisites</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">gmp-6.1.0.tar.bz2: OK</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">mpfr-3.1.4.tar.bz2: OK</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">mpc-1.0.3.tar.gz: OK</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">isl-0.18.tar.bz2: OK</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">All prerequisites downloaded successfully.</span></span><br></pre></td></tr></table></figure></div><p>[collapse title&#x3D;”下载失败？” color&#x3D;”red”]</p><blockquote><p><code>GCC</code> 依赖环境通过脚本无法下载或者下载慢，则可以使用国内GNU镜像站进行下载。</p></blockquote><ul><li>手动下载 <code>GCC</code> 依赖包（方法1）</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/src/gcc-10.3.0</span><br><span class="line"></span><br><span class="line">wget -P &#x27;/usr/local/src/gcc-10.3.0&#x27; https://gcc.gnu.org/pub/gcc/infrastructure/gmp-6.1.0.tar.bz2 \</span><br><span class="line">&amp;&amp; wget -P &#x27;/usr/local/src/gcc-10.3.0&#x27; https://gcc.gnu.org/pub/gcc/infrastructure/mpfr-3.1.4.tar.bz2 \</span><br><span class="line">&amp;&amp; wget -P &#x27;/usr/local/src/gcc-10.3.0&#x27; https://gcc.gnu.org/pub/gcc/infrastructure/mpc-1.0.3.tar.gz \</span><br><span class="line">&amp;&amp; wget -P &#x27;/usr/local/src/gcc-10.3.0&#x27; https://gcc.gnu.org/pub/gcc/infrastructure/isl-0.18.tar.bz2</span><br><span class="line"></span><br><span class="line">tar -jxvf gmp-6.1.0.tar.bz2 -C &#x27;/usr/local/src/gcc-10.3.0&#x27; \</span><br><span class="line">&amp;&amp; tar -jxvf mpfr-3.1.4.tar.bz2 -C &#x27;/usr/local/src/gcc-10.3.0&#x27; \</span><br><span class="line">&amp;&amp; tar -zxvf mpc-1.0.3.tar.gz -C &#x27;/usr/local/src/gcc-10.3.0&#x27; \</span><br><span class="line">&amp;&amp; tar -jxvf isl-0.18.tar.bz2 -C &#x27;/usr/local/src/gcc-10.3.0&#x27;</span><br></pre></td></tr></table></figure></div><ul><li><em><code>Yum</code>安装  <code>GCC</code> 依赖库（方法2）</em></li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gmp gmp-devel mpfr mpfr-devel libmpc libmpc-devel</span><br></pre></td></tr></table></figure></div><p>[&#x2F;collapse]</p><ul><li>编译安装依赖包（可忽略）</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/src/gcc-10.3.0/gmp-6.1.0</span><br><span class="line">./configure --prefix=/usr/local/gmp-6.1.0</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">cd /usr/local/src/gcc-10.3.0/mpfr-3.1.4</span><br><span class="line">./configure --prefix=/usr/local/mpfr-3.1.4 --with-gmp=/usr/local/gmp-6.1.0</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">cd /usr/local/src/gcc-10.3.0/mpc-1.0.3</span><br><span class="line">./configure --prefix=/usr/local/mpc-1.0.3 --with-gmp=/usr/local/gmp-6.1.0 --with-mpfr=/usr/local/mpfr-3.1.4</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">cd /usr/local/src/gcc-10.3.0/isl-0.18</span><br><span class="line">./configure --prefix=/usr/local/isl-0.18  --with-gmp=/usr/local/gmp-6.1.0</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><h1 id="编译安装-GCC"><a href="#编译安装-GCC" class="headerlink" title="编译安装 GCC"></a>编译安装 <code>GCC</code></h1><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/src/gcc-10.3.0 \</span><br><span class="line">&amp;&amp; mkdir build &amp;&amp; cd build \</span><br><span class="line">&amp;&amp; ../configure --enable-threads=posix --enable--long-long --enable-languages=c,c++ --disable-checking --disable-multilib</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果GCC依赖包已经进行了上一步编译操作，则执行以下命令:</span></span><br><span class="line">../configure --prefix=/usr/local/gcc-10.3.0 --with-gmp=/usr/local/gmp-6.1.0 --with-mpfr=/usr/local/mpfr-3.1.4 --with-mpc=/usr/local/mpc-1.0.3 --with-isl=/usr/local/isl-0.18 --enable-threads=posix --enable--long-long --enable-languages=c,c++ --disable-checking --disable-multilib</span><br><span class="line"></span><br><span class="line">--enable-threads=posix使c++异常能处理多线程代码</span><br><span class="line">--enable--long-long设定gcc数据类型大小</span><br><span class="line">–-enable-languages表示你要让你的gcc支持那些语言</span><br><span class="line">–-disable-checking生成的编译器在编译过程中不做额外检查，也可以使用 *–enable-checking=xxx*来增加一些检查</span><br><span class="line">–-disable-multilib不生成编译为其他平台可执行代码的交叉编译器。</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">整个编译过程，根据你的机器配置，可能要等十几分钟到一个小时不等；</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4为当前服务器每颗物理CPU中的核心数，以实际为准。</span></span><br><span class="line">make -j 4</span><br><span class="line">yum -y remove gcc gcc-c++# 安装前卸载原来的GCC</span><br><span class="line">make install</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">由此就成功安装了 10.3.0 版本的 GCC 编译器。需要注意的是，如果此时读者直接执行 gcc --version，则 GCC 版本仍会显示之前安装的版本。操作系统重启之后，GCC 版本就会自行更正过来。</span></span><br></pre></td></tr></table></figure></div><p>[collapse title&#x3D;”编译报错？” color&#x3D;”red”]</p><blockquote><p>报错： <code>configure: error: I suspect your system does not have 32-bit development libraries (libc and headers). If you have them, rerun configure with --enable-multilib. If you do not have them, and want to build a 64-bit-only compiler, rerun configure with --disable-multilib.</code></p><p>原因：根据错误提示，我们给 <code>configure</code> 命令加上 <code>--disable-multilib</code> 参数再次执行（这样其实也就不再生产 <code>32</code> 位的编译器了）。</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --disable-multilib</span><br></pre></td></tr></table></figure></div><blockquote><p>报错： <code>cc: error trying to exec &#39;cc1obj&#39;: execvp: No such file or directory</code></p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc-objc gcc-objc++ libobjc</span><br></pre></td></tr></table></figure></div><p>[&#x2F;collapse]</p><ul><li>配置环境变量</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export PATH=/usr/local/gcc-10.3.0/bin:$PATH&#x27; &gt;&gt; /etc/profile</span><br><span class="line">exit# 执行后需要重启终端窗口</span><br></pre></td></tr></table></figure></div><ul><li>检查<code>GCC</code>版本</li></ul><blockquote><p>重新登录后检查当前 <code>GCC</code> 版本</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -v</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;Centos7.6&lt;/code&gt; &lt;code&gt;Yum&lt;/code&gt; 安装的默认 &lt;code&gt;GCC&lt;/code&gt; 版本为 &lt;code&gt;4.8.5&lt;/code&gt; ，如果需要使用 &lt;code&gt;GCC&lt;/code&gt; 的最新特性，则需要源码安装</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
    <category term="GCC" scheme="https://mirror.geek.xiaoww.com/tags/GCC/"/>
    
  </entry>
  
  <entry>
    <title>Centos7编译安装LNMP</title>
    <link href="https://mirror.geek.xiaoww.com/posts/centos7-source-install-lnmp/"/>
    <id>https://mirror.geek.xiaoww.com/posts/centos7-source-install-lnmp/</id>
    <published>2025-07-18T06:16:31.836Z</published>
    <updated>2025-06-01T10:54:49.784Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装前准备"><a href="#安装前准备" class="headerlink" title="安装前准备"></a>安装前准备</h2><blockquote><p>1.下载安装包</p><p>2.解压，并用<code>configure</code>指定安装参数</p><p><code>configure</code>是一个<code>shell</code>脚本，根据平台的特殊生成<code>Makefile</code>文件</p><p>3.执行<code>make &amp;&amp; make install</code></p><p><code>make</code>是用来编译的，它从<code>Makefile</code>中读取指令，然后编译</p><p><code>make install</code>是用来安装的，它也从<code>Makefile</code>中读取命令</p></blockquote><blockquote><h5 id="这里选择的是Centos系统来进行安装。然后准备好nginx1-16、php7-3、mysql8的软件。"><a href="#这里选择的是Centos系统来进行安装。然后准备好nginx1-16、php7-3、mysql8的软件。" class="headerlink" title="这里选择的是Centos系统来进行安装。然后准备好nginx1.16、php7.3、mysql8的软件。"></a>这里选择的是<code>Centos</code>系统来进行安装。然后准备好<code>nginx1.16</code>、<code>php7.3</code>、<code>mysql8</code>的软件。</h5><h5 id="在安装不同的工具软件的时候，需要安装插件的环境关系。"><a href="#在安装不同的工具软件的时候，需要安装插件的环境关系。" class="headerlink" title="在安装不同的工具软件的时候，需要安装插件的环境关系。"></a>在安装不同的工具软件的时候，需要安装插件的环境关系。</h5><h5 id="检查系统版本：cat-etc-redhat-release"><a href="#检查系统版本：cat-etc-redhat-release" class="headerlink" title="检查系统版本：cat /etc/redhat-release"></a>检查系统版本：<code>cat /etc/redhat-release</code></h5><p><strong>GCC</strong>编译器，默认的云服务器都是会安装的<br>查看是否已安装编译器：<code>rpm -qa gcc</code><br>否则(结果显示空白)<br>安装编译器<code>yum -y install gcc gcc-c++</code></p><p>为什么要安装<strong>GCC</strong>编译器？<br><strong>GCC</strong>是<code>C</code>语言编译器<br>使用它可以编译<code>C</code>语言代码为可执行程序</p></blockquote><hr><h2 id="1-安装Nginx"><a href="#1-安装Nginx" class="headerlink" title="1 安装Nginx"></a>1 安装Nginx</h2><h3 id="1-1-安装Nginx依赖库"><a href="#1-1-安装Nginx依赖库" class="headerlink" title="1.1 安装Nginx依赖库"></a>1.1 安装Nginx依赖库</h3><p>Nginx的Rewrite模块和HTTP核心模块会使用到PCRE正则表达式语法：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install pcre pcre-devel</span><br></pre></td></tr></table></figure></div><p>Nginx的各种模块中需要使用GZIP压缩：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install zlib zlib-devel</span><br></pre></td></tr></table></figure></div><p>安全套链字层密码库：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install openssl openssl-devel</span><br></pre></td></tr></table></figure></div><h3 id="1-2-下载Nginx"><a href="#1-2-下载Nginx" class="headerlink" title="1.2 下载Nginx"></a>1.2 下载Nginx</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://nginx.org/download/nginx-1.18.0.tar.gz #或者下载好直接上传</span><br></pre></td></tr></table></figure></div><h3 id="1-3-解压Nginx"><a href="#1-3-解压Nginx" class="headerlink" title="1.3  解压Nginx"></a>1.3  解压Nginx</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf nginx-1.18.0.tar.gz</span><br></pre></td></tr></table></figure></div><h3 id="1-4-创建并设置Nginx运行账号"><a href="#1-4-创建并设置Nginx运行账号" class="headerlink" title="1.4 创建并设置Nginx运行账号"></a>1.4 创建并设置Nginx运行账号</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">groupadd nginx</span><br><span class="line">useradd -M -g nginx -s /sbin/nologin nginx #手动创建一个用户，不想让用户登录系统</span><br><span class="line"></span><br><span class="line">  注：</span><br><span class="line">  -M:不要自动建立用户的登入目录</span><br><span class="line">  -s:是指定用户登入后所使用的shell。默认值为/bin/bash。如果不想让用户登录系统可以使用`-s /sbin/nologin`，此用户就不可以登录系统了。</span><br></pre></td></tr></table></figure></div><h3 id="1-5-编译和安装Nginx"><a href="#1-5-编译和安装Nginx" class="headerlink" title="1.5 编译和安装Nginx"></a>1.5 编译和安装Nginx</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd nginx-1.18.0</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module --with-http_stub_status_module --with-http_realip_module</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><p>cd &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf</p><p>修改文件nginx.conf，设置user参数如下：user nginx;</p><h3 id="1-6-设置Nginx为系统服务"><a href="#1-6-设置Nginx为系统服务" class="headerlink" title="1.6 设置Nginx为系统服务"></a>1.6 设置Nginx为系统服务</h3><p>在目录<code>/usr/lib/systemd/system/</code>新建文件<code>nginx.service</code>，文件创建：<code>touch nginx.service</code></p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Nginx Web Server</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></div><p>设置Nginx为开机自启动</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx.service</span><br></pre></td></tr></table></figure></div><p>启动Nginx服务</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start nginx.service</span><br></pre></td></tr></table></figure></div><p>查看Nginx是否启动成功：<code>systemctl status nginx.service</code> 或者 <code>netstat -anp | grep nginx</code></p><h2 id="2-安装PHP"><a href="#2-安装PHP" class="headerlink" title="2 安装PHP"></a>2 安装PHP</h2><h3 id="2-1-安装依赖库"><a href="#2-1-安装依赖库" class="headerlink" title="2.1 安装依赖库"></a>2.1 安装依赖库</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install libxml2* openssl* libcurl* libjpeg* libpng* freetype* libmcrypt*</span><br></pre></td></tr></table></figure></div><h3 id="2-2-解压PHP"><a href="#2-2-解压PHP" class="headerlink" title="2.2 解压PHP"></a>2.2 解压PHP</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf php-7.3.6.tar.gz</span><br></pre></td></tr></table></figure></div><h3 id="2-3-安装模块，编译安装"><a href="#2-3-安装模块，编译安装" class="headerlink" title="2.3 安装模块，编译安装"></a>2.3 安装模块，编译安装</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd php-7.3.6</span><br><span class="line">./configure --prefix=/usr/local/php --with-mysqli --with-pdo-mysql --with-iconv-dir --with-freetype-dir --with-jpeg-dir --with-png-dir --with-zlib --with-libxml-dir --enable-simplexml --enable-xml --disable-rpath --enable-bcmath --enable-soap --enable-zip --with-curl --enable-fpm --with-fpm-user=nginx --with-fpm-group=nginx --enable-mbstring --enable-sockets --with-gd --with-openssl --with-mhash --enable-opcache --disable-fileinfo</span><br></pre></td></tr></table></figure></div><p>当安装PHP出现<code>make:*** [ext/fileinfo/libmagic/apprentice.lo] Error 1</code>的时候，是因为服务器内存不足1G。<br>只需要在编译命令中添加 <code>--disable-fileinfo</code>即可</p><blockquote><p>如果报错：configure: error:Please reinstall the iconv library</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">因为缺少:libiconv</span><br><span class="line">wget http://ftp.gnu.org/pub/libiconv/libiconv-1.14.tar.gz</span><br><span class="line">tar -zxvf libiconv-1.14.tar.gz</span><br><span class="line">./configure --prefix=/usr/local/libiconv</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">如果报错:make[2]: *** [progname.o] Error 1</span><br><span class="line">进入srclib目录，执行 sed -i -e &#x27;/gets is a security/d&#x27; ./stdio.in.h</span><br></pre></td></tr></table></figure></div><blockquote><p>报错：configure: error:off_t undefined; check your library configuration</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">未定义lib库，需要自己引入</span><br><span class="line">vim /etc/ld.so.conf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">添加如下几行</span></span><br><span class="line">/usr/local/lib64</span><br><span class="line">/usr/local/lib</span><br><span class="line">/usr/lib</span><br><span class="line">/usr/lib64</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">保存退出</span></span><br><span class="line">:wq</span><br><span class="line">ldconfig -v #立即生效</span><br></pre></td></tr></table></figure></div><blockquote><p>如果报错：configure: error: Please reinstall the libzip distribution</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(1)移除旧的libzip:</span><br><span class="line">yum install -y cmake</span><br><span class="line">(2)安装libzip包:</span><br><span class="line">下载libzip包进行安装</span><br><span class="line">wget https://libzip.org/download/libzip-1.5.1.tar.gz</span><br><span class="line">tar -zxvf libzip-1.5.1.tar.gz</span><br><span class="line">cd libzip-1.5.1</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><blockquote><p>如果报错：CMake 3.0.2 or higher is required. You are running version 2.8.12.2</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(1)下载cmake包来安装</span><br><span class="line">wget https://cmake.org/files/v3.12/cmake-3.6.0.tar.gz</span><br><span class="line">tar -zxvf cmake-3.6.0.tar.gz</span><br><span class="line">进入目录：然后 ./bootstrap</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">检查版本：cmake --version</span><br></pre></td></tr></table></figure></div><p>配置configure成功后，执行make安装make &amp;&amp; make install</p><h3 id="2-4-添加配置文件"><a href="#2-4-添加配置文件" class="headerlink" title="2.4 添加配置文件"></a>2.4 添加配置文件</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/php/etc</span><br><span class="line">cd php-fpm.conf.default php-fpm.conf</span><br><span class="line">cd php-fpm.d</span><br><span class="line">cp www.conf.default www.conf</span><br></pre></td></tr></table></figure></div><h3 id="2-5-创建用户"><a href="#2-5-创建用户" class="headerlink" title="2.5 创建用户"></a>2.5 创建用户</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd www</span><br><span class="line">useradd -M -g www -s /sbin/nologin www</span><br><span class="line">chown -R nginx:nginx /usr/local/php</span><br></pre></td></tr></table></figure></div><h3 id="2-6-启动PHP"><a href="#2-6-启动PHP" class="headerlink" title="2.6 启动PHP"></a>2.6 启动PHP</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/php/sbin/php-fpm -c /usr/local/php/etc/php.ini -y /usr/local/php/etc/php-fpm.d/www.conf</span><br></pre></td></tr></table></figure></div><h3 id="2-7-设置变量"><a href="#2-7-设置变量" class="headerlink" title="2.7 设置变量"></a>2.7 设置变量</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile 在文件末尾加入两行代码</span><br><span class="line">PATH=$PATH:/usr/local/php/bin</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure></div><p>注意：如果添加多个用冒号连接，例如：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PATH=$PATH:/usr/local/php/bin:/usr/local/xxx/bin</span><br></pre></td></tr></table></figure></div><p>保存文件，执行命令source &#x2F;etc&#x2F;profile 或者执行点命令 .&#x2F;profile 使其修改生效，执行完可通过echo $PATH命令查看是否添加成功</p><h3 id="2-8-打开nginx-conf配置nginx与php的连接使用"><a href="#2-8-打开nginx-conf配置nginx与php的连接使用" class="headerlink" title="2.8 打开nginx.conf配置nginx与php的连接使用"></a>2.8 打开nginx.conf配置nginx与php的连接使用</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">listen 80;</span><br><span class="line">server_name localhost;</span><br><span class="line">roothtml;</span><br><span class="line">location / &#123;</span><br><span class="line">indexindex.html index.htm index.php;</span><br><span class="line">&#125;</span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">fastcgi_pass127.0.0.1:9100;</span><br><span class="line">fastcgi_indexindex.php;</span><br><span class="line">fastcgi_paramSCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">includefastcgi_params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>重新加载Nginx：<code>systemctl reload nginx</code><br>然后在<code>/test/web</code>下面创建<code>index.php</code>并写入如下代码</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">echo</span> phpinfo();</span></span><br><span class="line">var_dump(PHP_VERSION);</span><br></pre></td></tr></table></figure></div><h2 id="3-安装Mysql8数据库"><a href="#3-安装Mysql8数据库" class="headerlink" title="3 安装Mysql8数据库"></a>3 安装Mysql8数据库</h2><h3 id="3-1-检查依赖环境"><a href="#3-1-检查依赖环境" class="headerlink" title="3.1 检查依赖环境"></a>3.1 检查依赖环境</h3><blockquote><p>1.查看是否已安装mysql：<code>rpm -qa mysql</code>，有则卸载。<br>2.安装编译mysql需要的依赖包：<code>yum install libevent* libtool* autoconf* libstd* ncurse* bison* openssl*</code><br>3.安装cmake(mysql5.5之后需要用cmake支持编译安装)<br>查看是否已安装cmake：<code>rpm -qa cmake</code><br>没有则下载编译安装</p></blockquote><h3 id="3-2-安装cmake-mysql5-5之后需要用cmake支持编译安装"><a href="#3-2-安装cmake-mysql5-5之后需要用cmake支持编译安装" class="headerlink" title="3.2 安装cmake(mysql5.5之后需要用cmake支持编译安装)"></a>3.2 安装cmake(mysql5.5之后需要用cmake支持编译安装)</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /test/web</span><br><span class="line">wget https://cmake.org/files/v3.6/cmake-3.6.tar.gz</span><br><span class="line">tar -xf cmake-3.6.tar.gz</span><br><span class="line">cd cmake-3.6.0</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></div><h3 id="3-3-上传mysql包并解压"><a href="#3-3-上传mysql包并解压" class="headerlink" title="3.3 上传mysql包并解压"></a>3.3 上传mysql包并解压</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">下载带有boost的mysql安装包</span><br><span class="line">wget http://cdn.mysql.com/Downloads/MySQL-8.0/mysql-8.0.16.tar.gz</span><br><span class="line">tar -zxvf mysql-8.0.16.tar.gz</span><br></pre></td></tr></table></figure></div><h3 id="3-4-编译安装"><a href="#3-4-编译安装" class="headerlink" title="3.4 编译安装"></a>3.4 编译安装</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/mysql</span><br><span class="line">mkdir /usr/local/mysql/data</span><br><span class="line">cd mysql-8.0.16</span><br><span class="line">cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/usr/local/mysql/data -DSYSCONFDIR=/etc -DMYSQL_TCP_PORT=3306 -DDOWNLOAD_BOOST=1 -DWITH_BOOST=/www/demo/mysql-8.0.16/boost -DFORCE_INSOURCE_BUILD=1</span><br><span class="line"></span><br><span class="line">报错：GCC 5.3 or newer is required (-dumpversion says 4.8.5)</span><br><span class="line">原因：gcc版本低于安装软件要求的版本</span><br><span class="line">查看GCC版本：gcc -v</span><br><span class="line">yum安装升级：</span><br><span class="line">1.安装scl源：</span><br><span class="line">yum install centos-release-scl scl-utils-build</span><br><span class="line">2.列出scl可用源：</span><br><span class="line">yum list all --enablerepo=&#x27;centos-sclo-rh&#x27; | grep &quot;devtoolset-&quot;</span><br><span class="line">3.安装8版本的gcc、gcc-c++、gdb工具链(toolchain):</span><br><span class="line">yum install -y devtoolset-8-toolchain</span><br><span class="line">scl enable devtoolset-8 bash</span><br><span class="line">gcc --version(当前窗口的版本达到8系列，重新打开一个窗口检查下版本)</span><br><span class="line">建立软链接；让你GCC生效环境变量：如果不行可以先删除/usr/bin/下面的gcc文件</span><br><span class="line">ln -s /opt/rh/devtoolset-8/root/usr/bin/gcc /usr/bin/gcc</span><br><span class="line">ln -s /opt/rh/devtoolset-8/root/usr/bin/c++ /usr/bin/c++</span><br><span class="line">ln -s /opt/rh/devtoolset-8/root/usr/bin/g++ /usr/bin/g++</span><br><span class="line"></span><br><span class="line">报错：`c++: fatal error: Killed signal terminated program cc1plus`</span><br><span class="line">原因：内存不足所致，可通过设置2G交换分区来解决该问题</span><br><span class="line">1.设置交换分区的大小</span><br><span class="line">sudo dd if=/dev/zero of=/swapfile bs=64M count=32</span><br><span class="line">2.创建交换分区文件</span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line">3.开启交换分区</span><br><span class="line">sudo swapon /swapfile</span><br><span class="line">此时你就可以重新编译你的文件了，当编译完成后，回收这部分临时的交换空间</span><br><span class="line">1.先关闭交换空间</span><br><span class="line">sudo swapoff /swapfile</span><br><span class="line">2.删除交换空间</span><br><span class="line">sudo rm /swapfile</span><br></pre></td></tr></table></figure></div><p>make &amp;&amp; make install</p><h3 id="3-5-创建用户"><a href="#3-5-创建用户" class="headerlink" title="3.5 创建用户"></a>3.5 创建用户</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line">useradd -M -g mysql -s /sbin/nologin mysql</span><br><span class="line">chown -R mysql:mysql /usr/local/mysql</span><br></pre></td></tr></table></figure></div><h3 id="3-6-配置-etc-my-cnf文件"><a href="#3-6-配置-etc-my-cnf文件" class="headerlink" title="3.6 配置&#x2F;etc&#x2F;my.cnf文件"></a>3.6 配置&#x2F;etc&#x2F;my.cnf文件</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">server-id=1</span><br><span class="line">port=3306</span><br><span class="line">basedir=/usr/local/mysql</span><br><span class="line">datadir=/usr/local/mysql/data</span><br><span class="line">socket=/usr/local/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">socket=/usr/local/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">socket=/usr/local/mysql/mysql.sock</span><br></pre></td></tr></table></figure></div><h3 id="3-7-修改目录权限"><a href="#3-7-修改目录权限" class="headerlink" title="3.7 修改目录权限"></a>3.7 修改目录权限</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chown -R mysql:mysql /usr/local/mysql</span><br><span class="line">chmod 755 /usr/local/mysql -R</span><br></pre></td></tr></table></figure></div><h3 id="3-8-初始化配置"><a href="#3-8-初始化配置" class="headerlink" title="3.8 初始化配置"></a>3.8 初始化配置</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./bin/mysqld --initialize --user=mysql --datadir=/usr/local/mysql/data</span><br><span class="line">bin/mysql_ssl_rsa_setup</span><br></pre></td></tr></table></figure></div><h3 id="3-9-设置mysql为系统服务"><a href="#3-9-设置mysql为系统服务" class="headerlink" title="3.9 设置mysql为系统服务"></a>3.9 设置mysql为系统服务</h3><p>在目录<code>/lib/systemd/system</code>新建文件<code>mysqltest.service</code>，文件内容</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=mysqld</span><br><span class="line">After=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/mysql/support-files/mysql.server start</span><br><span class="line">ExecStop=/usr/local/mysql/support-files/mysql.server stop</span><br><span class="line">ExecRestart=/usr/local/mysql/support-files/mysql.server restart</span><br><span class="line">ExecReload=/usr/local/mysql/support-files/mysql.server reload</span><br><span class="line">PrivateTmp=true</span><br><span class="line">[Install]</span><br><span class="line">WanteBy=multi-user.target</span><br></pre></td></tr></table></figure></div><h3 id="3-10-启动mysql服务"><a href="#3-10-启动mysql服务" class="headerlink" title="3.10 启动mysql服务"></a>3.10 启动mysql服务</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mysqltest</span><br></pre></td></tr></table></figure></div><p>查看mysql是否启动成功：<code>systemctl status mysqltest</code>或者<code>ps aux | grep mysqltest</code></p><h3 id="3-11-设置mysql的环境变量"><a href="#3-11-设置mysql的环境变量" class="headerlink" title="3.11 设置mysql的环境变量"></a>3.11 设置mysql的环境变量</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">定义一个变量 MYSQL_HOME，值为&quot;mysql的安装路径&quot;</span><br><span class="line">在PATH后面加上$MYSQL_HOME/bin</span><br><span class="line">export后面加上MYSQL_HOME</span><br><span class="line">命令如下：</span><br><span class="line">MYSQL_HOME=/www/mysql</span><br><span class="line">PATH=$PATH:$MYSQL_HOME/bin</span><br><span class="line">export PATH MYSQL_HOME</span><br><span class="line">重新载入配置</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></div><h3 id="3-12-修改账号密码"><a href="#3-12-修改账号密码" class="headerlink" title="3.12 修改账号密码"></a>3.12 修改账号密码</h3><p>为了加强安全性，MySQL5.7以后为root用户随机生成了一个密码，在<code>/var/log/mysqld.log</code>中；<br>若<code>/var/log/mysqld.log</code>找不到，现在<code>/etc/my.cnf</code>下的mysql中添加<code>skip-grant-tables</code>以无密码形式登陆mysql，重启mysql；<br>切换到mysql数据库use mysql查看user表，会发现：user:当前数据库的用户名；authentication_string:用户密码；在mysql5.7.9以后废弃了password字段和password()函数；plugin:密码加密方式；</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.如果当前root用户authentication_string字段下有内容，先将其设置为空；</span><br><span class="line">update user set authentication_string=&#x27;&#x27; where user=&#x27;root&#x27;;</span><br><span class="line"></span><br><span class="line">2.退出mysql，删除/etc/my.cnf文件最后的skip-grant-tables 重启mysql服务。</span><br><span class="line">3.在mysql/bin目录下登陆mysql</span><br><span class="line">./mysql -u root -p</span><br><span class="line">password:直接回车</span><br><span class="line">4.使用ALTER修改root用户密码(WITH mysql_native_password类型，用于native连接，这里设置的空密码)</span><br><span class="line">ALTER USER root@localhost IDENTIFIED WITH mysql_native_password BY &#x27;winner&#x27;;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;安装前准备&quot;&gt;&lt;a href=&quot;#安装前准备&quot; class=&quot;headerlink&quot; title=&quot;安装前准备&quot;&gt;&lt;/a&gt;安装前准备&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;1.下载安装包&lt;/p&gt;
&lt;p&gt;2.解压，并用&lt;code&gt;configure&lt;/code&gt;指</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7 配置阿里云 Yum 镜像源</title>
    <link href="https://mirror.geek.xiaoww.com/posts/centos7-aliyun-yum-repo-config/"/>
    <id>https://mirror.geek.xiaoww.com/posts/centos7-aliyun-yum-repo-config/</id>
    <published>2025-07-18T06:16:31.834Z</published>
    <updated>2025-05-31T17:33:26.075Z</updated>
    
    <content type="html"><![CDATA[<div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份旧的 yum 源</span></span><br><span class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载阿里云 repo</span></span><br><span class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清除缓存</span></span><br><span class="line">yum clean all</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成缓存</span></span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;code-container&quot; data-rel=&quot;Shell&quot;&gt;&lt;figure class=&quot;iseeu highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
    <category term="Aliyun" scheme="https://mirror.geek.xiaoww.com/tags/Aliyun/"/>
    
    <category term="AlibabaCloud" scheme="https://mirror.geek.xiaoww.com/tags/AlibabaCloud/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 7.6 源码编译安装 PHP 8.0.3</title>
    <link href="https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-php-8-0-3/"/>
    <id>https://mirror.geek.xiaoww.com/posts/centos7-6-source-install-php-8-0-3/</id>
    <published>2025-07-18T06:16:31.821Z</published>
    <updated>2025-05-31T17:33:07.364Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文主要记录如何在 <code>CentOS 7.6</code> 中编译安装 <code>PHP</code> 官方最新的 <code>8.0.3</code> 版本。由于像 <code>Nginx</code> 、 <code>Mysql</code> 和 <code>PHP </code>的的源码都是用 <code>C/C++</code> 写的，所以自己的 <code>CentOS 7.6</code> 服务器上必须要安装 <code>gcc</code> 和 <code>g++</code> 软件。</p><p>搭建 <code>LNMP</code> 环境一般是先安装 <code>Mysql</code>&#x2F;<code>MariaDB</code> ，再安装 <code>Nginx</code> ，其次是安装 <code>PHP</code></p></blockquote><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="创建用户和组"><a href="#创建用户和组" class="headerlink" title="创建用户和组"></a>创建用户和组</h2><blockquote><p>先先创建一个名为 <code>php</code> 且没有登录权限的用户和一个名为 <code>php</code> 的用户组，然后安装 <code>php</code> 所需的依赖库和依赖包，最后通过 <code>.configure</code> 进行安装的详细配置。</p></blockquote><ul><li>创建 <code>php</code> 系统用户和系统用户组</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -r php &amp;&amp; useradd -c &quot;PHP Server&quot; -r -g php -s /sbin/nologin -d /usr/local/php php -M</span><br></pre></td></tr></table></figure></div><h1 id="安装相关包"><a href="#安装相关包" class="headerlink" title="安装相关包"></a>安装相关包</h1><h2 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h2><ul><li>安装编译软件及依赖</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gcc gcc-c++ make autoconf automake</span><br></pre></td></tr></table></figure></div><ul><li>安装<code>PHP</code>常用的库依赖</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install oniguruma oniguruma-devel freetype freetype-devel libpng libpng-devel libjpeg libjpeg-devel libxml2 libxml2-devel libevent libevent-devel zlib zlib-devel curl curl-devel openldap-devel openldap-clients libicu-devel libicu-devel libtidy libtidy-devel sqlite-devel libcurl-devel libxslt-devel net-snmp-devel libedit-devel libxslt-devel bzip2-devel gd-devel php-ldap gmp-devel re2c</span><br></pre></td></tr></table></figure></div><h1 id="链接LD库"><a href="#链接LD库" class="headerlink" title="链接LD库"></a>链接<code>LD</code>库</h1><ul><li>定义lib库</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /etc/ld.so.conf</span><br><span class="line">include ld.so.conf.d/*.conf</span><br><span class="line">/usr/lib</span><br><span class="line">/usr/lib64</span><br><span class="line">/usr/local/lib</span><br><span class="line">/usr/local/lib64</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使环境变量立即生效</span></span><br><span class="line">ldconfig -v</span><br></pre></td></tr></table></figure></div><h1 id="编译安装-PHP"><a href="#编译安装-PHP" class="headerlink" title="编译安装 PHP"></a>编译安装 <code>PHP</code></h1><ul><li>下载并解压文件</li></ul><p>(备用：<code>https://blog.xiaoqy.com/pub/packages/php/php-8.0.3.tar.gz</code>)</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -P &#x27;/usr/local/src&#x27; https://www.php.net/distributions/php-8.0.3.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf php-8.0.3.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd php-8.0.3</span><br></pre></td></tr></table></figure></div><blockquote><p>如果发现目录中并没有 <code>configure</code> 文件, 但是有一个名为 <code>buildconf</code> 的文件,通过运行这个文件生成 <code>configure</code> 文件</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行 buildconf 文件, 生成 configure 文件，加入 --force 选项</span></span><br><span class="line">./buildconf --force</span><br></pre></td></tr></table></figure></div><ul><li>预编译</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/php \</span><br><span class="line">--exec-prefix=/usr/local/php \</span><br><span class="line">--bindir=/usr/local/php/bin \</span><br><span class="line">--sbindir=/usr/local/php/sbin \</span><br><span class="line">--includedir=/usr/local/php/include \</span><br><span class="line">--libdir=/usr/local/php/lib/php \</span><br><span class="line">--mandir=/usr/local/php/php/man \</span><br><span class="line">--with-config-file-path=/usr/local/php/etc \</span><br><span class="line">--with-mysql-sock=/var/run/mysql/mysql.sock \</span><br><span class="line">--with-mysqli=shared,mysqlnd \</span><br><span class="line">--with-pdo-mysql=shared,mysqlnd \</span><br><span class="line">--with-openssl \</span><br><span class="line">--with-snmp \</span><br><span class="line">--with-mhash \</span><br><span class="line">--with-zlib \</span><br><span class="line">--with-zip \</span><br><span class="line">--with-gettext \</span><br><span class="line">--with-curl \</span><br><span class="line">--with-pcre-jit \</span><br><span class="line">--with-jpeg \</span><br><span class="line">--with-freetype \</span><br><span class="line">--with-gmp \</span><br><span class="line">--with-fpm-user=nginx \</span><br><span class="line">--with-fpm-group=nginx \</span><br><span class="line">--with-pear \</span><br><span class="line">--with-tidy \</span><br><span class="line">--without-gdbm \</span><br><span class="line">--enable-gd \</span><br><span class="line">--enable-ftp \</span><br><span class="line">--enable-xml \</span><br><span class="line">--enable-pcntl \</span><br><span class="line">--enable-shared \</span><br><span class="line">--enable-sockets \</span><br><span class="line">--enable-bcmath \</span><br><span class="line">--enable-shmop \</span><br><span class="line">--enable-sysvsem \</span><br><span class="line">--enable-mbregex \</span><br><span class="line">--enable-mbstring \</span><br><span class="line">--enable-soap \</span><br><span class="line">--enable-session \</span><br><span class="line">--enable-opcache \</span><br><span class="line">--enable-fpm \</span><br><span class="line">--enable-fast-install \</span><br><span class="line">--enable-calendar \</span><br><span class="line">--enable-exif \</span><br><span class="line">--enable-intl \</span><br><span class="line">--disable-debug \</span><br><span class="line">--disable-rpath \</span><br><span class="line">--disable-fileinfo</span><br></pre></td></tr></table></figure></div><p>[collapse title&#x3D;”编译配置报错？” color&#x3D;”red”]</p><blockquote><p>报错：<code>Alternatively, you may set the environment variables LIBZIP_CFLAGS and LIBZIP_LIBS to avoid the need to call pkg-config. See the pkg-config man page for more details.</code></p></blockquote><ul><li>方式一（方便）</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install epel-release</span><br><span class="line">rpm -ivh http://rpms.remirepo.net/enterprise/remi-release-7.rpm</span><br><span class="line">yum --enablerepo=remi install libzip5-devel</span><br></pre></td></tr></table></figure></div><ul><li>方式二（知道咋回事）</li></ul><p>编译安装，指定 <code>PKG_CONFIG_PATH</code> ，上面报错中其实有提示信息，让我们考虑调整 <code>PKG_CONFIG_PATH</code> 环境变量。<br>下面是详细步骤：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">先卸载已有</span></span><br><span class="line">yum remove -y libzip libzip-devel</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后安装</span></span><br><span class="line">（备用：https://blog.xiaoqy.com/pub/packages/libzip/libzip-1.2.0.tar.gz）</span><br><span class="line">wget -P &#x27;/usr/local/src&#x27; https://libzip.org/download/libzip-1.2.0.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf libzip-1.2.0.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd libzip-1.2.0</span><br><span class="line"></span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">装完了之后找一下 /usr/local/lib 下有没有 pkgconfig 目录</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">有的话执行以下命令来指定PKG_CONFIG_PATH。</span></span><br><span class="line">export PKG_CONFIG_PATH=&quot;/usr/local/lib/pkgconfig/&quot;</span><br></pre></td></tr></table></figure></div><p>[&#x2F;collapse]</p><ul><li>编译并安装</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><p>[collapse title&#x3D;”编译报错？” color&#x3D;”red”]</p><blockquote><p>报错：<code>configure: error:Please reinstall the iconv library</code></p><p>原因：未安装 <code>libiconv</code></p></blockquote><p>（备用：<code>https://blog.xiaoqy.com/pub/packages/libiconv/libiconv-1.16.tar.gz</code>）</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget -P &#x27;/usr/local/src&#x27; https://ftp.gnu.org/pub/gnu/libiconv/libiconv-1.16.tar.gz \</span><br><span class="line">&amp;&amp; cd /usr/local/src \</span><br><span class="line">&amp;&amp; tar -zxvf libiconv-1.16.tar.gz -C &#x27;/usr/local/src&#x27; \</span><br><span class="line">&amp;&amp; cd libiconv-1.16</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr/local/libiconv</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后编译时可加入选项 --with-iconv-dir=/usr/local/libiconv</span></span><br></pre></td></tr></table></figure></div><p>[&#x2F;collapse]</p><h1 id="配置-PHP"><a href="#配置-PHP" class="headerlink" title="配置 PHP"></a>配置 <code>PHP</code></h1><ul><li>添加 <code>PHP</code> 配置文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 php 源码编译目录下的 php.ini-production 拷贝到 php 安装目录下的 etc 目录下</span></span><br><span class="line">cp php.ini-production /usr/local/php/etc/php.ini</span><br></pre></td></tr></table></figure></div><ul><li>修改 <code>PHP</code> 配置文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/php/etc/php.ini</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改 PHP 扩展目录所在位置</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">搜索 ;extension_dir = <span class="string">&quot;./&quot;</span> 替换为</span></span><br><span class="line">extension_dir = &quot;/usr/local/php/lib/php/extensions/no-debug-non-zts-20200930&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开启 mysqli 扩展</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">找到 ;extension_dir = <span class="string">&quot;ext&quot;</span> 替换为</span></span><br><span class="line">extension = mysqli.so</span><br><span class="line">extension = pdo_mysql.so</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改服务器所在时区</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">PRC 就是英文 People<span class="string">&#x27;s Republic of China，中华人民共和国</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">找到 ;date.timezone = 替换为</span></span></span><br><span class="line">date.timezone = PRC</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">开启 OPcache</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">跳转到末行，输入以下内容</span></span></span><br><span class="line">zend_extension = opcache.so;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">保存并退出</span></span></span><br><span class="line">:wq!</span><br></pre></td></tr></table></figure></div><ul><li>添加 <code>php-fpm</code> 管理相关的配置文件到系统配置目录 <code>/etc/init.d</code></li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 php 源码编译目录下的 sapi/fpm/init.d.php-fpm 文件拷贝到系统配置 /etc/init.d 目录下并重命名为 php-fpm</span></span><br><span class="line">cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</span><br><span class="line">cd ~</span><br></pre></td></tr></table></figure></div><ul><li>添加 <code>php-fpm</code> 配置文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 php 安装目录下的 /usr/local/php/etc/php-fpm.conf.default 文件拷贝同目录下并重命名为 php-fpm.conf</span></span><br><span class="line">cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf</span><br></pre></td></tr></table></figure></div><ul><li>添加 <code>www.conf</code> 配置文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 php 安装目录下的 /usr/local/php/etc/php-fpm.d/www.conf.default 文件拷贝同目录下并重命名为 www.conf</span></span><br><span class="line">cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf</span><br></pre></td></tr></table></figure></div><ul><li>添加 <code>PHP</code> 安装目录到系统环境变量</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">加入环境变量:</span></span><br><span class="line">echo -e &quot;export PATH=\$PATH:/usr/local/php/bin:/usr/local/php/sbin&quot; &gt; /etc/profile.d/php.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用 <span class="built_in">source</span> 立即生效刚刚添加的 php 环境变量</span></span><br><span class="line">source /etc/profile.d/php.sh</span><br></pre></td></tr></table></figure></div><ul><li>设置 <code>PHP</code> 日志目录和 <code>php-fpm</code> 运行进程的 <code>ID</code> 文件目录</li></ul><blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php-fpm`运行进程的 ID 文件也就是`php-fpm.sock</span><br></pre></td></tr></table></figure></div><p>其中设置 <code>php-fpm</code> 进程目录的用户和用户组为 <code>Nginx</code></p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建 php-fpm 日志目录</span></span><br><span class="line">mkdir -p /var/log/php-fpm/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建 php-fpm 进程的 ID(php-fpm.sock) 文件运行目录</span></span><br><span class="line">mkdir -p /var/run/php-fpm</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改 php-fpm 进程的 ID(php-fpm.sock) 文件运行目录的所属用户和组</span></span><br><span class="line">chown -R nginx:nginx /var/run/php-fpm/</span><br></pre></td></tr></table></figure></div><ul><li>修改 <code>session</code> 的目录配置</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建 session 存放目录</span></span><br><span class="line">mkdir -p /var/lib/php/session</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改 session 存放目录的所属用户和组</span></span><br><span class="line">chown -R nginx:nginx /var/lib/php</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改 PHP 配置文件下的 ;session.save_path = <span class="string">&quot;/tmp&quot;</span></span></span><br><span class="line">sed -i &#x27;s/^;session.save_path\s\+\=\s\+\&quot;\/tmp\&quot;/session.save_path\ \=\ \&quot;\/var\/lib\/php\/session\&quot;/g&#x27; /usr/local/php/etc/php.ini</span><br></pre></td></tr></table></figure></div><ul><li>设置 <code>PHP</code> 开机启动</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改系统配置目录下的 php-fpm 文件可执行权限</span></span><br><span class="line">chmod +x /etc/init.d/php-fpm</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将系统配置目录下的 php-fpm 添加到 系统服务</span></span><br><span class="line">chkconfig --add php-fpm</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置 php-fpm 系统服务 为开机启动</span></span><br><span class="line">chkconfig php-fpm on</span><br></pre></td></tr></table></figure></div><ul><li>检测 <code>php-fpm</code> 系统服务是否启动成功</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用 chkconfig 命令检测一下服务是否运行成功</span></span><br><span class="line">chkconfig --list | grep php-fpm</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">php-fpm         0:off   1:off   2:on    3:on    4:on    5:on    6:off</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可见服务已经在 第 2 到 第 5 运行等级打开</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">同样你也可以禁用 php-fpm 开机启动</span></span><br><span class="line">chkconfig php-fpm off</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用 chkconfig 命令检测一下服务是否运行成功</span></span><br><span class="line">chkconfig --list | grep php-fpm</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">php-fpm         0:off   1:off   2:off   3:off   4:off   5:off   6:off</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可见服务已经在 第 2 到 第 5 运行等级已经关闭</span></span><br></pre></td></tr></table></figure></div><ul><li>测试 <code>PHP</code> 的配置文件是否无误</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php-fpm -t</span><br></pre></td></tr></table></figure></div><ul><li>启动 <code>PHP</code> 系统服务</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用 systemctl start + 服务名 启动系统服务</span></span><br><span class="line">systemctl start php-fpm.service</span><br></pre></td></tr></table></figure></div><ul><li>查看 <code>PHP</code> 系统服务状态</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用 systemctl status + 服务名 查看系统服务状态</span></span><br><span class="line">systemctl status php-fpm.service</span><br></pre></td></tr></table></figure></div><ul><li>查看 <code>PHP</code> 版本信息</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure></div><ul><li>修改 <code>Nginx</code> 配置文件使之使用 <code>Nginx</code> 反向 <code>PHP</code> 解释器</li></ul><blockquote><p>修改 <code>Nginx</code> 配置文件使之使用 <code>Nginx</code> 反向 <code>PHP</code> 解释器, 也就是 <code>php-fpm</code> 它其实就是 <code>CGI</code></p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">说明一下我在安装的 nginx 是将配置文件放在 /etc/nginx 目录下</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改配置文件如下:</span></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  www.xiaoqy.com;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    access_log  logs/nginx.dev.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /data/www/html;</span><br><span class="line">        index  index.php index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /data/www/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ ^/(images|javascript|js|css|flash|media|static)/ &#123;</span><br><span class="line"></span><br><span class="line">        expires 30d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    #</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">    #    root           html;</span><br><span class="line">        fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  /data/www/html/$fastcgi_script_name;</span><br><span class="line">        include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">    # concurs with nginx&#x27;s one</span><br><span class="line">    #</span><br><span class="line">    location ~ /\.ht &#123;</span><br><span class="line">        deny  all;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>编辑文件</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /data/www/html/index.php</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输入内容</span></span><br><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">保存退出</span></span><br><span class="line">:wq!</span><br></pre></td></tr></table></figure></div><ul><li>重新加载  <code>nginx</code>  配置</li></ul><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl reload nginx.service</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;本文主要记录如何在 &lt;code&gt;CentOS 7.6&lt;/code&gt; 中编译安装 &lt;code&gt;PHP&lt;/code&gt; 官方最新的 &lt;code&gt;8.0.3&lt;/code&gt; 版本。由于像 &lt;code&gt;Nginx&lt;/code&gt; 、 &lt;code&gt;Mysql&lt;/c</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
    <category term="Centos" scheme="https://mirror.geek.xiaoww.com/tags/Centos/"/>
    
    <category term="PHP" scheme="https://mirror.geek.xiaoww.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>BBR一键安装脚本 BBR魔改暴力BBRplus锐速(Lotsever)</title>
    <link href="https://mirror.geek.xiaoww.com/posts/bbr-install-script-bbrplus-lotsever/"/>
    <id>https://mirror.geek.xiaoww.com/posts/bbr-install-script-bbrplus-lotsever/</id>
    <published>2025-07-18T06:16:31.802Z</published>
    <updated>2025-05-31T17:39:04.405Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>BBR 是 Google 提出的一种新型拥塞控制算法，可以使 Linux 服务器显著地提高吞吐量和减少 TCP 连接的延迟。<br>BBR解决了两个问题：</p><ul><li>再有一定丢包率的网络链路上充分利用带宽。非常适合高延迟，高带宽的网络链路。</li><li>降低网络链路上的buffer占用率，从而降低延迟。非常适合慢速接入网络的用户。</li></ul><p>本次测试服务器是<a class="link"   href="https://www.hostmem.com/?ref=zeruns" >HostMem<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>的洛杉矶动态云：<a class="link"   href="https://www.hostmem.com/?ref=zeruns" >https://www.hostmem.com/?ref=zeruns<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h1 id="speedtest测速服务搭建"><a href="#speedtest测速服务搭建" class="headerlink" title="speedtest测速服务搭建"></a>speedtest测速服务搭建</h1><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install docker</span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl enable docker</span><br><span class="line">docker pull adolfintel/speedtest</span><br><span class="line">docker run -d -p 80:80 adolfintel/speedtest</span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl disable firewalld.service</span><br></pre></td></tr></table></figure></div><p>输入上面命令安装speedtest测速服务后在浏览器地址栏输入你服务器的IP即可打开测速页面</p><h1 id="BBR和锐速安装脚本"><a href="#BBR和锐速安装脚本" class="headerlink" title="BBR和锐速安装脚本"></a>BBR和锐速安装脚本</h1><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -N --no-check-certificate &quot;https://gist.github.com/zeruns/a0ec603f20d1b86de6a774a8ba27588f/raw/4f9957ae23f5efb2bb7c57a198ae2cffebfb1c56/tcp.sh&quot; &amp;&amp; chmod +x tcp.sh &amp;&amp; ./tcp.sh</span><br></pre></td></tr></table></figure></div><h1 id="测速结果"><a href="#测速结果" class="headerlink" title="测速结果"></a>测速结果</h1><h2 id="裸机"><a href="#裸机" class="headerlink" title="裸机"></a>裸机</h2><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://xiaoww-geek.oss-ap-southeast-1.aliyuncs.com/images/e2fef68435af6729638fdc4efa5184a4.gif"                      alt="img"                ></p><h2 id="原版BBR"><a href="#原版BBR" class="headerlink" title="原版BBR"></a>原版BBR</h2><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://xiaoww-geek.oss-ap-southeast-1.aliyuncs.com/images/BBR.gif"                      alt="img"                ></p><h2 id="BBR魔改版"><a href="#BBR魔改版" class="headerlink" title="BBR魔改版"></a>BBR魔改版</h2><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://xiaoww-geek.oss-ap-southeast-1.aliyuncs.com/images/BBR58dd49eb1f69725d.gif"                      alt="img"                ></p><h2 id="BBR-Plus"><a href="#BBR-Plus" class="headerlink" title="BBR Plus"></a>BBR Plus</h2><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://xiaoww-geek.oss-ap-southeast-1.aliyuncs.com/images/BBR_Plus.gif"                      alt="img"                ></p><h2 id="锐速"><a href="#锐速" class="headerlink" title="锐速"></a>锐速</h2><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p><a class="link"   href="https://www.hostmem.com/?ref=zeruns" >HostMem<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>的服务器如果不装BBR和锐速这类TCP加速程序带宽根本没法看，但装上后效果好很多，效果最好最稳当的是魔改版BBR。</p><p>注：此测试结果不具备普遍性，不同线路不同厂商的服务器结果不同，其他厂商的服务器需要自己测试找出效果最好的。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;BBR 是 Google 提出的一种新型拥塞控制算法，可以使 Linux 服务器显著地提高吞吐量和减少 TCP 连接的延迟。&lt;br&gt;BBR解</summary>
      
    
    
    
    <category term="系统运维" scheme="https://mirror.geek.xiaoww.com/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://mirror.geek.xiaoww.com/tags/Linux/"/>
    
  </entry>
  
</feed>
